# Comparing `tmp/k1lib-1.3.6-py3-none-any.whl.zip` & `tmp/k1lib-1.3.6.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 2525883 bytes, number of entries: 82
+Zip file size: 2527041 bytes, number of entries: 82
 -rw-rw-r--  2.0 unx     1435 b- defN 23-Feb-08 00:13 k1lib/__init__.py
 -rw-rw-r--  2.0 unx    53793 b- defN 23-Apr-02 08:25 k1lib/_baseClasses.py
 -rw-rw-r--  2.0 unx    12952 b- defN 23-Apr-24 20:20 k1lib/_basics.py
 -rw-rw-r--  2.0 unx     4234 b- defN 22-Dec-23 14:19 k1lib/_context.py
 -rw-rw-r--  2.0 unx     2866 b- defN 22-Jul-20 04:30 k1lib/_higher.py
 -rw-rw-r--  2.0 unx      948 b- defN 22-Sep-21 23:54 k1lib/_k1a.py
 -rw-rw-r--  2.0 unx    11646 b- defN 23-Jan-14 15:37 k1lib/_learner.py
@@ -50,35 +50,35 @@
 -rw-rw-r--  2.0 unx     8308 b- defN 22-Nov-27 07:16 k1lib/cli/bio.py
 -rw-rw-r--  2.0 unx     4033 b- defN 23-Jan-25 02:02 k1lib/cli/cif.py
 -rw-rw-r--  2.0 unx    18610 b- defN 23-Apr-26 17:44 k1lib/cli/conv.py
 -rw-rw-r--  2.0 unx    24096 b- defN 23-Apr-29 07:15 k1lib/cli/filt.py
 -rw-rw-r--  2.0 unx     6672 b- defN 23-Jan-25 02:02 k1lib/cli/gb.py
 -rw-rw-r--  2.0 unx     6348 b- defN 23-Apr-05 15:10 k1lib/cli/grep.py
 -rw-rw-r--  2.0 unx    18312 b- defN 23-May-02 14:44 k1lib/cli/init.py
--rw-rw-r--  2.0 unx    20950 b- defN 23-Apr-05 14:54 k1lib/cli/inp.py
+-rw-rw-r--  2.0 unx    21421 b- defN 23-May-03 05:14 k1lib/cli/inp.py
 -rw-rw-r--  2.0 unx      623 b- defN 22-Jun-22 10:43 k1lib/cli/kcsv.py
 -rw-rw-r--  2.0 unx     4819 b- defN 22-Aug-11 20:44 k1lib/cli/kxml.py
 -rw-rw-r--  2.0 unx     1915 b- defN 21-Nov-12 16:48 k1lib/cli/mgi.py
--rw-rw-r--  2.0 unx    40213 b- defN 23-May-02 17:55 k1lib/cli/modifier.py
+-rw-rw-r--  2.0 unx    43473 b- defN 23-May-03 05:38 k1lib/cli/modifier.py
 -rw-rw-r--  2.0 unx      694 b- defN 22-Nov-27 07:17 k1lib/cli/mol.py
 -rw-rw-r--  2.0 unx     3551 b- defN 23-Feb-02 17:12 k1lib/cli/nb.py
 -rw-rw-r--  2.0 unx     3530 b- defN 22-Aug-16 15:08 k1lib/cli/optimizations.py
 -rw-rw-r--  2.0 unx    11559 b- defN 23-Apr-25 00:01 k1lib/cli/output.py
 -rw-rw-r--  2.0 unx     2394 b- defN 23-Jan-25 02:03 k1lib/cli/sam.py
 -rw-rw-r--  2.0 unx    49588 b- defN 23-May-02 16:53 k1lib/cli/structural.py
 -rw-rw-r--  2.0 unx    10399 b- defN 22-Aug-05 01:15 k1lib/cli/trace.py
 -rw-rw-r--  2.0 unx    23319 b- defN 22-Sep-29 07:14 k1lib/cli/typehint.py
 -rw-rw-r--  2.0 unx    20345 b- defN 23-Apr-26 17:09 k1lib/cli/utils.py
 -rw-rw-r--  2.0 unx       20 b- defN 23-Jan-19 22:00 k1lib/k1ui/__init__.py
 -rw-rw-r--  2.0 unx    61803 b- defN 23-Feb-10 12:10 k1lib/k1ui/main.py
 -rw-rw-r--  2.0 unx       20 b- defN 22-Sep-16 01:12 k1lib/serve/__init__.py
 -rw-rw-r--  2.0 unx    10093 b- defN 23-Mar-19 11:14 k1lib/serve/main.py
 -rw-rw-r--  2.0 unx      642 b- defN 23-Feb-13 19:00 k1lib/serve/suffix.py
--rw-rw-r--  2.0 unx  2453826 b- defN 23-Jan-19 22:50 k1lib-1.3.6.data/data/k1lib/k1ui/256.model.state_dict.pth
--rw-rw-r--  2.0 unx   304735 b- defN 23-Jan-17 19:16 k1lib-1.3.6.data/data/k1lib/k1ui/mouseKey.pth
--rw-rw-r--  2.0 unx    20544 b- defN 23-Mar-19 11:14 k1lib-1.3.6.data/data/k1lib/serve/main.html
--rw-rw-r--  2.0 unx     1049 b- defN 23-May-02 17:55 k1lib-1.3.6.dist-info/LICENSE
--rw-rw-r--  2.0 unx     2911 b- defN 23-May-02 17:55 k1lib-1.3.6.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-May-02 17:55 k1lib-1.3.6.dist-info/WHEEL
--rw-rw-r--  2.0 unx        6 b- defN 23-May-02 17:55 k1lib-1.3.6.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     6527 b- defN 23-May-02 17:55 k1lib-1.3.6.dist-info/RECORD
-82 files, 3461783 bytes uncompressed, 2515821 bytes compressed:  27.3%
+-rw-rw-r--  2.0 unx  2453826 b- defN 23-Jan-19 22:50 k1lib-1.3.6.1.data/data/k1lib/k1ui/256.model.state_dict.pth
+-rw-rw-r--  2.0 unx   304735 b- defN 23-Jan-17 19:16 k1lib-1.3.6.1.data/data/k1lib/k1ui/mouseKey.pth
+-rw-rw-r--  2.0 unx    20544 b- defN 23-Mar-19 11:14 k1lib-1.3.6.1.data/data/k1lib/serve/main.html
+-rw-rw-r--  2.0 unx     1049 b- defN 23-May-03 05:39 k1lib-1.3.6.1.dist-info/LICENSE
+-rw-rw-r--  2.0 unx     2913 b- defN 23-May-03 05:39 k1lib-1.3.6.1.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-May-03 05:39 k1lib-1.3.6.1.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        6 b- defN 23-May-03 05:39 k1lib-1.3.6.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     6543 b- defN 23-May-03 05:39 k1lib-1.3.6.1.dist-info/RECORD
+82 files, 3465532 bytes uncompressed, 2516947 bytes compressed:  27.4%
```

## zipnote {}

```diff
@@ -216,32 +216,32 @@
 
 Filename: k1lib/serve/main.py
 Comment: 
 
 Filename: k1lib/serve/suffix.py
 Comment: 
 
-Filename: k1lib-1.3.6.data/data/k1lib/k1ui/256.model.state_dict.pth
+Filename: k1lib-1.3.6.1.data/data/k1lib/k1ui/256.model.state_dict.pth
 Comment: 
 
-Filename: k1lib-1.3.6.data/data/k1lib/k1ui/mouseKey.pth
+Filename: k1lib-1.3.6.1.data/data/k1lib/k1ui/mouseKey.pth
 Comment: 
 
-Filename: k1lib-1.3.6.data/data/k1lib/serve/main.html
+Filename: k1lib-1.3.6.1.data/data/k1lib/serve/main.html
 Comment: 
 
-Filename: k1lib-1.3.6.dist-info/LICENSE
+Filename: k1lib-1.3.6.1.dist-info/LICENSE
 Comment: 
 
-Filename: k1lib-1.3.6.dist-info/METADATA
+Filename: k1lib-1.3.6.1.dist-info/METADATA
 Comment: 
 
-Filename: k1lib-1.3.6.dist-info/WHEEL
+Filename: k1lib-1.3.6.1.dist-info/WHEEL
 Comment: 
 
-Filename: k1lib-1.3.6.dist-info/top_level.txt
+Filename: k1lib-1.3.6.1.dist-info/top_level.txt
 Comment: 
 
-Filename: k1lib-1.3.6.dist-info/RECORD
+Filename: k1lib-1.3.6.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## k1lib/cli/inp.py

```diff
@@ -249,14 +249,28 @@
         else: return inner(f)
     def __ror__(self, fn):
         n = self.n; c = self.c
         def func(f): f.seek(0, os.SEEK_END); end = f.tell(); return [*range(n) | cli.apply(lambda x: int(x*end/n)) | cli.apply(lambda x: splitSeek.backward(f, x, c)), end]
         if isinstance(fn, str):
             with open(os.path.expanduser(fn), 'rb') as f: return func(f)
         else: return func(fn)
+    @staticmethod
+    def window():
+        """Converts input boundaries into segment windows.
+Example::
+
+    # returns [[0, 4], [5, 9], [10, 20]]
+    [0, 5, 10, 20] | splitSeek.window()
+    # example use case
+    "abc.txt" | splitSeek(10) | splitSeek.window()
+"""
+        def inner(it):
+            it = it | cli.aS(list); ranges = it | cli.window(2) | cli.apply(lambda x: x-1, 1) | cli.deref()
+            ranges[-1][1] += 1; return ranges
+        return cli.aS(inner)
 def curl(url:str) -> Iterator[str]:
     """Gets file from url. File can't be a binary blob.
 Example::
 
     # prints out first 10 lines of the website
     curl("https://k1lib.github.io/") | headOut()"""
     for line in urllib.request.urlopen(url):
```

## k1lib/cli/modifier.py

```diff
@@ -431,22 +431,30 @@
         def gen(it):
             futures = deque(); it = iter(it)
             for i, e in zip(range(self.prefetch), it): futures.append(preprocessF(f, e))
             for e in it: yield resolveF(futures.popleft()); futures.append(preprocessF(f, e))
             for e in futures: yield resolveF(e)
         return gen(it)
     @staticmethod
-    def nodeIds() -> iter:
-        """Returns an iterator of all node ids in the current cluster.
+    def nodeIds(includeSelf=True) -> List[str]:
+        """Returns a list of all node ids in the current cluster.
 Example::
 
     applyCl.nodeIds() # returns something like ['7bb387b2920694abe9f7d2a2ed939b6d31843faf91d174d0221e871d', '1051dafd2b0dac13561c46fe052f561400592f0723df2cd746a41068']
 
-If you want to get nodes' metadata, then just use ray's builtin function ``ray.nodes()``"""
-        return ray.nodes() | cli.filt(lambda x: x["Alive"]) | apply(lambda x: x["NodeID"])
+If you want to get nodes' metadata, then just use ray's builtin function ``ray.nodes()``
+
+:param includeSelf: whether to include node id of the current process or not"""
+        res = ray.nodes() | cli.filt(lambda x: x["Alive"]) | apply(lambda x: x["NodeID"]) | aS(list)
+        if includeSelf: return res
+        res.remove(applyCl.nodeId()); return res
+    @staticmethod
+    def nodeId() -> str:
+        """Returns current node id"""
+        return ray.runtime_context.get_runtime_context().get_node_id()
     @staticmethod
     def aS(f, timeout:float=8):
         """Executes function f once for all node ids that are piped in.
 Example::
 
     # returns [['1051da...', ['Desktop', 'Downloads']], ['7bb387...', ['Pictures', 'Music']]]
     applyCl.nodeIds() | applyCl.aS(lambda: None | cmd("ls ~") | deref()) | deref()
@@ -460,14 +468,60 @@
 different. It just means execute once for each node ids.
 
 :param f: main function to execute in each node. Not supposed to accept any arguments
 :param timeout: seconds to wait for job before raising an error"""
         f = fastF(f); g = lambda nodeId: specificNode(ray.remote(f), nodeId).remote()
         final = cli.iden() & (apply(g) | aS(list) | apply(ray.get, timeout=timeout)) | cli.transpose()
         return aS(lambda it: (applyCl.nodeIds() if it is None else it) | final)
+    @staticmethod
+    def replicateFile(fn:str, nodeIds=None):
+        """Replicates a specific file in the current node to all the other nodes.
+Example::
+
+    applyCl.replicate("~/cron.log")
+
+Internally, this will read chunks of 100kB of the specified file and dump it
+incrementally to all other nodes, which has implications on performance. To
+increase or decrease it, check out :class:`~k1lib.cli.inp.cat`. This also means
+you can replicate arbitrarily large files around as long as you have the disk
+space for it, while ram size doesn't really matter
+
+:param fn: file name"""
+        fn = os.path.expanduser(fn); dirname = os.path.dirname(fn)
+        if nodeIds is None: nodeIds = applyCl.nodeIds(False)
+        nodeIds = nodeIds | cli.wrapList().all() | cli.deref()
+        nodeIds | cli.insert(None, False).all() | applyCl(lambda _: None | cli.cmd(f"mkdir -p {dirname}; rm {fn}") | cli.deref(), pre=True) | cli.deref()
+        for chunk in cli.cat(fn, text=False, chunks=True):
+            nodeIds | cli.insert(chunk, False).all() | applyCl(lambda chunk: chunk >> cli.file(fn) | cli.deref(), pre=True) | cli.deref()
+    @staticmethod
+    def splitFile(fn:str, nodeIds=None):
+        """Splits a specified file in the current node and dumps other parts
+to other nodes. Example::
+
+    applyCl.splitFile("~/cron.log")
+
+This will split the big file up into multiple segments (1 for each node). Then
+for each segment, it will read through it chunk by chunk into memory, and then
+deposits it into the respective nodes. Finally, it truncates the original file
+down to its segment boundary.
+
+Again, this means that you can split arbitrarily large files as long as you have
+the disk space for it, ram size is not a concern. How does this perform? Not
+the best in the world if you don't have a lot of nodes. With sata 3 ssds, 750MB/s
+ethernet, I got transfer speeds of roughly 100MB/s. This should increase as you
+have more nodes based on the code structure, but I haven't tested it yet. Can
+it be faster? Definitely. Am I willing to spend time optimizing it? No"""
+        fn = os.path.expanduser(fn); dirname = os.path.dirname(fn)
+        if nodeIds is None: nodeIds = applyCl.nodeIds(False)
+        nodeIds | cli.wrapList().all() | cli.insert(None, False).all() | applyCl(lambda _: None | cli.cmd(f"mkdir -p {dirname}; rm {fn}") | cli.deref(), pre=True) | cli.deref()
+        n = len(nodeIds)+1; ranges = fn | cli.splitSeek(n) | cli.window(2) | cli.apply(lambda x: x-1, 1) | cli.deref(); ranges[-1][1] += 1
+        for chunks in ranges[1:] | ~cli.apply(lambda a,b: [cli.cat(fn, False, True, sB=a, eB=b), b'' | cli.repeat()] | cli.joinStreams()) | cli.transpose():
+            if chunks | cli.apply(len) | cli.toSum() == 0: break
+            [nodeIds, chunks] | cli.transpose() | applyCl(lambda chunk: chunk >> cli.file(fn) | cli.deref(), pre=True) | cli.deref()
+        with open(fn, 'wb') as f: f.truncate(ranges[0][1])
 thEmptySentinel = object()
 class applyTh(BaseCli):
     def __init__(self, f, prefetch:int=None, timeout:float=5, bs:int=1):
         """Kinda like the same as :class:`applyMp`, but executes ``f`` on multiple
 threads, instead of on multiple processes. Advantages:
 
 - Relatively low overhead for thread creation
```

## Comparing `k1lib-1.3.6.data/data/k1lib/k1ui/256.model.state_dict.pth` & `k1lib-1.3.6.1.data/data/k1lib/k1ui/256.model.state_dict.pth`

 * *Files identical despite different names*

## Comparing `k1lib-1.3.6.data/data/k1lib/k1ui/mouseKey.pth` & `k1lib-1.3.6.1.data/data/k1lib/k1ui/mouseKey.pth`

 * *Files identical despite different names*

## Comparing `k1lib-1.3.6.data/data/k1lib/serve/main.html` & `k1lib-1.3.6.1.data/data/k1lib/serve/main.html`

 * *Files identical despite different names*

## Comparing `k1lib-1.3.6.dist-info/LICENSE` & `k1lib-1.3.6.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `k1lib-1.3.6.dist-info/METADATA` & `k1lib-1.3.6.1.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: k1lib
-Version: 1.3.6
+Version: 1.3.6.1
 Summary: Some nice ML overhaul
 Home-page: https://k1lib.com
 Author: Quang Ho
 Author-email: 157239q@gmail.com
 License: MIT
 Requires-Python: >=3.7
 Description-Content-Type: text/markdown
```

## Comparing `k1lib-1.3.6.dist-info/RECORD` & `k1lib-1.3.6.1.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -49,34 +49,34 @@
 k1lib/cli/bio.py,sha256=PhGvy-fDA-wrUzzEDpuRe4x-Kbylx0sNmoXCEZfE_FA,8308
 k1lib/cli/cif.py,sha256=77FX83m1FRYEeZkdXJ8MiVapqCSzZ-1xOQ8ZLeHfhf8,4033
 k1lib/cli/conv.py,sha256=dwsdTpGew3J5OzCVBehATgFmuVdi5vxfRECj6Q-eTDw,18610
 k1lib/cli/filt.py,sha256=uZlB3qbaOSZZhBpfX2Wt0JSDcB72Z98bRlE_eNtb7gc,24096
 k1lib/cli/gb.py,sha256=xxjuNYgWrrElRckon3gP0sj-dShYnKs3jmHAb1U0kVI,6672
 k1lib/cli/grep.py,sha256=Lu4PFOe2pkaqd-UfJe_HhHCUFTUifE6Bh96_k80sQDA,6348
 k1lib/cli/init.py,sha256=jtOLSw3PR_0VIepOzK5cDmeAea4WmDNa3jy6WIM6qV4,18312
-k1lib/cli/inp.py,sha256=O2EBUvD9D6y8G0KnFbf9RNGlAw07ajWoUl-7CtJTJFM,20950
+k1lib/cli/inp.py,sha256=rkjhmdzENa1YGEGK6CoYx7ek1VQc6sSnWYJQmK_E4D0,21421
 k1lib/cli/kcsv.py,sha256=YGUVVLTZGGujokhxtj5MfjU9t1jRGqp23d58JK8lhq0,623
 k1lib/cli/kxml.py,sha256=YQGutvKNm0_xAi_NhCNtuGey7fx3zZSmSo33kS--54c,4819
 k1lib/cli/mgi.py,sha256=aLke90nG89tgWLPwyKmTj3kM8yJnIBCJSrPS1jT8mUk,1915
-k1lib/cli/modifier.py,sha256=BYYsg6pBmJ_qDNFaMwQB-ZfIbFfR_JUjFcBS61e_gt4,40213
+k1lib/cli/modifier.py,sha256=t-k12rN9bYdOgegoXm5UzrioRpPnfpTPhLBB3iSKQMw,43473
 k1lib/cli/mol.py,sha256=wNFuCPXtdEcH4DRBbmYaLAWxtDzjN2MOKFX7ynJhaJs,694
 k1lib/cli/nb.py,sha256=SHqhYHJrzV8IzH3wM1Kb0LOVseOa1XXDKUtYE_2KTkQ,3551
 k1lib/cli/optimizations.py,sha256=iZ73DwLqZCxRm0sECVZ7A2nDxf5D4rsoSGzrKTgzGaI,3530
 k1lib/cli/output.py,sha256=HQD61-Epy6WfteMHXW6SV14SiprXF55ELnfer2CWXEA,11559
 k1lib/cli/sam.py,sha256=_ersEPP2ue0Oa3AyftNjQu2PABpH4L7iFBbRJDOkeug,2394
 k1lib/cli/structural.py,sha256=HgYG8t8tbj4PN4TNeenhnW0CQQsI0qN1y_uh-avNT-8,49588
 k1lib/cli/trace.py,sha256=nzZgOyXqFJYkQfbpR0lpX0Nnp0bQHXPjk8sDUBIe2hk,10399
 k1lib/cli/typehint.py,sha256=VBYxrOQaSnu5266lNWpgXIhXF7htdT0FT_NEvXjYBVk,23319
 k1lib/cli/utils.py,sha256=gaHYEw2_gjqNjOQFLUfa3JAXXwi6vZPCQqKwDuhrUDg,20345
 k1lib/k1ui/__init__.py,sha256=8D5a8oKgqd6WA1RUkiKCn4l_PVemtyuckxQut0vDHXM,20
 k1lib/k1ui/main.py,sha256=PnmdOhkjYgRSZnDyGYNMYtQ5Nvcb1NhQ9yjfP_3QORI,61803
 k1lib/serve/__init__.py,sha256=8D5a8oKgqd6WA1RUkiKCn4l_PVemtyuckxQut0vDHXM,20
 k1lib/serve/main.py,sha256=SXZADDxXqZkxALeO01xwGKJ7c1sYMn4DjdY3RitMUaI,10093
 k1lib/serve/suffix.py,sha256=UH3ITN6O2vzoha2f6v4bcQG3_Boav7VA7EC8wf8r9f8,642
-k1lib-1.3.6.data/data/k1lib/k1ui/256.model.state_dict.pth,sha256=Ga-UXlAJfUPNOZsvP_c1-1cfB2Hp_-oQ4ghdouX1d7g,2453826
-k1lib-1.3.6.data/data/k1lib/k1ui/mouseKey.pth,sha256=KULhK_gdK2Ppju9gQnv1zV2kf_A0K-vX2W7trY6DIg8,304735
-k1lib-1.3.6.data/data/k1lib/serve/main.html,sha256=gHFNqzE9JKb4eCwCJN-Du45jj75lDRED4Ico91T-b4g,20544
-k1lib-1.3.6.dist-info/LICENSE,sha256=psuy2wnTg9zacuCQ0dXfxS44iaa89aTgsNzHDzx4UGM,1049
-k1lib-1.3.6.dist-info/METADATA,sha256=IEMwsFAz84_dd_5IbY89ACXLZEAATc5nbCW-_j1XGWo,2911
-k1lib-1.3.6.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-k1lib-1.3.6.dist-info/top_level.txt,sha256=xxWmqZzuThnLZn49Mse6A6j41-IVduPVnQW54imcOTA,6
-k1lib-1.3.6.dist-info/RECORD,,
+k1lib-1.3.6.1.data/data/k1lib/k1ui/256.model.state_dict.pth,sha256=Ga-UXlAJfUPNOZsvP_c1-1cfB2Hp_-oQ4ghdouX1d7g,2453826
+k1lib-1.3.6.1.data/data/k1lib/k1ui/mouseKey.pth,sha256=KULhK_gdK2Ppju9gQnv1zV2kf_A0K-vX2W7trY6DIg8,304735
+k1lib-1.3.6.1.data/data/k1lib/serve/main.html,sha256=gHFNqzE9JKb4eCwCJN-Du45jj75lDRED4Ico91T-b4g,20544
+k1lib-1.3.6.1.dist-info/LICENSE,sha256=psuy2wnTg9zacuCQ0dXfxS44iaa89aTgsNzHDzx4UGM,1049
+k1lib-1.3.6.1.dist-info/METADATA,sha256=nhqg9n65JCHPwoEuSWebL4yx48FzI8KkE_Xf1_Ulf8Q,2913
+k1lib-1.3.6.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+k1lib-1.3.6.1.dist-info/top_level.txt,sha256=xxWmqZzuThnLZn49Mse6A6j41-IVduPVnQW54imcOTA,6
+k1lib-1.3.6.1.dist-info/RECORD,,
```

