# Comparing `tmp/lil_nocap-0.5.2.tar.gz` & `tmp/lil_nocap-0.5.4.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "lil_nocap-0.5.2.tar", max compression
+gzip compressed data, was "lil_nocap-0.5.4.tar", max compression
```

## Comparing `lil_nocap-0.5.2.tar` & `lil_nocap-0.5.4.tar`

### file list

```diff
@@ -1,9 +1,10 @@
--rw-r--r--   0        0        0      880 2023-03-29 18:43:43.824841 lil_nocap-0.5.2/README.md
--rw-r--r--   0        0        0    32768 2023-04-19 16:04:36.367887 lil_nocap-0.5.2/lil_nocap/.__init__.py.swp
--rw-r--r--   0        0        0    11350 2023-04-19 16:03:31.938655 lil_nocap-0.5.2/lil_nocap/__init__.py
--rw-r--r--   0        0        0        0 2023-03-23 15:05:43.219167 lil_nocap-0.5.2/lil_nocap/opinions.jsonl
--rw-r--r--   0        0        0      324 2023-03-20 15:40:07.101005 lil_nocap-0.5.2/lil_nocap/test.py
--rw-r--r--   0        0        0        0 2023-03-20 15:34:19.022580 lil_nocap-0.5.2/lil_nocap/test.txt
--rw-r--r--   0        0        0      498 2023-04-19 16:04:16.946304 lil_nocap-0.5.2/pyproject.toml
--rw-r--r--   0        0        0     1732 1970-01-01 00:00:00.000000 lil_nocap-0.5.2/setup.py
--rw-r--r--   0        0        0     1597 1970-01-01 00:00:00.000000 lil_nocap-0.5.2/PKG-INFO
+-rw-r--r--   0        0        0      880 2023-03-29 18:43:43.824841 lil_nocap-0.5.4/README.md
+-rw-r--r--   0        0        0     6148 2023-04-26 21:14:15.140890 lil_nocap-0.5.4/lil_nocap/.DS_Store
+-rw-r--r--   0        0        0    40960 2023-05-03 19:48:20.173456 lil_nocap-0.5.4/lil_nocap/.__init__.py.swp
+-rw-r--r--   0        0        0    15827 2023-05-03 19:48:16.148105 lil_nocap-0.5.4/lil_nocap/__init__.py
+-rw-r--r--   0        0        0        0 2023-03-23 15:05:43.219167 lil_nocap-0.5.4/lil_nocap/opinions.jsonl
+-rw-r--r--   0        0        0      324 2023-03-20 15:40:07.101005 lil_nocap-0.5.4/lil_nocap/test.py
+-rw-r--r--   0        0        0        0 2023-03-20 15:34:19.022580 lil_nocap-0.5.4/lil_nocap/test.txt
+-rw-r--r--   0        0        0      498 2023-05-03 16:17:09.408113 lil_nocap-0.5.4/pyproject.toml
+-rw-r--r--   0        0        0     1732 1970-01-01 00:00:00.000000 lil_nocap-0.5.4/setup.py
+-rw-r--r--   0        0        0     1597 1970-01-01 00:00:00.000000 lil_nocap-0.5.4/PKG-INFO
```

### Comparing `lil_nocap-0.5.2/README.md` & `lil_nocap-0.5.4/README.md`

 * *Files identical despite different names*

### Comparing `lil_nocap-0.5.2/lil_nocap/.__init__.py.swp` & `lil_nocap-0.5.4/lil_nocap/.__init__.py.swp`

 * *Files 23% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 00000000: 6230 5649 4d20 382e 3200 0000 0010 0000  b0VIM 8.2.......
-00000010: d310 4064 f591 c800 8243 0000 7361 6265  ..@d.....C..sabe
+00000010: 80ba 5264 2ca0 d300 2249 0100 7361 6265  ..Rd,..."I..sabe
 00000020: 6c6f 7365 7468 756d 686c 616d 6269 0000  losethumhlambi..
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 484c 5343 3032 5a56 3342 434d  ....HLSC02ZV3BCM
 00000050: 4436 5400 0000 0000 0000 0000 0000 0000  D6T.............
 00000060: 0000 0000 0000 0000 0000 0000 7e73 6162  ............~sab
 00000070: 656c 6f73 6574 6875 6d68 6c61 6d62 692f  elosethumhlambi/
 00000080: 446f 6375 6d65 6e74 732f 4769 7448 7562  Documents/GitHub
@@ -250,31 +250,31 @@
 00000f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001000: 7470 0600 7f00 0000 0200 0000 0000 0000  tp..............
-00001010: 1500 0000 0000 0000 0100 0000 0000 0000  ................
-00001020: 0100 0000 0000 0000 0300 0000 0000 0000  ................
-00001030: 5e00 0000 0000 0000 0f00 0000 0000 0000  ^...............
-00001040: 0100 0000 0000 0000 0400 0000 0000 0000  ................
-00001050: 2c00 0000 0000 0000 6b00 0000 0000 0000  ,.......k.......
-00001060: 0100 0000 0000 0000 0600 0000 0000 0000  ................
-00001070: 2500 0000 0000 0000 9e00 0000 0000 0000  %...............
-00001080: 0100 0000 0000 0000 0700 0000 0000 0000  ................
-00001090: 6100 0000 0000 0000 b000 0000 0000 0000  a...............
-000010a0: 0100 0000 0000 0000 0500 0000 0000 0000  ................
-000010b0: 3800 0000 0000 0000 dd00 0000 0000 0000  8...............
-000010c0: 0100 0000 0000 0000 0000 0000 0000 0000  ................
-000010d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000010e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000010f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00001000: 7470 0800 7f00 0000 0200 0000 0000 0000  tp..............
+00001010: 0f00 0000 0000 0000 0100 0000 0000 0000  ................
+00001020: 0100 0000 0000 0000 0900 0000 0000 0000  ................
+00001030: 6a00 0000 0000 0000 1000 0000 0000 0000  j...............
+00001040: 0100 0000 0000 0000 0500 0000 0000 0000  ................
+00001050: 2400 0000 0000 0000 7800 0000 0000 0000  $.......x.......
+00001060: 0100 0000 0000 0000 0400 0000 0000 0000  ................
+00001070: 4400 0000 0000 0000 a300 0000 0000 0000  D...............
+00001080: 0100 0000 0000 0000 0600 0000 0000 0000  ................
+00001090: 3000 0000 0000 0000 e600 0000 0000 0000  0...............
+000010a0: 0100 0000 0000 0000 0700 0000 0000 0000  ................
+000010b0: 3e00 0000 0000 0000 1201 0000 0000 0000  >...............
+000010c0: 0100 0000 0000 0000 0800 0000 0000 0000  ................
+000010d0: 6100 0000 0000 0000 4b01 0000 0000 0000  a.......K.......
+000010e0: 0100 0000 0000 0000 0300 0000 0000 0000  ................
+000010f0: 2200 0000 0000 0000 b301 0000 0000 0000  "...............
+00001100: 0100 0000 0000 0000 0000 0000 0000 0000  ................
 00001110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -506,1320 +506,1320 @@
 00001f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002000: 6164 0000 e60d 0000 560e 0000 0010 0000  ad......V.......
-00002010: 1500 0000 0000 0000 f00f 0000 dc0f 0000  ................
-00002020: b40f 0000 a10f 0000 950f 0000 7f0f 0000  ................
-00002030: 510f 0000 350f 0000 0b0f 0000 ee0e 0000  Q...5...........
-00002040: e20e 0000 d40e 0000 ca0e 0000 bd0e 0000  ................
-00002050: b30e 0000 a40e 0000 8a0e 0000 6e0e 0000  ............n...
-00002060: 620e 0000 570e 0000 560e 0000 c80d 0000  b...W...V.......
-00002070: 9c0d 0000 5c0d 0000 2c0d 0000 fe0c 0000  ....\...,.......
-00002080: fd0c 0000 cc0c 0000 9f0c 0000 9e0c 0000  ................
-00002090: 890c 0000 400c 0000 ee0b 0000 a60b 0000  ....@...........
-000020a0: 5e0b 0000 100b 0000 f40a 0000 d10a 0000  ^...............
-000020b0: cc0a 0000 a50a 0000 840a 0000 5f0a 0000  ............_...
-000020c0: 3e0a 0000 180a 0000 f609 0000 d309 0000  >...............
-000020d0: bd09 0000 ad09 0000 9709 0000 5109 0000  ............Q...
-000020e0: f708 0000 d808 0000 c608 0000 a608 0000  ................
-000020f0: 8808 0000 7008 0000 6f08 0000 3208 0000  ....p...o...2...
-00002100: b807 0000 9807 0000 6e07 0000 4107 0000  ........n...A...
-00002110: 0f07 0000 df06 0000 d106 0000 b306 0000  ................
-00002120: 5d06 0000 e905 0000 df05 0000 7005 0000  ]...........p...
-00002130: 5205 0000 1305 0000 0505 0000 0405 0000  R...............
-00002140: ed04 0000 cd04 0000 b504 0000 b404 0000  ................
-00002150: 8404 0000 5d04 0000 5a04 0000 2b04 0000  ....]...Z...+...
-00002160: 0404 0000 f603 0000 d703 0000 be03 0000  ................
-00002170: 9d03 0000 7a03 0000 5a03 0000 3603 0000  ....z...Z...6...
-00002180: 3103 0000 1503 0000 0303 0000 e502 0000  1...............
-00002190: d302 0000 b402 0000 a102 0000 8202 0000  ................
-000021a0: 6e02 0000 5002 0000 3d02 0000 1e02 0000  n...P...=.......
-000021b0: 0b02 0000 fb01 0000 fa01 0000 c501 0000  ................
-000021c0: ed01 0000 0020 2064 6566 2067 6574 5f63  .....  def get_c
-000021d0: 6974 6174 696f 6e73 2873 656c 662c 206f  itations(self, o
-000021e0: 7069 6e69 6f6e 5f69 642c 2064 665f 6369  pinion_id, df_ci
-000021f0: 7461 7469 6f6e 7329 3a00 0020 2020 2072  tations):..    r
-00002200: 6574 7572 6e20 7465 7874 0020 2020 2020  eturn text.     
-00002210: 2020 2074 6578 7420 3d20 686c 6100 2020     text = hla.  
-00002220: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00002230: 6528 686c 612c 2073 7472 293a 0020 2020  e(hla, str):.   
-00002240: 2020 2020 2074 6578 7420 3d20 7868 2000       text = xh .
-00002250: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00002260: 6e63 6528 7868 2c20 7374 7229 3a00 2020  nce(xh, str):.  
-00002270: 2020 2020 2020 7465 7874 203d 2068 6c63        text = hlc
-00002280: 2000 2020 2020 656c 6966 2069 7369 6e73   .    elif isins
-00002290: 7461 6e63 6528 686c 632c 2073 7472 293a  tance(hlc, str):
-000022a0: 0020 2020 2020 2020 2074 6578 7420 3d20  .        text = 
-000022b0: 686c 6200 2020 2020 656c 6966 2069 7369  hlb.    elif isi
-000022c0: 6e73 7461 6e63 6528 686c 622c 2073 7472  nstance(hlb, str
-000022d0: 293a 0020 2020 2020 2020 2074 6578 7420  ):.        text 
-000022e0: 3d20 686c 0020 2020 2065 6c69 6620 6973  = hl.    elif is
-000022f0: 696e 7374 616e 6365 2868 6c2c 2073 7472  instance(hl, str
-00002300: 293a 0020 2020 2020 2020 2074 6578 7420  ):.        text 
-00002310: 3d20 7074 0020 2020 2069 6620 6973 696e  = pt.    if isin
-00002320: 7374 616e 6365 2870 742c 2073 7472 293a  stance(pt, str):
-00002330: 0020 2020 2000 2020 2020 686c 6120 3d20  .    .    hla = 
-00002340: 6f70 696e 696f 6e5b 2768 746d 6c5f 616e  opinion['html_an
-00002350: 6f6e 5f32 3032 3027 5d00 2020 2020 7868  on_2020'].    xh
-00002360: 203d 206f 7069 6e69 6f6e 5b27 786d 6c5f   = opinion['xml_
-00002370: 6861 7276 6172 6427 5d00 2020 2020 686c  harvard'].    hl
-00002380: 6320 3d20 6f70 696e 696f 6e5b 2768 746d  c = opinion['htm
-00002390: 6c5f 636f 6c75 6d62 6961 275d 0020 2020  l_columbia'].   
-000023a0: 2068 6c62 203d 206f 7069 6e69 6f6e 5b27   hlb = opinion['
-000023b0: 6874 6d6c 5f6c 6177 626f 7827 5d00 2020  html_lawbox'].  
-000023c0: 2020 686c 203d 206f 7069 6e69 6f6e 5b27    hl = opinion['
-000023d0: 6874 6d6c 275d 0020 2020 2070 7420 3d20  html'].    pt = 
-000023e0: 6f70 696e 696f 6e5b 2770 6c61 696e 5f74  opinion['plain_t
-000023f0: 6578 7427 5d00 2020 2020 7465 7874 203d  ext'].    text =
-00002400: 2027 2700 2020 6465 6620 6765 745f 6f70   ''.  def get_op
-00002410: 696e 696f 6e5f 7465 7874 2873 656c 662c  inion_text(self,
-00002420: 206f 7069 6e69 6f6e 293a 0020 2023 2061   opinion):.  # a
-00002430: 6363 6570 7473 2061 2073 6572 6965 7320  ccepts a series 
-00002440: 2d2d 2061 2072 6f77 2066 726f 6d20 6120  -- a row from a 
-00002450: 6461 7461 6672 616d 6500 2020 0020 2020  dataframe.  .   
-00002460: 2072 6574 7572 6e20 6466 2e6c 6f63 5b64   return df.loc[d
-00002470: 665b 636f 6c75 6d6e 5d20 3d3d 206d 6174  f[column] == mat
-00002480: 6368 5d00 2020 6465 6620 6466 5f72 6f77  ch].  def df_row
-00002490: 5f62 795f 7661 6c75 6528 7365 6c66 2c20  _by_value(self, 
-000024a0: 6466 2c20 636f 6c75 6d6e 2c20 6d61 7463  df, column, matc
-000024b0: 6829 3a00 0020 2020 2072 6574 7572 6e20  h):..    return 
-000024c0: 7365 6c66 2e5f 636c 6965 6e74 0020 2064  self._client.  d
-000024d0: 6566 2067 6574 5f63 6c75 7374 6572 5f63  ef get_cluster_c
-000024e0: 6c69 656e 7428 7365 6c66 293a 0020 2023  lient(self):.  #
-000024f0: 2067 6574 2063 6c75 7374 6572 2063 6c69   get cluster cli
-00002500: 656e 7400 0020 2020 2072 6574 7572 6e20  ent..    return 
-00002510: 6466 0020 2020 2070 7269 6e74 2866 277b  df.    print(f'{
-00002520: 6669 6c65 6e61 6d65 7d20 7265 6164 2069  filename} read i
-00002530: 6e20 7b69 6e74 2828 656e 642d 7374 6172  n {int((end-star
-00002540: 7429 2f36 3029 7d20 6d69 6e75 7465 7327  t)/60)} minutes'
-00002550: 2900 2020 2020 656e 6420 3d20 7469 6d65  ).    end = time
-00002560: 2e70 6572 665f 636f 756e 7465 7228 2900  .perf_counter().
-00002570: 2020 2020 2020 2020 6466 203d 2070 642e          df = pd.
-00002580: 7265 6164 5f63 7376 2866 696c 656e 616d  read_csv(filenam
-00002590: 652c 2064 7479 7065 3d64 7479 7065 2c20  e, dtype=dtype, 
-000025a0: 7061 7273 655f 6461 7465 733d 7061 7273  parse_dates=pars
-000025b0: 655f 6461 7465 732c 2075 7365 636f 6c73  e_dates, usecols
-000025c0: 3d75 7365 636f 6c73 2c20 696e 6465 785f  =usecols, index_
-000025d0: 636f 6c3d 696e 6465 785f 636f 6c29 0020  col=index_col). 
-000025e0: 2020 2065 6c73 653a 0020 2020 2020 2020     else:.       
-000025f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002610: 6474 7970 653d 6474 7970 652c 2070 6172  dtype=dtype, par
-00002620: 7365 5f64 6174 6573 3d70 6172 7365 5f64  se_dates=parse_d
-00002630: 6174 6573 2c20 7573 6563 6f6c 733d 7573  ates, usecols=us
-00002640: 6563 6f6c 732c 2069 6e64 6578 5f63 6f6c  ecols, index_col
-00002650: 3d69 6e64 6578 5f63 6f6c 2929 0020 2020  =index_col)).   
-00002660: 2020 2020 2064 6620 3d20 7064 2e63 6f6e       df = pd.con
-00002670: 6361 7428 7365 6c66 2e72 6561 645f 6373  cat(self.read_cs
-00002680: 765f 6173 5f64 6673 2866 696c 656e 616d  v_as_dfs(filenam
-00002690: 652c 206e 756d 5f64 6673 3d31 302a 2a35  e, num_dfs=10**5
-000026a0: 2c20 6d61 785f 726f 7773 3d31 302a 2a37  , max_rows=10**7
-000026b0: 2c20 0020 2020 2069 6620 6669 6c65 5f73  , .    if file_s
-000026c0: 697a 655f 6762 203e 206d 6178 5f67 623a  ize_gb > max_gb:
-000026d0: 0020 2020 2064 6620 3d20 4e6f 6e65 0020  .    df = None. 
-000026e0: 2020 2070 7269 6e74 2822 4669 6c65 2053     print("File S
-000026f0: 697a 6520 6973 203a 222c 2066 696c 655f  ize is :", file_
-00002700: 7369 7a65 5f67 622c 2022 4742 2229 0020  size_gb, "GB"). 
-00002710: 2020 2070 7269 6e74 2866 2749 6d70 6f72     print(f'Impor
-00002720: 7469 6e67 207b 6669 6c65 6e61 6d65 7d20  ting {filename} 
-00002730: 6173 2061 2064 6174 6166 7261 6d65 2729  as a dataframe')
-00002740: 0020 2020 2066 696c 655f 7369 7a65 5f67  .    file_size_g
-00002750: 6220 3d20 726f 756e 6428 6669 6c65 5f73  b = round(file_s
-00002760: 697a 652f 3130 2a2a 392c 2032 2900 2020  ize/10**9, 2).  
-00002770: 2020 6669 6c65 5f73 697a 6520 3d20 6f73    file_size = os
-00002780: 2e70 6174 682e 6765 7473 697a 6528 6669  .path.getsize(fi
-00002790: 6c65 6e61 6d65 2900 2020 2020 7374 6172  lename).    star
-000027a0: 7420 3d20 7469 6d65 2e70 6572 665f 636f  t = time.perf_co
-000027b0: 756e 7465 7228 2900 2020 6465 6620 6373  unter().  def cs
-000027c0: 765f 746f 5f64 6628 7365 6c66 2c20 6669  v_to_df(self, fi
-000027d0: 6c65 6e61 6d65 2c20 6474 7970 6520 3d20  lename, dtype = 
-000027e0: 4e6f 6e65 2c20 7061 7273 655f 6461 7465  None, parse_date
-000027f0: 7320 3d20 4e6f 6e65 2c20 6d61 785f 6762  s = None, max_gb
-00002800: 3d35 2c20 6e75 6d5f 6466 733d 3130 2a2a  =5, num_dfs=10**
-00002810: 332c 2075 7365 636f 6c73 3d4e 6f6e 652c  3, usecols=None,
-00002820: 2069 6e64 6578 5f63 6f6c 3d4e 6f6e 6529   index_col=None)
-00002830: 3a00 2020 2320 6765 7420 6120 706f 7465  :.  # get a pote
-00002840: 6e74 6961 6c6c 7920 6c61 7267 6520 6373  ntially large cs
-00002850: 7620 616e 6420 7475 726e 2069 7420 696e  v and turn it in
-00002860: 746f 2061 2044 6174 6146 7261 6d65 0000  to a DataFrame..
-00002870: 2020 2020 7265 7475 726e 2064 6673 5f6f      return dfs_o
-00002880: 7069 6e69 6f6e 7300 2020 2020 2020 2020  pinions.        
-00002890: 636f 756e 7465 7220 3d20 636f 756e 7465  counter = counte
-000028a0: 7220 2b20 3100 2020 2020 2020 2020 6466  r + 1.        df
-000028b0: 735f 6f70 696e 696f 6e73 2e61 7070 656e  s_opinions.appen
-000028c0: 6428 6466 2900 2020 2020 2020 2020 2020  d(df).          
-000028d0: 2020 6272 6561 6b00 2020 2020 2020 2020    break.        
-000028e0: 6966 2063 6f75 6e74 6572 203e 3d20 6e75  if counter >= nu
-000028f0: 6d5f 6466 733a 0020 2020 2020 2020 2020  m_dfs:.         
-00002900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002910: 2070 6172 7365 5f64 6174 6573 3d70 6172   parse_dates=par
-00002920: 7365 5f64 6174 6573 2c20 7573 6563 6f6c  se_dates, usecol
-00002930: 733d 7573 6563 6f6c 732c 2069 6e64 6578  s=usecols, index
-00002940: 5f63 6f6c 3d69 6e64 6578 5f63 6f6c 293a  _col=index_col):
-00002950: 0020 2020 2066 6f72 2064 6620 696e 2070  .    for df in p
-00002960: 642e 7265 6164 5f63 7376 2866 696c 656e  d.read_csv(filen
-00002970: 616d 652c 2063 6875 6e6b 7369 7a65 3d6d  ame, chunksize=m
-00002980: 6178 5f72 6f77 732c 2064 7479 7065 3d64  ax_rows, dtype=d
-00002990: 7479 7065 2c20 0020 2020 2064 6673 5f6f  type, .    dfs_o
-000029a0: 7069 6e69 6f6e 7320 3d20 5b5d 0020 2020  pinions = [].   
-000029b0: 2063 6f75 6e74 6572 203d 2030 0020 2020   counter = 0.   
-000029c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029d0: 293a 0020 2020 2020 2020 2020 2020 2020  ):.             
-000029e0: 2020 2020 2020 2069 6e64 6578 5f63 6f6c         index_col
-000029f0: 3d4e 6f6e 6500 2020 2020 2020 2020 2020  =None.          
-00002a00: 2020 2020 2020 2020 2020 7573 6563 6f6c            usecol
-00002a10: 733d 4e6f 6e65 2c00 2020 2020 2020 2020  s=None,.        
-00002a20: 2020 2020 2020 2020 2020 2020 7061 7273              pars
-00002a30: 655f 6461 7465 733d 4e6f 6e65 2c00 2020  e_dates=None,.  
-00002a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a50: 2020 6474 7970 653d 4e6f 6e65 2c20 0020    dtype=None, . 
-00002a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a70: 2020 206d 6178 5f72 6f77 733d 3130 2a2a     max_rows=10**
-00002a80: 352c 2000 2020 2020 2020 2020 2020 2020  5, .            
-00002a90: 2020 2020 2020 2020 6e75 6d5f 6466 733d          num_dfs=
-00002aa0: 3130 2c20 0020 2064 6566 2072 6561 645f  10, .  def read_
-00002ab0: 6373 765f 6173 5f64 6673 2873 656c 662c  csv_as_dfs(self,
-00002ac0: 2066 696c 656e 616d 652c 2000 2020 2020   filename, .    
-00002ad0: 0020 2020 204e 6f43 6170 286f 2c20 6f63  .    NoCap(o, oc
-00002ae0: 2c20 632c 2064 2c20 636d 292e 7374 6172  , c, d, cm).star
-00002af0: 7428 2900 2020 6465 6620 636c 6928 6f2c  t().  def cli(o,
-00002b00: 206f 632c 2063 2c20 642c 2063 6d29 3a00   oc, c, d, cm):.
-00002b10: 2020 4063 6c69 636b 2e6f 7074 696f 6e28    @click.option(
-00002b20: 272d 636d 272c 2068 656c 703d 226c 6f63  '-cm', help="loc
-00002b30: 616c 2070 6174 6820 746f 2063 6974 6174  al path to citat
-00002b40: 696f 6e20 6d61 7020 6669 6c65 222c 2072  ion map file", r
-00002b50: 6571 7569 7265 643d 5472 7565 2900 2020  equired=True).  
-00002b60: 4063 6c69 636b 2e6f 7074 696f 6e28 272d  @click.option('-
-00002b70: 6427 2c20 6865 6c70 3d22 6c6f 6361 6c20  d', help="local 
-00002b80: 7061 7468 2074 6f20 646f 636b 6574 7320  path to dockets 
-00002b90: 6669 6c65 222c 2072 6571 7569 7265 643d  file", required=
-00002ba0: 5472 7565 2900 2020 4063 6c69 636b 2e6f  True).  @click.o
-00002bb0: 7074 696f 6e28 272d 6327 2c20 6865 6c70  ption('-c', help
-00002bc0: 3d22 6c6f 6361 6c20 7061 7468 2074 6f20  ="local path to 
-00002bd0: 636f 7572 7473 2066 696c 6520 222c 2072  courts file ", r
-00002be0: 6571 7569 7265 643d 5472 7565 2900 2020  equired=True).  
-00002bf0: 4063 6c69 636b 2e6f 7074 696f 6e28 272d  @click.option('-
-00002c00: 6f63 272c 2068 656c 703d 226c 6f63 616c  oc', help="local
-00002c10: 2070 6174 6820 746f 206f 7069 6e69 6f6e   path to opinion
-00002c20: 2063 6c75 7374 6572 7320 6669 6c65 222c   clusters file",
-00002c30: 2072 6571 7569 7265 643d 5472 7565 2900   required=True).
-00002c40: 2020 4063 6c69 636b 2e6f 7074 696f 6e28    @click.option(
-00002c50: 272d 6f27 2c20 6865 6c70 3d22 6c6f 6361  '-o', help="loca
-00002c60: 6c20 7061 7468 2074 6f20 6f70 696e 696f  l path to opinio
-00002c70: 6e73 2066 696c 6522 2c20 7265 7175 6972  ns file", requir
-00002c80: 6564 3d54 7275 6529 0020 2040 636c 6963  ed=True).  @clic
-00002c90: 6b2e 636f 6d6d 616e 6428 2920 2000 0020  k.command()  .. 
-00002ca0: 2020 2073 656c 662e 4461 7461 4672 616d     self.DataFram
-00002cb0: 6520 3d20 7064 2e63 6f72 652e 6672 616d  e = pd.core.fram
-00002cc0: 652e 4461 7461 4672 616d 6500 2020 2020  e.DataFrame.    
-00002cd0: 2373 656c 662e 5f64 665f 6f70 696e 696f  #self._df_opinio
-00002ce0: 6e73 203d 2073 656c 662e 696e 6974 5f6f  ns = self.init_o
-00002cf0: 7069 6e69 6f6e 735f 6466 2829 0000 2020  pinions_df()..  
-00002d00: 2020 7365 6c66 2e5f 6466 5f64 6f63 6b65    self._df_docke
-00002d10: 7473 203d 2073 656c 662e 696e 6974 5f64  ts = self.init_d
-00002d20: 6f63 6b65 7473 5f64 6628 2900 2020 2020  ockets_df().    
-00002d30: 7365 6c66 2e5f 6466 5f63 6974 6174 696f  self._df_citatio
-00002d40: 6e20 3d20 7365 6c66 2e69 6e69 745f 6369  n = self.init_ci
-00002d50: 7461 7469 6f6e 5f64 6628 2900 2020 2020  tation_df().    
-00002d60: 7365 6c66 2e5f 6466 5f6f 7069 6e69 6f6e  self._df_opinion
-00002d70: 5f63 6c75 7374 6572 7320 3d20 7365 6c66  _clusters = self
-00002d80: 2e69 6e69 745f 6f70 696e 696f 6e5f 636c  .init_opinion_cl
-00002d90: 7573 7465 7273 5f64 6628 2900 2020 2020  usters_df().    
-00002da0: 7365 6c66 2e5f 6466 5f63 6f75 7274 7320  self._df_courts 
-00002db0: 3d20 7365 6c66 2e69 6e69 745f 636f 7572  = self.init_cour
-00002dc0: 7473 5f64 6628 2900 0020 2020 2073 656c  ts_df()..    sel
-00002dd0: 662e 5f63 6974 6174 696f 6e5f 666e 203d  f._citation_fn =
-00002de0: 2063 6974 6174 696f 6e5f 666e 0020 2020   citation_fn.   
-00002df0: 2073 656c 662e 5f64 6f63 6b65 7473 5f66   self._dockets_f
-00002e00: 6e20 3d20 646f 636b 6574 735f 666e 0020  n = dockets_fn. 
-00002e10: 2020 2073 656c 662e 5f63 6f75 7274 735f     self._courts_
-00002e20: 666e 203d 2063 6f75 7274 735f 666e 0020  fn = courts_fn. 
-00002e30: 2020 2073 656c 662e 5f6f 7069 6e69 6f6e     self._opinion
-00002e40: 5f63 6c75 7374 6572 735f 666e 2000 6366  _clusters_fn .cf
-00002e50: 672e 7365 7428 0069 6d70 6f72 7420 6373  g.set(.import cs
-00002e60: 7600 696d 706f 7274 206a 736f 6e00 6c6f  v.import json.lo
-00002e70: 672e 7365 744c 6576 656c 286c 6f67 6769  g.setLevel(loggi
-00002e80: 6e67 2e44 4542 5547 2900 6c6f 6720 3d20  ng.DEBUG).log = 
-00002e90: 6c6f 6767 696e 672e 6765 744c 6f67 6765  logging.getLogge
-00002ea0: 7228 2900 696d 706f 7274 206c 6f67 6769  r().import loggi
-00002eb0: 6e67 0069 6d70 6f72 7420 7265 0069 6d70  ng.import re.imp
-00002ec0: 6f72 7420 636c 6963 6b00 696d 706f 7274  ort click.import
-00002ed0: 206f 7300 696d 706f 7274 2074 696d 6569   os.import timei
-00002ee0: 7400 696d 706f 7274 2074 696d 6500 696d  t.import time.im
-00002ef0: 706f 7274 206d 756c 7469 7072 6f63 6573  port multiproces
-00002f00: 7369 6e67 2061 7320 6d70 0066 726f 6d20  sing as mp.from 
-00002f10: 6461 736b 2e64 6973 7472 6962 7574 6564  dask.distributed
-00002f20: 2069 6d70 6f72 7420 6173 5f63 6f6d 706c   import as_compl
-00002f30: 6574 6564 0069 6d70 6f72 7420 6461 736b  eted.import dask
-00002f40: 2e64 6174 6166 7261 6d65 2061 7320 6464  .dataframe as dd
-00002f50: 0066 726f 6d20 6461 736b 2e64 6973 7472  .from dask.distr
-00002f60: 6962 7574 6564 2069 6d70 6f72 7420 436c  ibuted import Cl
-00002f70: 6965 6e74 2c20 7072 6f67 7265 7373 0069  ient, progress.i
-00002f80: 6d70 6f72 7420 6461 736b 2e62 6167 2061  mport dask.bag a
-00002f90: 7320 6462 0069 6d70 6f72 7420 6461 736b  s db.import dask
-00002fa0: 0069 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
-00002fb0: 206e 7000 6672 6f6d 2070 616e 6461 732e   np.from pandas.
-00002fc0: 5f6c 6962 732e 6d69 7373 696e 6720 696d  _libs.missing im
-00002fd0: 706f 7274 204e 4154 7970 6500 696d 706f  port NAType.impo
-00002fe0: 7274 2070 616e 6461 7320 6173 2070 6400  rt pandas as pd.
-00002ff0: 2321 2f75 7372 2f62 696e 2f65 6e76 2000  #!/usr/bin/env .
-00003000: 6164 0000 e500 0000 7902 0000 0010 0000  ad......y.......
-00003010: 5e00 0000 0000 0000 f30f 0000 970f 0000  ^...............
-00003020: 790f 0000 550f 0000 210f 0000 010f 0000  y...U...!.......
-00003030: df0e 0000 bb0e 0000 ba0e 0000 8e0e 0000  ................
-00003040: 4e0e 0000 1e0e 0000 d50d 0000 d40d 0000  N...............
-00003050: a30d 0000 760d 0000 750d 0000 600d 0000  ....v...u...`...
-00003060: 170d 0000 c50c 0000 7d0c 0000 350c 0000  ........}...5...
-00003070: e70b 0000 cb0b 0000 a80b 0000 a30b 0000  ................
-00003080: 7c0b 0000 5b0b 0000 360b 0000 150b 0000  |...[...6.......
-00003090: ef0a 0000 cd0a 0000 aa0a 0000 940a 0000  ................
-000030a0: 840a 0000 6e0a 0000 280a 0000 ce09 0000  ....n...(.......
-000030b0: af09 0000 9d09 0000 7d09 0000 5f09 0000  ........}..._...
-000030c0: 4709 0000 4609 0000 0909 0000 8f08 0000  G...F...........
-000030d0: 6f08 0000 4508 0000 1808 0000 e207 0000  o...E...........
-000030e0: af07 0000 9c07 0000 8e07 0000 7007 0000  ............p...
-000030f0: 1a07 0000 a606 0000 9c06 0000 2d06 0000  ............-...
-00003100: 0f06 0000 c705 0000 b905 0000 b805 0000  ................
-00003110: a105 0000 8105 0000 6905 0000 6805 0000  ........i...h...
-00003120: 3805 0000 1105 0000 0e05 0000 df04 0000  8...............
-00003130: b804 0000 aa04 0000 8b04 0000 7204 0000  ............r...
-00003140: 5104 0000 2e04 0000 0e04 0000 ea03 0000  Q...............
-00003150: e503 0000 c903 0000 b703 0000 9903 0000  ................
-00003160: 8703 0000 6803 0000 5503 0000 3603 0000  ....h...U...6...
-00003170: 2203 0000 0403 0000 f102 0000 d202 0000  "...............
-00003180: bf02 0000 af02 0000 ae02 0000 7902 0000  ............y...
-00003190: 8902 0000 9202 0000 5e02 0000 3f02 0000  ........^...?...
+00002000: 6164 0000 7d0e 0000 d50e 0000 0010 0000  ad..}...........
+00002010: 0f00 0000 0000 0000 f10f 0000 dd0f 0000  ................
+00002020: b50f 0000 a20f 0000 850f 0000 790f 0000  ............y...
+00002030: 6f0f 0000 620f 0000 580f 0000 490f 0000  o...b...X...I...
+00002040: 270f 0000 0c0f 0000 f30e 0000 d60e 0000  '...............
+00002050: d50e 0000 c60e 0000 bb0e 0000 7b0e 0000  ............{...
+00002060: 6f0e 0000 640e 0000 440e 0000 360e 0000  o...d...D...6...
+00002070: 2b0e 0000 1a0e 0000 190e 0000 0c0e 0000  +...............
+00002080: fa0d 0000 a70d 0000 a00d 0000 7e0d 0000  ............~...
+00002090: 560d 0000 1e0d 0000 fa0c 0000 d40c 0000  V...............
+000020a0: ac0c 0000 ab0c 0000 7b0c 0000 360c 0000  ........{...6...
+000020b0: fb0b 0000 f10b 0000 b60b 0000 660b 0000  ............f...
+000020c0: 650b 0000 2f0b 0000 fe0a 0000 fd0a 0000  e.../...........
+000020d0: e80a 0000 9d0a 0000 490a 0000 ff09 0000  ........I.......
+000020e0: b509 0000 6509 0000 4709 0000 2009 0000  ....e...G... ...
+000020f0: 1f09 0000 0609 0000 f808 0000 e608 0000  ................
+00002100: d208 0000 ba08 0000 a608 0000 8c08 0000  ................
+00002110: 7608 0000 5e08 0000 5708 0000 4308 0000  v...^...W...C...
+00002120: 2908 0000 0a08 0000 f407 0000 d407 0000  )...............
+00002130: bb07 0000 9607 0000 7907 0000 5807 0000  ........y...X...
+00002140: 4d07 0000 2a07 0000 1407 0000 f006 0000  M...*...........
+00002150: ce06 0000 b206 0000 b106 0000 7206 0000  ............r...
+00002160: 5f06 0000 5106 0000 3f06 0000 2b06 0000  _...Q...?...+...
+00002170: 1106 0000 ff05 0000 e805 0000 d205 0000  ................
+00002180: ba05 0000 b305 0000 8f05 0000 6105 0000  ............a...
+00002190: 2e05 0000 f404 0000 bd04 0000 a604 0000  ................
+000021a0: 9404 0000 7204 0000 5604 0000 3004 0000  ....r...V...0...
+000021b0: 1204 0000 ef03 0000 cb03 0000 aa03 0000  ................
+000021c0: 7d03 0000 5803 0000 2f03 0000 1d03 0000  }...X.../.......
+000021d0: 0f03 0000 0103 0000 e302 0000 c902 0000  ................
+000021e0: ac02 0000 8302 0000 6202 0000 3d02 0000  ........b...=...
+000021f0: 2f02 0000 0d02 0000 0000 2020 2020 2020  /.........      
+00002200: 2020 656e 6420 3d20 7469 6d65 2e20 2020    end = time.   
+00002210: 2020 2020 2065 6e64 203d 2074 696d 652e       end = time.
+00002220: 7065 7266 5f63 6f75 6e74 6572 2829 0020  perf_counter(). 
+00002230: 2020 2020 2020 2020 2020 2029 0020 2020             ).   
+00002240: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+00002250: 6578 5f63 6f6c 3d69 6e64 6578 5f63 6f6c  ex_col=index_col
+00002260: 2c00 2020 2020 2020 2020 2020 2020 2020  ,.              
+00002270: 2020 7573 6563 6f6c 733d 7573 6563 6f6c    usecols=usecol
+00002280: 732c 0020 2020 2020 2020 2020 2020 2020  s,.             
+00002290: 2020 2070 6172 7365 5f64 6174 6573 3d70     parse_dates=p
+000022a0: 6172 7365 5f64 6174 6573 2c00 2020 2020  arse_dates,.    
+000022b0: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+000022c0: 653d 6474 7970 652c 0020 2020 2020 2020  e=dtype,.       
+000022d0: 2020 2020 2020 2020 2066 696c 656e 616d           filenam
+000022e0: 652c 0020 2020 2020 2020 2020 2020 2064  e,.            d
+000022f0: 6620 3d20 7064 2e72 6561 645f 6373 7628  f = pd.read_csv(
+00002300: 0020 2020 2020 2020 2065 6c73 653a 0020  .        else:. 
+00002310: 2020 2020 2020 2020 2020 2029 0020 2020             ).   
+00002320: 2020 2020 2020 2020 2020 2020 2029 0020               ). 
+00002330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002340: 2020 2069 6e64 6578 5f63 6f6c 3d69 6e64     index_col=ind
+00002350: 6578 5f63 6f6c 2c00 2020 2020 2020 2020  ex_col,.        
+00002360: 2020 2020 2020 2020 2020 2020 7573 6563              usec
+00002370: 6f6c 733d 7573 6563 6f6c 732c 0020 2020  ols=usecols,.   
+00002380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002390: 2070 6172 7365 5f64 6174 6573 3d70 6172   parse_dates=par
+000023a0: 7365 5f64 6174 6573 2c00 2020 2020 2020  se_dates,.      
+000023b0: 2020 2020 2020 2020 2020 2020 2020 6474                dt
+000023c0: 7970 653d 6474 7970 652c 0020 2020 2020  ype=dtype,.     
+000023d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000023e0: 6178 5f72 6f77 733d 3130 2a2a 372c 0020  ax_rows=10**7,. 
+000023f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002400: 2020 206e 756d 5f64 6673 3d31 302a 2a35     num_dfs=10**5
+00002410: 2c00 2020 2020 2020 2020 2020 2020 2020  ,.              
+00002420: 2020 2020 2020 6669 6c65 6e61 6d65 2c00        filename,.
+00002430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002440: 7365 6c66 2e72 6561 645f 6373 765f 6173  self.read_csv_as
+00002450: 5f64 6673 2800 2020 2020 2020 2020 2020  _dfs(.          
+00002460: 2020 6466 203d 2070 642e 636f 6e63 6174    df = pd.concat
+00002470: 2800 2020 2020 2020 2020 6966 2066 696c  (.        if fil
+00002480: 655f 7369 7a65 5f67 6220 3e20 6d61 785f  e_size_gb > max_
+00002490: 6762 3a00 2020 2020 2020 2020 6466 203d  gb:.        df =
+000024a0: 204e 6f6e 6500 2020 2020 2020 2020 6c6f   None.        lo
+000024b0: 672e 6465 6275 6728 6d73 6729 0020 2020  g.debug(msg).   
+000024c0: 2020 2020 206d 7367 203d 2066 2246 696c       msg = f"Fil
+000024d0: 6520 5369 7a65 2069 7320 3a20 7b73 7472  e Size is : {str
+000024e0: 2866 696c 655f 7369 7a65 5f67 6229 7d20  (file_size_gb)} 
+000024f0: 4742 2200 2020 2020 2020 2020 6c6f 672e  GB".        log.
+00002500: 6465 6275 6728 6622 496d 706f 7274 696e  debug(f"Importin
+00002510: 6720 7b66 696c 656e 616d 657d 2061 7320  g {filename} as 
+00002520: 6120 6461 7461 6672 616d 6522 2900 2020  a dataframe").  
+00002530: 2020 2020 2020 6669 6c65 5f73 697a 655f        file_size_
+00002540: 6762 203d 2072 6f75 6e64 2866 696c 655f  gb = round(file_
+00002550: 7369 7a65 202f 2031 302a 2a39 2c20 3229  size / 10**9, 2)
+00002560: 0020 2020 2020 2020 2066 696c 655f 7369  .        file_si
+00002570: 7a65 203d 206f 732e 7061 7468 2e67 6574  ze = os.path.get
+00002580: 7369 7a65 2866 696c 656e 616d 6529 0020  size(filename). 
+00002590: 2020 2020 2020 2073 7461 7274 203d 2074         start = t
+000025a0: 696d 652e 7065 7266 5f63 6f75 6e74 6572  ime.perf_counter
+000025b0: 2829 0020 2020 2029 3a00 2020 2020 2020  ().    ):.      
+000025c0: 2020 696e 6465 785f 636f 6c3d 4e6f 6e65    index_col=None
+000025d0: 2c00 2020 2020 2020 2020 7573 6563 6f6c  ,.        usecol
+000025e0: 733d 4e6f 6e65 2c00 2020 2020 2020 2020  s=None,.        
+000025f0: 6e75 6d5f 6466 733d 3130 2a2a 332c 0020  num_dfs=10**3,. 
+00002600: 2020 2020 2020 206d 6178 5f67 623d 352c         max_gb=5,
+00002610: 0020 2020 2020 2020 2070 6172 7365 5f64  .        parse_d
+00002620: 6174 6573 3d4e 6f6e 652c 0020 2020 2020  ates=None,.     
+00002630: 2020 2064 7479 7065 3d4e 6f6e 652c 0020     dtype=None,. 
+00002640: 2020 2020 2020 2066 696c 656e 616d 652c         filename,
+00002650: 0020 2020 2020 2020 2073 656c 662c 0020  .        self,. 
+00002660: 2020 2064 6566 2063 7376 5f74 6f5f 6466     def csv_to_df
+00002670: 2800 2020 2020 2320 6765 7420 6120 706f  (.    # get a po
+00002680: 7465 6e74 6961 6c6c 7920 6c61 7267 6520  tentially large 
+00002690: 6373 7620 616e 6420 7475 726e 2069 7420  csv and turn it 
+000026a0: 696e 746f 2061 2044 6174 6146 7261 6d65  into a DataFrame
+000026b0: 0000 2020 2020 2020 2020 7265 7475 726e  ..        return
+000026c0: 2064 6673 5f6f 7069 6e69 6f6e 7300 2020   dfs_opinions.  
+000026d0: 2020 2020 2020 2020 2020 636f 756e 7465            counte
+000026e0: 7220 3d20 636f 756e 7465 7220 2b20 3100  r = counter + 1.
+000026f0: 2020 2020 2020 2020 2020 2020 6466 735f              dfs_
+00002700: 6f70 696e 696f 6e73 2e61 7070 656e 6428  opinions.append(
+00002710: 6466 2900 2020 2020 2020 2020 2020 2020  df).            
+00002720: 2020 2020 6272 6561 6b00 2020 2020 2020      break.      
+00002730: 2020 2020 2020 6966 2063 6f75 6e74 6572        if counter
+00002740: 203e 3d20 6e75 6d5f 6466 733a 0020 2020   >= num_dfs:.   
+00002750: 2020 2020 2029 3a00 2020 2020 2020 2020       ):.        
+00002760: 2020 2020 696e 6465 785f 636f 6c3d 696e      index_col=in
+00002770: 6465 785f 636f 6c2c 0020 2020 2020 2020  dex_col,.       
+00002780: 2020 2020 2075 7365 636f 6c73 3d75 7365       usecols=use
+00002790: 636f 6c73 2c00 2020 2020 2020 2020 2020  cols,.          
+000027a0: 2020 7061 7273 655f 6461 7465 733d 7061    parse_dates=pa
+000027b0: 7273 655f 6461 7465 732c 0020 2020 2020  rse_dates,.     
+000027c0: 2020 2020 2020 2064 7479 7065 3d64 7479         dtype=dty
+000027d0: 7065 2c00 2020 2020 2020 2020 2020 2020  pe,.            
+000027e0: 6368 756e 6b73 697a 653d 6d61 785f 726f  chunksize=max_ro
+000027f0: 7773 2c00 2020 2020 2020 2020 2020 2020  ws,.            
+00002800: 6669 6c65 6e61 6d65 2c00 2020 2020 2020  filename,.      
+00002810: 2020 666f 7220 6466 2069 6e20 7064 2e72    for df in pd.r
+00002820: 6561 645f 6373 7628 0020 2020 2020 2020  ead_csv(.       
+00002830: 2064 6673 5f6f 7069 6e69 6f6e 7320 3d20   dfs_opinions = 
+00002840: 5b5d 0020 2020 2020 2020 2063 6f75 6e74  [].        count
+00002850: 6572 203d 2030 0020 2020 2029 3a00 2020  er = 0.    ):.  
+00002860: 2020 2020 2020 696e 6465 785f 636f 6c3d        index_col=
+00002870: 4e6f 6e65 2c00 2020 2020 2020 2020 7573  None,.        us
+00002880: 6563 6f6c 733d 4e6f 6e65 2c00 2020 2020  ecols=None,.    
+00002890: 2020 2020 7061 7273 655f 6461 7465 733d      parse_dates=
+000028a0: 4e6f 6e65 2c00 2020 2020 2020 2020 6474  None,.        dt
+000028b0: 7970 653d 4e6f 6e65 2c00 2020 2020 2020  ype=None,.      
+000028c0: 2020 6d61 785f 726f 7773 3d31 302a 2a35    max_rows=10**5
+000028d0: 2c00 2020 2020 2020 2020 6e75 6d5f 6466  ,.        num_df
+000028e0: 733d 3130 2c00 2020 2020 2020 2020 6669  s=10,.        fi
+000028f0: 6c65 6e61 6d65 2c00 2020 2020 2020 2020  lename,.        
+00002900: 7365 6c66 2c00 2020 2020 6465 6620 7265  self,.    def re
+00002910: 6164 5f63 7376 5f61 735f 6466 7328 0000  ad_csv_as_dfs(..
+00002920: 2020 2020 2020 2020 4e6f 4361 7028 6f2c          NoCap(o,
+00002930: 206f 632c 2063 2c20 642c 2063 6d29 2e73   oc, c, d, cm).s
+00002940: 7461 7274 2829 0020 2020 2064 6566 2063  tart().    def c
+00002950: 6c69 286f 2c20 6f63 2c20 632c 2064 2c20  li(o, oc, c, d, 
+00002960: 636d 293a 0020 2020 2040 636c 6963 6b2e  cm):.    @click.
+00002970: 6f70 7469 6f6e 2822 2d63 6d22 2c20 6865  option("-cm", he
+00002980: 6c70 3d22 6c6f 6361 6c20 7061 7468 2074  lp="local path t
+00002990: 6f20 6369 7461 7469 6f6e 206d 6170 2066  o citation map f
+000029a0: 696c 6522 2c20 7265 7175 6972 6564 3d54  ile", required=T
+000029b0: 7275 6529 0020 2020 2040 636c 6963 6b2e  rue).    @click.
+000029c0: 6f70 7469 6f6e 2822 2d64 222c 2068 656c  option("-d", hel
+000029d0: 703d 226c 6f63 616c 2070 6174 6820 746f  p="local path to
+000029e0: 2064 6f63 6b65 7473 2066 696c 6522 2c20   dockets file", 
+000029f0: 7265 7175 6972 6564 3d54 7275 6529 0020  required=True). 
+00002a00: 2020 2040 636c 6963 6b2e 6f70 7469 6f6e     @click.option
+00002a10: 2822 2d63 222c 2068 656c 703d 226c 6f63  ("-c", help="loc
+00002a20: 616c 2070 6174 6820 746f 2063 6f75 7274  al path to court
+00002a30: 7320 6669 6c65 2022 2c20 7265 7175 6972  s file ", requir
+00002a40: 6564 3d54 7275 6529 0020 2020 2040 636c  ed=True).    @cl
+00002a50: 6963 6b2e 6f70 7469 6f6e 2822 2d6f 6322  ick.option("-oc"
+00002a60: 2c20 6865 6c70 3d22 6c6f 6361 6c20 7061  , help="local pa
+00002a70: 7468 2074 6f20 6f70 696e 696f 6e20 636c  th to opinion cl
+00002a80: 7573 7465 7273 2066 696c 6522 2c20 7265  usters file", re
+00002a90: 7175 6972 6564 3d54 7275 6529 0020 2020  quired=True).   
+00002aa0: 2040 636c 6963 6b2e 6f70 7469 6f6e 2822   @click.option("
+00002ab0: 2d6f 222c 2068 656c 703d 226c 6f63 616c  -o", help="local
+00002ac0: 2070 6174 6820 746f 206f 7069 6e69 6f6e   path to opinion
+00002ad0: 7320 6669 6c65 222c 2072 6571 7569 7265  s file", require
+00002ae0: 643d 5472 7565 2900 2020 2020 4063 6c69  d=True).    @cli
+00002af0: 636b 2e63 6f6d 6d61 6e64 2829 0000 2020  ck.command()..  
+00002b00: 2020 2020 2020 7365 6c66 2e44 6174 6146        self.DataF
+00002b10: 7261 6d65 203d 2070 642e 636f 7265 2e66  rame = pd.core.f
+00002b20: 7261 6d65 2e44 6174 6146 7261 6d65 0020  rame.DataFrame. 
+00002b30: 2020 2020 2020 2023 2073 656c 662e 5f64         # self._d
+00002b40: 665f 6f70 696e 696f 6e73 203d 2073 656c  f_opinions = sel
+00002b50: 662e 696e 6974 5f6f 7069 6e69 6f6e 735f  f.init_opinions_
+00002b60: 6466 2829 0000 2020 2020 2020 2020 7365  df()..        se
+00002b70: 6c66 2e5f 6466 5f64 6f63 6b65 7473 203d  lf._df_dockets =
+00002b80: 2073 656c 662e 696e 6974 5f64 6f63 6b65   self.init_docke
+00002b90: 7473 5f64 6963 7428 646f 636b 6574 735f  ts_dict(dockets_
+00002ba0: 666e 2c20 2264 6f63 6b65 7473 2e73 716c  fn, "dockets.sql
+00002bb0: 6974 6522 2900 2020 2020 2020 2020 7365  ite").        se
+00002bc0: 6c66 2e69 6e69 745f 6369 7461 7469 6f6e  lf.init_citation
+00002bd0: 5f64 6963 7428 2920 2373 656c 662e 696e  _dict() #self.in
+00002be0: 6974 5f63 6974 6174 696f 6e5f 6466 2829  it_citation_df()
+00002bf0: 0020 2020 2020 2020 2029 0020 2020 2020  .        ).     
+00002c00: 2020 2020 2020 206f 7069 6e69 6f6e 5f63         opinion_c
+00002c10: 6c75 7374 6572 735f 666e 2c20 226f 7069  lusters_fn, "opi
+00002c20: 6e69 6f6e 5f63 6c75 7374 6572 732e 7371  nion_clusters.sq
+00002c30: 6c69 7465 2200 2020 2020 2020 2020 7365  lite".        se
+00002c40: 6c66 2e5f 6466 5f6f 7069 6e69 6f6e 5f63  lf._df_opinion_c
+00002c50: 6c75 7374 6572 7320 3d20 7365 6c66 2e69  lusters = self.i
+00002c60: 6e69 745f 6f70 696e 696f 6e5f 636c 7573  nit_opinion_clus
+00002c70: 7465 7273 5f64 6963 7428 0020 2020 2020  ters_dict(.     
+00002c80: 2020 2073 656c 662e 5f64 665f 636f 7572     self._df_cour
+00002c90: 7473 203d 2073 656c 662e 696e 6974 5f63  ts = self.init_c
+00002ca0: 6f75 7274 735f 6466 2829 0000 2020 2020  ourts_df()..    
+00002cb0: 2020 2020 7365 6c66 2e5f 6369 7461 7469      self._citati
+00002cc0: 6f6e 5f66 6e20 3d20 6369 7461 7469 6f6e  on_fn = citation
+00002cd0: 5f66 6e00 2020 2020 2020 2020 7365 6c66  _fn.        self
+00002ce0: 2e5f 646f 636b 6574 735f 666e 203d 2064  ._dockets_fn = d
+00002cf0: 6f63 6b65 7473 5f66 6e00 2020 2020 2020  ockets_fn.      
+00002d00: 2020 7365 6c66 2e5f 636f 7572 7473 5f66    self._courts_f
+00002d10: 6e20 3d20 636f 7572 7473 5f66 6e00 2020  n = courts_fn.  
+00002d20: 2020 2020 2020 7365 6c66 2e5f 6f70 696e        self._opin
+00002d30: 696f 6e5f 636c 7573 7465 7273 5f66 6e20  ion_clusters_fn 
+00002d40: 3d20 6f70 696e 696f 6e5f 636c 7573 7465  = opinion_cluste
+00002d50: 7273 5f66 6e00 2020 2020 2020 2020 7365  rs_fn.        se
+00002d60: 6c66 2e5f 6f70 696e 696f 6e73 5f66 6e20  lf._opinions_fn 
+00002d70: 3d20 6f70 696e 696f 6e73 5f66 6e00 2020  = opinions_fn.  
+00002d80: 2020 2020 2020 6c6f 672e 6465 6275 6728        log.debug(
+00002d90: 2249 6e69 7469 616c 697a 696e 6722 2900  "Initializing").
+00002da0: 2020 2020 293a 0020 2020 2020 2020 2073      ):.        s
+00002db0: 656c 662c 206f 7069 6e69 6f6e 735f 666e  elf, opinions_fn
+00002dc0: 2c20 6f70 696e 696f 6e5f 636c 7573 7465  , opinion_cluste
+00002dd0: 7273 5f66 6e2c 2063 6f75 7274 735f 666e  rs_fn, courts_fn
+00002de0: 2c20 646f 636b 6574 735f 666e 2c20 6369  , dockets_fn, ci
+00002df0: 7461 7469 6f6e 5f66 6e00 2020 2020 6465  tation_fn.    de
+00002e00: 6620 5f5f 696e 6974 5f5f 2800 636c 6173  f __init__(.clas
+00002e10: 7320 4e6f 4361 703a 0000 696d 706f 7274  s NoCap:..import
+00002e20: 2074 6872 6561 6469 6e67 0069 6d70 6f72   threading.impor
+00002e30: 7420 627a 3200 696d 706f 7274 2070 6963  t bz2.import pic
+00002e40: 6b6c 6500 6373 762e 6669 656c 645f 7369  kle.csv.field_si
+00002e50: 7a65 5f6c 696d 6974 2831 5f30 3030 5f30  ze_limit(1_000_0
+00002e60: 3030 2900 696d 706f 7274 2063 7376 0069  00).import csv.i
+00002e70: 6d70 6f72 7420 6a73 6f6e 0066 726f 6d20  mport json.from 
+00002e80: 636f 6e63 7572 7265 6e74 2e66 7574 7572  concurrent.futur
+00002e90: 6573 2069 6d70 6f72 7420 5468 7265 6164  es import Thread
+00002ea0: 506f 6f6c 4578 6563 7574 6f72 2c20 6173  PoolExecutor, as
+00002eb0: 5f63 6f6d 706c 6574 656d 756c 7469 7072  _completemultipr
+00002ec0: 6f63 6573 7369 6d70 2e63 7075 5f63 6f75  ocessimp.cpu_cou
+00002ed0: 6e74 2829 0000 696d 706f 7274 206d 756c  nt()..import mul
+00002ee0: 7469 7072 6f63 6573 7369 6e67 2061 7320  tiprocessing as 
+00002ef0: 6d70 0066 726f 6d20 7061 7468 6c69 6220  mp.from pathlib 
+00002f00: 696d 706f 7274 2050 6174 6800 6672 6f6d  import Path.from
+00002f10: 2074 7164 6d2e 6175 746f 2069 6d70 6f72   tqdm.auto impor
+00002f20: 7420 7471 646d 0066 726f 6d20 7371 6c69  t tqdm.from sqli
+00002f30: 7465 6469 6374 2069 6d70 6f72 7420 5371  tedict import Sq
+00002f40: 6c69 7465 4469 6374 0069 6d70 6f72 7420  liteDict.import 
+00002f50: 6c6f 6767 696e 6700 696d 706f 7274 2072  logging.import r
+00002f60: 6500 696d 706f 7274 2063 6c69 636b 0069  e.import click.i
+00002f70: 6d70 6f72 7420 6f73 0069 6d70 6f72 7420  mport os.import 
+00002f80: 7469 6d65 0069 6d70 6f72 7420 6d75 6c74  time.import mult
+00002f90: 6970 726f 6365 7373 696e 6720 6173 206d  iprocessing as m
+00002fa0: 7000 696d 706f 7274 206e 756d 7079 2061  p.import numpy a
+00002fb0: 7320 6e70 0066 726f 6d20 7061 6e64 6173  s np.from pandas
+00002fc0: 2e5f 6c69 6273 2e6d 6973 7369 6e67 2069  ._libs.missing i
+00002fd0: 6d70 6f72 7420 4e41 5479 7065 0069 6d70  mport NAType.imp
+00002fe0: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+00002ff0: 0023 212f 7573 722f 6269 6e2f 656e 7600  .#!/usr/bin/env.
+00003000: 6164 0000 9a0a 0000 3e0b 0000 0010 0000  ad......>.......
+00003010: 2200 0000 0000 0000 e00f 0000 be0f 0000  "...............
+00003020: a00f 0000 830f 0000 790f 0000 780f 0000  ........y...x...
+00003030: 3b0f 0000 3a0f 0000 0c0f 0000 0b0f 0000  ;...:...........
+00003040: d40e 0000 d30e 0000 b30e 0000 6f0e 0000  ............o...
+00003050: 560e 0000 2a0e 0000 e50d 0000 af0d 0000  V...*...........
+00003060: 760d 0000 590d 0000 240d 0000 f20c 0000  v...Y...$.......
+00003070: c10c 0000 920c 0000 740c 0000 4c0c 0000  ........t...L...
+00003080: fc0b 0000 c20b 0000 a00b 0000 6b0b 0000  ............k...
+00003090: 6a0b 0000 690b 0000 4e0b 0000 3e0b 0000  j...i...N...>...
+000030a0: 270b 0000 280b 0000 0000 0000 0000 0000  '...(...........
+000030b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000030c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000030d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000030e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000030f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003230: 0000 0000 0000 0000 0000 0000 0000 0020  ............... 
-00003240: 2020 6465 6620 6765 745f 6369 7461 7469    def get_citati
-00003250: 6f6e 7328 7365 6c66 2c20 6f70 696e 2020  ons(self, opin  
-00003260: 6465 6620 2064 6566 2067 6574 5f63 6974  def  def get_cit
-00003270: 6174 696f 2020 2020 6420 2064 6566 2067  atio    d  def g
-00003280: 6574 5f63 6974 6174 696f 6e73 2873 656c  et_citations(sel
-00003290: 662c 206f 7069 6e69 6f6e 5f69 642c 2064  f, opinion_id, d
-000032a0: 665f 6369 7461 7469 6f6e 7329 3a00 0020  f_citations):.. 
-000032b0: 2020 2072 6574 7572 6e20 7465 7874 0020     return text. 
-000032c0: 2020 2020 2020 2074 6578 7420 3d20 686c         text = hl
-000032d0: 6100 2020 2020 656c 6966 2069 7369 6e73  a.    elif isins
-000032e0: 7461 6e63 6528 686c 612c 2073 7472 293a  tance(hla, str):
-000032f0: 0020 2020 2020 2020 2074 6578 7420 3d20  .        text = 
-00003300: 7868 2000 2020 2020 656c 6966 2069 7369  xh .    elif isi
-00003310: 6e73 7461 6e63 6528 7868 2c20 7374 7229  nstance(xh, str)
-00003320: 3a00 2020 2020 2020 2020 7465 7874 203d  :.        text =
-00003330: 2068 6c63 2000 2020 2020 656c 6966 2069   hlc .    elif i
-00003340: 7369 6e73 7461 6e63 6528 686c 632c 2073  sinstance(hlc, s
-00003350: 7472 293a 0020 2020 2020 2020 2074 6578  tr):.        tex
-00003360: 7420 3d20 686c 6200 2020 2020 656c 6966  t = hlb.    elif
-00003370: 2069 7369 6e73 7461 6e63 6528 686c 622c   isinstance(hlb,
-00003380: 2073 7472 293a 0020 2020 2020 2020 2074   str):.        t
-00003390: 6578 7420 3d20 686c 0020 2020 2065 6c69  ext = hl.    eli
-000033a0: 6620 6973 696e 7374 616e 6365 2868 6c2c  f isinstance(hl,
-000033b0: 2073 7472 293a 0020 2020 2020 2020 2074   str):.        t
-000033c0: 6578 7420 3d20 7074 0020 2020 2069 6620  ext = pt.    if 
-000033d0: 6973 696e 7374 616e 6365 2870 742c 2073  isinstance(pt, s
-000033e0: 7472 293a 0020 2020 2000 2020 2020 686c  tr):.    .    hl
-000033f0: 6120 3d20 6f70 696e 696f 6e5b 2768 746d  a = opinion['htm
-00003400: 6c5f 616e 6f6e 5f32 3032 3027 5d00 2020  l_anon_2020'].  
-00003410: 2020 7868 203d 206f 7069 6e69 6f6e 5b27    xh = opinion['
-00003420: 786d 6c5f 6861 7276 6172 6427 5d00 2020  xml_harvard'].  
-00003430: 2020 686c 6320 3d20 6f70 696e 696f 6e5b    hlc = opinion[
-00003440: 2768 746d 6c5f 636f 6c75 6d62 6961 275d  'html_columbia']
-00003450: 0020 2020 2068 6c62 203d 206f 7069 6e69  .    hlb = opini
-00003460: 6f6e 5b27 6874 6d6c 5f6c 6177 626f 7827  on['html_lawbox'
-00003470: 5d00 2020 2020 686c 203d 206f 7069 6e69  ].    hl = opini
-00003480: 6f6e 5b27 6874 6d6c 275d 0020 2020 2070  on['html'].    p
-00003490: 7420 3d20 6f70 696e 696f 6e5b 2770 6c61  t = opinion['pla
-000034a0: 696e 5f74 6578 7427 5d00 2020 2020 7465  in_text'].    te
-000034b0: 7874 203d 2027 2700 2020 6465 6620 6765  xt = ''.  def ge
-000034c0: 745f 6f70 696e 696f 6e5f 7465 7874 2873  t_opinion_text(s
-000034d0: 656c 662c 206f 7069 6e69 6f6e 293a 0020  elf, opinion):. 
-000034e0: 2023 2061 6363 6570 7473 2061 2073 6572   # accepts a ser
-000034f0: 6965 7320 2d2d 2061 2072 6f77 2066 726f  ies -- a row fro
-00003500: 6d20 6120 6461 7461 6672 616d 6500 2020  m a dataframe.  
-00003510: 0020 2020 2072 6574 7572 6e20 6466 2e6c  .    return df.l
-00003520: 6f63 5b64 665b 636f 6c75 6d6e 5d20 3d3d  oc[df[column] ==
-00003530: 206d 6174 6368 5d00 2020 6465 6620 6466   match].  def df
-00003540: 5f72 6f77 5f62 795f 7661 6c75 6528 7365  _row_by_value(se
-00003550: 6c66 2c20 6466 2c20 636f 6c75 6d6e 2c20  lf, df, column, 
-00003560: 6d61 7463 6829 3a00 0020 2020 2072 6574  match):..    ret
-00003570: 7572 6e20 7365 6c66 2e5f 636c 6965 6e74  urn self._client
-00003580: 0020 2064 6566 2067 6574 5f63 6c75 7374  .  def get_clust
-00003590: 6572 5f63 6c69 656e 7428 7365 6c66 293a  er_client(self):
-000035a0: 0020 2023 2067 6574 2063 6c75 7374 6572  .  # get cluster
-000035b0: 2063 6c69 656e 7400 0020 2020 2072 6574   client..    ret
-000035c0: 7572 6e20 6466 0020 2020 206c 6f67 2e64  urn df.    log.d
-000035d0: 6562 7567 2866 277b 6669 6c65 6e61 6d65  ebug(f'{filename
-000035e0: 7d20 7265 6164 2069 6e20 7b73 7472 2869  } read in {str(i
-000035f0: 6e74 2828 656e 642d 7374 6172 7429 2f36  nt((end-start)/6
-00003600: 3029 297d 206d 696e 7574 6573 2729 0020  0))} minutes'). 
-00003610: 2020 2065 6e64 203d 2074 696d 652e 7065     end = time.pe
-00003620: 7266 5f63 6f75 6e74 6572 2829 0020 2020  rf_counter().   
-00003630: 2020 2020 2064 6620 3d20 7064 2e72 6561       df = pd.rea
-00003640: 645f 6373 7628 6669 6c65 6e61 6d65 2c20  d_csv(filename, 
-00003650: 6474 7970 653d 6474 7970 652c 2070 6172  dtype=dtype, par
-00003660: 7365 5f64 6174 6573 3d70 6172 7365 5f64  se_dates=parse_d
-00003670: 6174 6573 2c20 7573 6563 6f6c 733d 7573  ates, usecols=us
-00003680: 6563 6f6c 732c 2069 6e64 6578 5f63 6f6c  ecols, index_col
-00003690: 3d69 6e64 6578 5f63 6f6c 2900 2020 2020  =index_col).    
-000036a0: 656c 7365 3a00 2020 2020 2020 2020 2020  else:.          
-000036b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000036c0: 2020 2020 2020 2020 2020 2020 2064 7479               dty
-000036d0: 7065 3d64 7479 7065 2c20 7061 7273 655f  pe=dtype, parse_
-000036e0: 6461 7465 733d 7061 7273 655f 6461 7465  dates=parse_date
-000036f0: 732c 2075 7365 636f 6c73 3d75 7365 636f  s, usecols=useco
-00003700: 6c73 2c20 696e 6465 785f 636f 6c3d 696e  ls, index_col=in
-00003710: 6465 785f 636f 6c29 2900 2020 2020 2020  dex_col)).      
-00003720: 2020 6466 203d 2070 642e 636f 6e63 6174    df = pd.concat
-00003730: 2873 656c 662e 7265 6164 5f63 7376 5f61  (self.read_csv_a
-00003740: 735f 6466 7328 6669 6c65 6e61 6d65 2c20  s_dfs(filename, 
-00003750: 6e75 6d5f 6466 733d 3130 2a2a 352c 206d  num_dfs=10**5, m
-00003760: 6178 5f72 6f77 733d 3130 2a2a 372c 2000  ax_rows=10**7, .
-00003770: 2020 2020 6966 2066 696c 655f 7369 7a65      if file_size
-00003780: 5f67 6220 3e20 6d61 785f 6762 3a00 2020  _gb > max_gb:.  
-00003790: 2020 6466 203d 204e 6f6e 6500 2020 2020    df = None.    
-000037a0: 6c6f 672e 6465 6275 6728 6d73 6729 0020  log.debug(msg). 
-000037b0: 2020 206d 7367 203d 2066 2246 696c 6520     msg = f"File 
-000037c0: 5369 7a65 2069 7320 3a20 7b73 7472 2866  Size is : {str(f
-000037d0: 696c 655f 7369 7a65 5f67 6229 7d20 4742  ile_size_gb)} GB
-000037e0: 2200 2020 2020 6c6f 672e 6465 6275 6728  ".    log.debug(
-000037f0: 6627 496d 706f 7274 696e 6720 7b66 696c  f'Importing {fil
-00003800: 656e 616d 657d 2061 7320 6120 6461 7461  ename} as a data
-00003810: 6672 616d 6527 2900 2020 2020 6669 6c65  frame').    file
-00003820: 5f73 697a 655f 6762 203d 2072 6f75 6e64  _size_gb = round
-00003830: 2866 696c 655f 7369 7a65 2f31 302a 2a39  (file_size/10**9
-00003840: 2c20 3229 0020 2020 2066 696c 655f 7369  , 2).    file_si
-00003850: 7a65 203d 206f 732e 7061 7468 2e67 6574  ze = os.path.get
-00003860: 7369 7a65 2866 696c 656e 616d 6529 0020  size(filename). 
-00003870: 2020 2073 7461 7274 203d 2074 696d 652e     start = time.
-00003880: 7065 7266 5f63 6f75 6e74 6572 2829 0020  perf_counter(). 
-00003890: 2064 6566 2063 7376 5f74 6f5f 6466 2873   def csv_to_df(s
-000038a0: 656c 662c 2066 696c 656e 616d 652c 2064  elf, filename, d
-000038b0: 7479 7065 203d 204e 6f6e 652c 2070 6172  type = None, par
-000038c0: 7365 5f64 6174 6573 203d 204e 6f6e 652c  se_dates = None,
-000038d0: 206d 6178 5f67 623d 352c 206e 756d 5f64   max_gb=5, num_d
-000038e0: 6673 3d31 302a 2a33 2c20 7573 6563 6f6c  fs=10**3, usecol
-000038f0: 733d 4e6f 6e65 2c20 696e 6465 785f 636f  s=None, index_co
-00003900: 6c3d 4e6f 6e65 293a 0020 2023 2067 6574  l=None):.  # get
-00003910: 2061 2070 6f74 656e 7469 616c 6c79 206c   a potentially l
-00003920: 6172 6765 2063 7376 2061 6e64 2074 7572  arge csv and tur
-00003930: 6e20 6974 2069 6e74 6f20 6120 4461 7461  n it into a Data
-00003940: 4672 616d 6500 0020 2020 2072 6574 7572  Frame..    retur
-00003950: 6e20 6466 735f 6f70 696e 696f 6e73 0020  n dfs_opinions. 
-00003960: 2020 2020 2020 2063 6f75 6e74 6572 203d         counter =
-00003970: 2063 6f75 6e74 6572 202b 2031 0020 2020   counter + 1.   
-00003980: 2020 2020 2064 6673 5f6f 7069 6e69 6f6e       dfs_opinion
-00003990: 732e 6170 7065 6e64 2864 6629 0020 2020  s.append(df).   
-000039a0: 2020 2020 2020 2020 2062 7265 616b 0020           break. 
-000039b0: 2020 2020 2020 2069 6620 636f 756e 7465         if counte
-000039c0: 7220 3e3d 206e 756d 5f64 6673 3a00 2020  r >= num_dfs:.  
-000039d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000039e0: 2020 2020 2020 2020 7061 7273 655f 6461          parse_da
-000039f0: 7465 733d 7061 7273 655f 6461 7465 732c  tes=parse_dates,
-00003a00: 2075 7365 636f 6c73 3d75 7365 636f 6c73   usecols=usecols
-00003a10: 2c20 696e 6465 785f 636f 6c3d 696e 6465  , index_col=inde
-00003a20: 785f 636f 6c29 3a00 2020 2020 666f 7220  x_col):.    for 
-00003a30: 6466 2069 6e20 7064 2e72 6561 645f 6373  df in pd.read_cs
-00003a40: 7628 6669 6c65 6e61 6d65 2c20 6368 756e  v(filename, chun
-00003a50: 6b73 697a 653d 6d61 785f 726f 7773 2c20  ksize=max_rows, 
-00003a60: 6474 7970 653d 6474 7970 652c 2000 2020  dtype=dtype, .  
-00003a70: 2020 6466 735f 6f70 696e 696f 6e73 203d    dfs_opinions =
-00003a80: 205b 5d00 2020 2020 636f 756e 7465 7220   [].    counter 
-00003a90: 3d20 3000 2020 2020 2020 2020 2020 2020  = 0.            
-00003aa0: 2020 2020 2020 2029 3a00 2020 2020 2020         ):.      
-00003ab0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00003ac0: 6465 785f 636f 6c3d 4e6f 6e65 0020 2020  dex_col=None.   
-00003ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ae0: 2075 7365 636f 6c73 3d4e 6f6e 652c 0020   usecols=None,. 
-00003af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b00: 2020 2070 6172 7365 5f64 6174 6573 3d4e     parse_dates=N
-00003b10: 6f6e 652c 0020 2020 2020 2020 2020 2020  one,.           
-00003b20: 2020 2020 2020 2020 2064 7479 7065 3d4e           dtype=N
-00003b30: 6f6e 652c 2000 2020 2020 2020 2020 2020  one, .          
-00003b40: 2020 2020 2020 2020 2020 6d61 785f 726f            max_ro
-00003b50: 7773 3d31 302a 2a35 2c20 0020 2020 2020  ws=10**5, .     
-00003b60: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00003b70: 756d 5f64 6673 3d31 302c 2000 2020 6465  um_dfs=10, .  de
-00003b80: 6620 7265 6164 5f63 7376 5f61 735f 6466  f read_csv_as_df
-00003b90: 7328 7365 6c66 2c20 6669 6c65 6e61 6d65  s(self, filename
-00003ba0: 2c20 0020 2020 2000 2020 2020 4e6f 4361  , .    .    NoCa
-00003bb0: 7028 6f2c 206f 632c 2063 2c20 642c 2063  p(o, oc, c, d, c
-00003bc0: 6d29 2e73 7461 7274 2829 0020 2064 6566  m).start().  def
-00003bd0: 2063 6c69 286f 2c20 6f63 2c20 632c 2064   cli(o, oc, c, d
-00003be0: 2c20 636d 293a 0020 2040 636c 6963 6b2e  , cm):.  @click.
-00003bf0: 6f70 7469 6f6e 2827 2d63 6d27 2c20 6865  option('-cm', he
-00003c00: 6c70 3d22 6c6f 6361 6c20 7061 7468 2074  lp="local path t
-00003c10: 6f20 6369 7461 7469 6f6e 206d 6170 2066  o citation map f
-00003c20: 696c 6522 2c20 7265 7175 6972 6564 3d54  ile", required=T
-00003c30: 7275 6529 0020 2040 636c 6963 6b2e 6f70  rue).  @click.op
-00003c40: 7469 6f6e 2827 2d64 272c 2068 656c 703d  tion('-d', help=
-00003c50: 226c 6f63 616c 2070 6174 6820 746f 2064  "local path to d
-00003c60: 6f63 6b65 7473 2066 696c 6522 2c20 7265  ockets file", re
-00003c70: 7175 6972 6564 3d54 7275 6529 0020 2040  quired=True).  @
-00003c80: 636c 6963 6b2e 6f70 7469 6f6e 2827 2d63  click.option('-c
-00003c90: 272c 2068 656c 703d 226c 6f63 616c 2070  ', help="local p
-00003ca0: 6174 6820 746f 2063 6f75 7274 7320 6669  ath to courts fi
-00003cb0: 6c65 2022 2c20 7265 7175 6972 6564 3d54  le ", required=T
-00003cc0: 7275 6529 0020 2040 636c 6963 6b2e 6f70  rue).  @click.op
-00003cd0: 7469 6f6e 2827 2d6f 6327 2c20 6865 6c70  tion('-oc', help
-00003ce0: 3d22 6c6f 6361 6c20 7061 7468 2074 6f20  ="local path to 
-00003cf0: 6f70 696e 696f 6e20 636c 7573 7465 7273  opinion clusters
-00003d00: 2066 696c 6522 2c20 7265 7175 6972 6564   file", required
-00003d10: 3d54 7275 6529 0020 2040 636c 6963 6b2e  =True).  @click.
-00003d20: 6f70 7469 6f6e 2827 2d6f 272c 2068 656c  option('-o', hel
-00003d30: 703d 226c 6f63 616c 2070 6174 6820 746f  p="local path to
-00003d40: 206f 7069 6e69 6f6e 7320 6669 6c65 222c   opinions file",
-00003d50: 2072 6571 7569 7265 643d 5472 7565 2900   required=True).
-00003d60: 2020 4063 6c69 636b 2e63 6f6d 6d61 6e64    @click.command
-00003d70: 2829 2020 0000 2020 2020 7365 6c66 2e44  ()  ..    self.D
-00003d80: 6174 6146 7261 6d65 203d 2070 642e 636f  ataFrame = pd.co
-00003d90: 7265 2e66 7261 6d65 2e44 6174 6146 7261  re.frame.DataFra
-00003da0: 6d65 0020 2020 2023 7365 6c66 2e5f 6466  me.    #self._df
-00003db0: 5f6f 7069 6e69 6f6e 7320 3d20 7365 6c66  _opinions = self
-00003dc0: 2e69 6e69 745f 6f70 696e 696f 6e73 5f64  .init_opinions_d
-00003dd0: 6628 2900 0020 2020 2073 656c 662e 5f64  f()..    self._d
-00003de0: 665f 646f 636b 6574 7320 3d20 7365 6c66  f_dockets = self
-00003df0: 2e69 6e69 745f 646f 636b 6574 735f 6469  .init_dockets_di
-00003e00: 6374 2829 2023 2073 656c 662e 696e 6974  ct() # self.init
-00003e10: 5f64 6f63 6b65 7473 5f64 6628 2900 2020  _dockets_df().  
-00003e20: 2020 7365 6c66 2e5f 6466 5f63 6974 6174    self._df_citat
-00003e30: 696f 6e20 3d20 7365 6c66 2e69 6e69 745f  ion = self.init_
-00003e40: 6369 7461 7469 6f6e 5f64 6628 2900 2020  citation_df().  
-00003e50: 2020 7365 6c66 2e5f 6466 5f6f 7069 6e69    self._df_opini
-00003e60: 6f6e 5f63 6c75 7374 6572 7320 3d20 7365  on_clusters = se
-00003e70: 6c66 2e69 6e69 745f 6f70 696e 696f 6e5f  lf.init_opinion_
-00003e80: 636c 7573 7465 7273 5f64 6628 2900 2020  clusters_df().  
-00003e90: 2020 7365 6c66 2e5f 6466 5f63 6f75 7274    self._df_court
-00003ea0: 7320 3d20 7365 6c66 2e69 6e69 745f 636f  s = self.init_co
-00003eb0: 7572 7473 5f64 6628 2900 0020 2020 2073  urts_df()..    s
-00003ec0: 656c 662e 5f63 6974 6174 696f 6e5f 666e  elf._citation_fn
-00003ed0: 203d 2063 6974 6174 696f 6e5f 666e 0020   = citation_fn. 
-00003ee0: 2020 2073 656c 662e 5f64 6f63 6b65 7473     self._dockets
-00003ef0: 5f66 6e20 3d20 646f 636b 6574 735f 666e  _fn = dockets_fn
-00003f00: 0020 2020 2073 656c 662e 5f63 6f75 7274  .    self._court
-00003f10: 735f 666e 203d 2063 6f75 7274 735f 666e  s_fn = courts_fn
-00003f20: 0020 2020 2073 656c 662e 5f6f 7069 6e69  .    self._opini
-00003f30: 6f6e 5f63 6c75 7374 6572 735f 666e 203d  on_clusters_fn =
-00003f40: 206f 7069 6e69 6f6e 5f63 6c75 7374 6572   opinion_cluster
-00003f50: 735f 666e 0020 2020 2073 656c 662e 5f6f  s_fn.    self._o
-00003f60: 7069 6e69 6f6e 735f 666e 203d 206f 7069  pinions_fn = opi
-00003f70: 6e69 6f6e 735f 666e 0020 2020 206c 6f67  nions_fn.    log
-00003f80: 2e64 6562 7567 2827 496e 6974 6961 6c69  .debug('Initiali
-00003f90: 7a69 6e67 2729 0020 2064 6566 205f 5f69  zing').  def __i
-00003fa0: 6e69 745f 5f28 7365 6c66 2c20 6f70 696e  nit__(self, opin
-00003fb0: 696f 6e73 5f66 6e2c 206f 7069 6e69 6f6e  ions_fn, opinion
-00003fc0: 5f63 6c75 7374 6572 735f 666e 2c20 636f  _clusters_fn, co
-00003fd0: 7572 7473 5f66 6e2c 2064 6f63 6b65 7473  urts_fn, dockets
-00003fe0: 5f66 6e2c 2063 6974 6174 696f 6e5f 666e  _fn, citation_fn
-00003ff0: 293a 0063 6c61 7373 204e 6f43 6170 3a00  ):.class NoCap:.
-00004000: 6164 0000 6d09 0000 390a 0000 0010 0000  ad..m...9.......
-00004010: 2c00 0000 0000 0000 950f 0000 2a0f 0000  ,...........*...
-00004020: 1d0f 0000 000f 0000 e40e 0000 de0e 0000  ................
-00004030: dd0e 0000 c40e 0000 9f0e 0000 6f0e 0000  ............o...
-00004040: 600e 0000 440e 0000 250e 0000 1f0e 0000  `...D...%.......
-00004050: cf0d 0000 ce0d 0000 b30d 0000 8c0d 0000  ................
-00004060: 730d 0000 510d 0000 320d 0000 130d 0000  s...Q...2.......
-00004070: fa0c 0000 da0c 0000 b80c 0000 950c 0000  ................
-00004080: 6d0c 0000 4f0c 0000 460c 0000 450c 0000  m...O...F...E...
-00004090: ea0b 0000 e90b 0000 c60b 0000 970b 0000  ................
-000040a0: 4a0b 0000 390b 0000 1e0b 0000 000b 0000  J...9...........
-000040b0: de0a 0000 d60a 0000 7a0a 0000 790a 0000  ........z...y...
-000040c0: 5f0a 0000 390a 0000 380a 0000 100a 0000  _...9...8.......
-000040d0: fa09 0000 dc09 0000 b309 0000 9809 0000  ................
-000040e0: 4509 0000 2d09 0000 2c09 0000 2209 0000  E...-...,..."...
-000040f0: fb08 0000 c608 0000 c508 0000 b808 0000  ................
-00004100: 9d08 0000 8008 0000 7f08 0000 6208 0000  ............b...
-00004110: 4308 0000 4008 0000 2408 0000 0608 0000  C...@...$.......
-00004120: 0508 0000 e007 0000 b907 0000 b807 0000  ................
-00004130: 9b07 0000 9007 0000 8907 0000 7d07 0000  ............}...
-00004140: 5307 0000 3907 0000 2007 0000 fb06 0000  S...9... .......
-00004150: d806 0000 b006 0000 9006 0000 6806 0000  ............h...
-00004160: 6706 0000 1306 0000 a905 0000 a805 0000  g...............
-00004170: 6105 0000 3205 0000 f204 0000 f104 0000  a...2...........
-00004180: d204 0000 ac04 0000 9b04 0000 7004 0000  ............p...
-00004190: 3304 0000 1a04 0000 0a04 0000 0904 0000  3...............
-000041a0: ed03 0000 ad03 0000 8303 0000 5903 0000  ............Y...
-000041b0: 5803 0000 4c03 0000 2b03 0000 1803 0000  X...L...+.......
-000041c0: 0903 0000 f302 0000 a902 0000 7d02 0000  ............}...
-000041d0: 7602 0000 6c02 0000 2802 0000 ea01 0000  v...l...(.......
-000041e0: e901 0000 0000 0000 0000 2020 2020 2364  ..........    #d
-000041f0: 6174 655f 7465 726d 696e 6174 6564 203d  ate_terminated =
-00004200: 206c 6973 7428 646f 636b 6574 5f72 6f77   list(docket_row
-00004210: 5b27 6461 7465 5f74 6572 6d69 6e61 7465  ['date_terminate
-00004220: 6427 5d29 5b30 5d00 2020 2020 2323 2073  d'])[0].    ## s
-00004230: 6f6d 6574 696d 6573 2064 6174 655f 7465  ometimes date_te
-00004240: 726d 696e 6174 6564 206d 6179 2062 6520  rminated may be 
-00004250: 6d69 7373 696e 6720 616e 6420 7265 636f  missing and reco
-00004260: 7264 6564 2061 7320 4e61 4e00 2020 2020  rded as NaN.    
-00004270: 2320 2020 2000 2020 2020 235d 0020 2020  #    .    #].   
-00004280: 2023 2020 2020 6966 206e 6f74 2072 652e   #    if not re.
-00004290: 6d61 7463 6828 275b 636a 5d3f 6a5c 2e27  match('[cj]?j\.'
-000042a0: 2c20 6a75 6467 6529 0020 2020 2023 2020  , judge).    #  
-000042b0: 2020 2020 2020 286a 7564 6765 732e 696c        (judges.il
-000042c0: 6f63 5b30 5d2e 7370 6c69 7428 272c 2729  oc[0].split(',')
-000042d0: 2069 6620 6a75 6467 6573 2e6e 6f74 6e61   if judges.notna
-000042e0: 2829 2e62 6f6f 6c28 2920 656c 7365 205b  ().bool() else [
-000042f0: 5d29 0020 2020 2023 2020 2020 666f 7220  ]).    #    for 
-00004300: 6a75 6467 6520 696e 0020 2020 2023 2020  judge in.    #  
-00004310: 2020 6a75 6467 6500 2020 2020 236a 7564    judge.    #jud
-00004320: 655f 6c69 7374 203d 205b 0020 2020 2023  e_list = [.    #
-00004330: 6a75 6467 6573 203d 2063 6c75 7374 6572  judges = cluster
-00004340: 5f72 6f77 2e6a 7564 6765 7300 2020 2020  _row.judges.    
-00004350: 236a 7564 6765 7300 0020 2020 2023 6369  #judges..    #ci
-00004360: 7465 645f 6279 203d 2063 6974 6174 696f  ted_by = citatio
-00004370: 6e5f 696e 666f 5b27 6369 7465 645f 6279  n_info['cited_by
-00004380: 275d 0020 2020 2023 6369 7465 735f 746f  '].    #cites_to
-00004390: 203d 2063 6974 6174 696f 6e5f 696e 666f   = citation_info
-000043a0: 5b27 6369 7465 735f 746f 275d 0020 2020  ['cites_to'].   
-000043b0: 2023 2063 6974 6174 696f 6e5f 696e 666f   # citation_info
-000043c0: 203d 2073 656c 662e 6765 745f 6369 7461   = self.get_cita
-000043d0: 7469 6f6e 7328 6f70 696e 696f 6e5f 6964  tions(opinion_id
-000043e0: 2c20 6369 7461 7469 6f6e 7329 0020 2020  , citations).   
-000043f0: 2023 2067 6574 206f 7069 6e69 6f6e 7320   # get opinions 
-00004400: 6369 7465 6420 746f 0000 2020 2020 2320  cited to..    # 
-00004410: 2020 2072 6574 7572 6e00 2020 2020 2369     return.    #i
-00004420: 6620 636f 7572 745f 726f 772e 656d 7074  f court_row.empt
-00004430: 793a 0020 2020 2023 636f 7572 745f 726f  y:.    #court_ro
-00004440: 773a 2073 656c 662e 4461 7461 4672 616d  w: self.DataFram
-00004450: 6520 3d20 636f 7572 7473 5b63 6f75 7274  e = courts[court
-00004460: 735b 2769 6427 5d20 3d3d 2063 6964 5d00  s['id'] == cid].
-00004470: 2020 2020 2363 6964 203d 206c 6973 7428      #cid = list(
-00004480: 646f 636b 6574 5f72 6f77 5b27 636f 7572  docket_row['cour
-00004490: 745f 6964 275d 295b 305d 0020 2020 2023  t_id'])[0].    #
-000044a0: 2020 2020 7265 7475 726e 2000 2020 2020      return .    
-000044b0: 2369 6620 6c65 6e28 646f 636b 6574 5f72  #if len(docket_r
-000044c0: 6f77 2e63 6f6c 756d 6e73 2920 3d3d 2030  ow.columns) == 0
-000044d0: 3a00 2020 2020 2320 7265 7475 726e 2065  :.    # return e
-000044e0: 6172 6c79 2069 6620 7468 6572 6527 7320  arly if there's 
-000044f0: 0000 2020 2020 2364 6f63 6b65 745f 726f  ..    #docket_ro
-00004500: 7720 3d20 646f 636b 6574 735b 646f 636b  w = dockets[dock
-00004510: 6574 735b 2769 6427 5d20 3d3d 2064 6f63  ets['id'] == doc
-00004520: 6b65 745f 6964 5d2e 636f 6d70 7574 6528  ket_id].compute(
-00004530: 2900 2020 2020 2364 6f63 6b65 745f 6964  ).    #docket_id
-00004540: 203d 2069 6e74 2863 6c75 7374 6572 5f72   = int(cluster_r
-00004550: 6f77 5b27 646f 636b 6574 5f69 6427 5d29  ow['docket_id'])
-00004560: 0020 2020 2023 2067 6574 2063 6f72 7265  .    # get corre
-00004570: 7370 6f6e 6469 6e67 2072 6f77 2066 726f  sponding row fro
-00004580: 6d20 646f 636b 6574 2064 6620 6261 7365  m docket df base
-00004590: 6420 6f6e 2063 6c75 7374 6572 206f 7069  d on cluster opi
-000045a0: 6e69 6f6e 2069 6400 0020 2020 2023 636c  nion id..    #cl
-000045b0: 7573 7465 725f 726f 773a 2073 656c 662e  uster_row: self.
-000045c0: 4461 7461 4672 616d 6520 3d20 7365 6c66  DataFrame = self
-000045d0: 2e64 665f 726f 775f 6279 5f76 616c 7565  .df_row_by_value
-000045e0: 2873 656c 662e 6765 745f 6f70 696e 696f  (self.get_opinio
-000045f0: 6e73 5f63 6c75 7374 6572 5f64 6628 292c  ns_cluster_df(),
-00004600: 2027 6964 272c 2063 6c75 7374 6572 5f69   'id', cluster_i
-00004610: 6429 0020 2020 2023 2067 6574 2065 6163  d).    # get eac
-00004620: 6820 636f 7272 6573 706f 6e64 696e 6720  h corresponding 
-00004630: 726f 7720 6672 6f6d 2063 6c75 7374 6572  row from cluster
-00004640: 732c 2064 6f63 6b65 7473 2c20 636f 7572  s, dockets, cour
-00004650: 7473 2062 6173 6564 206f 6e20 6f70 696e  ts based on opin
-00004660: 696f 6e20 6964 0000 2020 2020 2363 6c75  ion id..    #clu
-00004670: 7374 6572 5f69 6420 3d20 6f70 696e 696f  ster_id = opinio
-00004680: 6e5b 2763 6c75 7374 6572 5f69 6427 5d00  n['cluster_id'].
-00004690: 2020 2020 236f 7069 6e69 6f6e 5f69 6420      #opinion_id 
-000046a0: 3d20 6f70 696e 696f 6e5b 2769 6427 5d00  = opinion['id'].
-000046b0: 2020 2020 2363 6974 6174 696f 6e73 203d      #citations =
-000046c0: 2073 656c 662e 6765 745f 6369 7461 7469   self.get_citati
-000046d0: 6f6e 5f64 6628 2900 2020 2020 2363 6f75  on_df().    #cou
-000046e0: 7274 7320 3d20 7365 6c66 2e67 6574 5f63  rts = self.get_c
-000046f0: 6f75 7274 735f 6466 2829 0020 2020 2023  ourts_df().    #
-00004700: 646f 636b 6574 7320 3d20 7365 6c66 2e67  dockets = self.g
-00004710: 6574 5f64 6f63 6b65 7473 5f64 6628 2900  et_dockets_df().
-00004720: 2020 2020 7265 7475 726e 206f 7069 6e69      return opini
-00004730: 6f6e 5b27 6964 275d 0020 2020 2023 7072  on['id'].    #pr
-00004740: 696e 7428 6f70 696e 696f 6e5b 2769 6427  int(opinion['id'
-00004750: 5d29 0020 2064 6566 2070 726f 6365 7373  ]).  def process
-00004760: 5f72 6f77 2873 656c 662c 206f 7069 6e69  _row(self, opini
-00004770: 6f6e 2920 2d3e 2064 6963 743a 0020 2023  on) -> dict:.  #
-00004780: 2070 726f 6365 7373 0020 2020 2020 2000   process.      .
-00004790: 2020 2020 2020 7061 7373 0020 2064 6566        pass.  def
-000047a0: 2067 6574 5f6f 7069 6e69 6f6e 735f 6466   get_opinions_df
-000047b0: 2873 656c 6629 3a00 0020 2020 2020 2072  (self):..      r
-000047c0: 6574 7572 6e20 7365 6c66 2e5f 6466 5f6f  eturn self._df_o
-000047d0: 7069 6e69 6f6e 5f63 6c75 7374 6572 7300  pinion_clusters.
-000047e0: 2020 6465 6620 6765 745f 6f70 696e 696f    def get_opinio
-000047f0: 6e73 5f63 6c75 7374 6572 5f64 6628 7365  ns_cluster_df(se
-00004800: 6c66 293a 0000 2020 2020 2020 7265 7475  lf):..      retu
-00004810: 726e 2073 656c 662e 5f64 665f 646f 636b  rn self._df_dock
-00004820: 6574 7300 2020 6465 6620 6765 745f 646f  ets.  def get_do
-00004830: 636b 6574 735f 6466 2873 656c 6629 3a00  ckets_df(self):.
-00004840: 2020 0020 2020 2020 2072 6574 7572 6e20    .      return 
-00004850: 7365 6c66 2e5f 6466 5f63 6974 6174 696f  self._df_citatio
-00004860: 6e00 2020 6465 6620 6765 745f 6369 7461  n.  def get_cita
-00004870: 7469 6f6e 5f64 6628 7365 6c66 293a 0000  tion_df(self):..
-00004880: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00004890: 662e 5f64 665f 636f 7572 7473 0020 2064  f._df_courts.  d
-000048a0: 6566 2067 6574 5f63 6f75 7274 735f 6466  ef get_courts_df
-000048b0: 2873 656c 6629 3a00 2020 2323 2047 6574  (self):.  ## Get
-000048c0: 7465 7273 0000 2020 2020 2020 7265 7475  ters..      retu
-000048d0: 726e 2073 656c 662e 6373 765f 746f 5f64  rn self.csv_to_d
-000048e0: 6628 666e 206f 7220 2020 6465 6620 696e  f(fn or   def in
-000048f0: 6974 5f64 6f63 6b65 7473 5f64 2020 6465  it_dockets_d  de
-00004900: 6620 2064 6566 2069 6e69 7420 2020 6465  f  def init   de
-00004910: 2020 2064 6566 2069 6e69 745f 646f 636b     def init_dock
-00004920: 6574 735f 6466 2873 656c 662c 2020 2064  ets_df(self,   d
-00004930: 6566 2069 6e69 745f 646f 636b 6574 735f  ef init_dockets_
-00004940: 6466 2873 6520 2064 6566 2069 6e69 745f  df(se  def init_
-00004950: 646f 636b 6574 735f 6466 2873 656c 662c  dockets_df(self,
-00004960: 2066 6e3d 4e6f 6e65 293a 0020 2023 2069   fn=None):.  # i
-00004970: 6e69 7469 616c 697a 6520 646f 636b 6574  nitialize docket
-00004980: 7320 6466 0000 2020 2020 2020 2020 2020  s df..          
-00004990: 2020 646f 636b 6574 2020 6465 6620 696e    docket  def in
-000049a0: 6974 5f64 6f63 6b65 7473 5f64 6628 7365  it_dockets_df(se
-000049b0: 6c66 2c20 2064 6566 2069 6e69 745f 646f  lf,  def init_do
-000049c0: 636b 6574 735f 6466 2873 656c 662c 2066  ckets_df(self, f
-000049d0: 6e3d 4e6f 6e65 293a 0020 2023 2020 6465  n=None):.  #  de
-000049e0: 6620 696e 6974 5f64 6f63 6b65 7473 5f64  f init_dockets_d
-000049f0: 6628 7365 6c66 2c20 666e 2020 6465 6620  f(self, fn  def 
-00004a00: 696e 6974 5f64 6f63 6b65 7473 5f64 6628  init_dockets_df(
-00004a10: 2020 6465 6620 696e 6974 5f64 6f63 6b65    def init_docke
-00004a20: 7473 5f64 6628 7365 6c66 2c20 666e 3d4e  ts_df(self, fn=N
-00004a30: 6f6e 6529 3a00 2020 2020 2064 6566 2069  one):.     def i
-00004a40: 6e69 745f 646f 636b 6574 735f 6466 2873  nit_dockets_df(s
-00004a50: 656c 662c 2066 6e3d 4e6f 6e65 293a 0020  elf, fn=None):. 
-00004a60: 2023 2069 6e69 7469 616c 697a 6520 646f   # initialize do
-00004a70: 636b 6574 7320 6466 0000 2020 2020 2020  ckets df..      
-00004a80: 7265 7475 726e 2073 656c 662e 6373 765f  return self.csv_
-00004a90: 746f 5f64 6628 666e 206f 7220 7365 6c66  to_df(fn or self
-00004aa0: 2e5f 6f70 696e 696f 6e5f 636c 7573 7465  ._opinion_cluste
-00004ab0: 7273 5f66 6e2c 2064 7479 7065 3d64 7479  rs_fn, dtype=dty
-00004ac0: 7065 732c 2075 7365 636f 6c73 3d75 7365  pes, usecols=use
-00004ad0: 636f 6c73 2900 2020 2020 2020 7d00 2020  cols).      }.  
-00004ae0: 2020 2020 2020 2763 6173 655f 6e61 6d65        'case_name
-00004af0: 5f66 756c 6c27 3a27 7374 7269 6e67 2700  _full':'string'.
-00004b00: 2020 2020 2020 2020 2763 6173 655f 6e61          'case_na
-00004b10: 6d65 273a 2773 7472 696e 6727 2c00 2020  me':'string',.  
-00004b20: 2020 2020 2020 276a 7564 6765 7327 3a27        'judges':'
-00004b30: 7374 7269 6e67 272c 0020 2020 2020 2064  string',.      d
-00004b40: 7479 7065 7320 3d20 7b00 2020 2020 2020  types = {.      
-00004b50: 7573 6563 6f6c 7320 3d20 5b27 6964 272c  usecols = ['id',
-00004b60: 2027 6a75 6467 6573 272c 2027 646f 636b   'judges', 'dock
-00004b70: 6574 5f69 6427 2c20 2763 6173 655f 6e61  et_id', 'case_na
-00004b80: 6d65 272c 2027 6361 7365 5f6e 616d 655f  me', 'case_name_
-00004b90: 6675 6c6c 275d 0020 2064 6566 2069 6e69  full'].  def ini
-00004ba0: 745f 6f70 696e 696f 6e5f 636c 7573 7465  t_opinion_cluste
-00004bb0: 7273 5f64 6628 7365 6c66 2c20 666e 3d4e  rs_df(self, fn=N
-00004bc0: 6f6e 6529 3a00 2020 2320 696e 6974 6961  one):.  # initia
-00004bd0: 6c69 7a65 206f 7069 6e69 6f6e 2063 6c75  lize opinion clu
-00004be0: 7374 6572 7320 6466 0000 2020 2020 2020  sters df..      
-00004bf0: 7265 7475 726e 2073 656c 662e 6373 765f  return self.csv_
-00004c00: 746f 5f64 6628 666e 206f 7220 7365 6c66  to_df(fn or self
-00004c10: 2e5f 6f70 696e 696f 6e73 5f66 6e2c 2064  ._opinions_fn, d
-00004c20: 7479 7065 3d6f 7069 6e69 6f6e 5f64 7479  type=opinion_dty
-00004c30: 7065 732c 2069 6e64 6578 5f63 6f6c 3d27  pes, index_col='
-00004c40: 6964 2729 0000 2020 2020 2020 7d20 0020  id')..      } . 
-00004c50: 2020 2020 2020 2027 6c6f 6361 6c5f 7061         'local_pa
-00004c60: 7468 273a 2773 7472 696e 6727 0020 2020  th':'string'.   
-00004c70: 2020 2020 2027 6874 6d6c 5f77 6974 685f       'html_with_
-00004c80: 6369 7461 7469 6f6e 7327 3a27 7374 7269  citations':'stri
-00004c90: 6e67 272c 0020 2020 2020 2020 2027 6874  ng',.        'ht
-00004ca0: 6d6c 5f61 6e6f 6e5f 3230 3230 273a 2773  ml_anon_2020':'s
-00004cb0: 7472 696e 6727 2c00 2020 2020 2020 2020  tring',.        
-00004cc0: 2768 746d 6c5f 636f 6c75 6d62 6961 273a  'html_columbia':
-00004cd0: 2773 7472 696e 6727 2c00 2020 2020 2020  'string',.      
-00004ce0: 2020 2768 746d 6c5f 6c61 7762 6f78 273a    'html_lawbox':
-00004cf0: 2773 7472 696e 6727 2c00 2020 2020 2020  'string',.      
-00004d00: 2020 2768 746d 6c27 3a27 7374 7269 6e67    'html':'string
-00004d10: 272c 0020 2020 2020 2020 2027 706c 6169  ',.        'plai
-00004d20: 6e5f 7465 7874 273a 2773 7472 696e 6727  n_text':'string'
-00004d30: 2c00 2020 2020 2020 2020 276c 6f63 616c  ,.        'local
-00004d40: 5f70 6174 6827 3a27 7374 7269 6e67 272c  _path':'string',
-00004d50: 0020 2020 2020 2020 2027 646f 776e 6c6f  .        'downlo
-00004d60: 6164 5f75 726c 273a 2027 7374 7269 6e67  ad_url': 'string
-00004d70: 272c 0020 2020 2020 206f 7069 6e69 6f6e  ',.      opinion
-00004d80: 5f64 7479 7065 7320 3d20 7b00 2020 6465  _dtypes = {.  de
-00004d90: 6620 696e 6974 5f6f 7069 6e69 6f6e 735f  f init_opinions_
-00004da0: 6466 2873 656c 662c 2066 6e3d 4e6f 6e65  df(self, fn=None
-00004db0: 293a 0020 2023 2069 6e69 7469 616c 697a  ):.  # initializ
-00004dc0: 6520 6f70 696e 696f 6e73 2064 6600 0020  e opinions df.. 
-00004dd0: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
-00004de0: 7376 5f74 6f5f 6466 2866 6e20 6f72 2073  sv_to_df(fn or s
-00004df0: 656c 662e 5f63 6f75 7274 735f 666e 2c20  elf._courts_fn, 
-00004e00: 6474 7970 653d 6474 7970 6573 2c20 7573  dtype=dtypes, us
-00004e10: 6563 6f6c 733d 7573 6563 6f6c 7329 0020  ecols=usecols). 
-00004e20: 2020 207d 0020 2020 2020 2027 6a75 7269     }.      'juri
-00004e30: 7364 6963 7469 6f6e 273a 2027 7374 7269  sdiction': 'stri
-00004e40: 6e67 2700 2020 2020 2020 2766 756c 6c6e  ng'.      'fulln
-00004e50: 616d 6527 3a20 2773 7472 696e 6727 2c00  ame': 'string',.
-00004e60: 2020 2020 6474 7970 6573 203d 207b 0020      dtypes = {. 
-00004e70: 2020 2075 7365 636f 6c73 203d 205b 2769     usecols = ['i
-00004e80: 6427 2c27 6675 6c6c 5f6e 616d 6527 2c27  d','full_name','
-00004e90: 6a75 7269 7364 6963 7469 6f6e 275d 0020  jurisdiction']. 
-00004ea0: 2064 6566 2069 6e69 745f 636f 7572 7473   def init_courts
-00004eb0: 5f64 6628 7365 6c66 2c20 666e 3d4e 6f6e  _df(self, fn=Non
-00004ec0: 6529 3a00 2020 2320 696e 6974 6961 6c69  e):.  # initiali
-00004ed0: 7a65 2063 6f75 7274 7320 6466 0000 2020  ze courts df..  
-00004ee0: 2020 7d00 2020 2020 2020 2020 2763 6974    }.        'cit
-00004ef0: 6564 5f62 7927 3a63 6974 6564 5f62 7900  ed_by':cited_by.
-00004f00: 2020 2020 2020 2020 2763 6974 6573 5f74          'cites_t
-00004f10: 6f27 3a63 6974 6573 5f74 6f2c 0020 2020  o':cites_to,.   
-00004f20: 2072 6574 7572 6e20 7b00 2020 2020 6369   return {.    ci
-00004f30: 7465 645f 6279 203d 2064 665f 6369 7461  ted_by = df_cita
-00004f40: 7469 6f6e 735b 6466 5f63 6974 6174 696f  tions[df_citatio
-00004f50: 6e73 5b27 6369 7465 645f 6f70 696e 696f  ns['cited_opinio
-00004f60: 6e5f 6964 275d 203d 3d20 6f70 696e 696f  n_id'] == opinio
-00004f70: 6e5f 6964 5d5b 2763 6974 696e 675f 6f70  n_id]['citing_op
-00004f80: 696e 696f 6e5f 6964 275d 2e74 6f5f 6c69  inion_id'].to_li
-00004f90: 7374 2829 0020 2020 2063 6974 6573 5f74  st().    cites_t
-00004fa0: 6f20 3d20 6466 5f63 6974 6174 696f 6e73  o = df_citations
-00004fb0: 5b64 665f 6369 7461 7469 6f6e 735b 2763  [df_citations['c
-00004fc0: 6974 696e 675f 6f70 696e 696f 6e5f 6964  iting_opinion_id
-00004fd0: 275d 203d 3d20 6f70 696e 696f 6e5f 6964  '] == opinion_id
-00004fe0: 5d5b 2763 6974 6564 5f6f 7069 6e69 6f6e  ]['cited_opinion
-00004ff0: 5f69 6427 5d2e 746f 5f6c 6973 7428 2900  _id'].to_list().
-00005000: 6164 0000 3008 0000 2c09 0000 0010 0000  ad..0...,.......
-00005010: 3800 0000 0000 0000 ff0f 0000 e30f 0000  8...............
-00005020: bb0f 0000 800f 0000 5c0f 0000 570f 0000  ........\...W...
-00005030: 0e0f 0000 dd0e 0000 960e 0000 830e 0000  ................
-00005040: 7e0e 0000 6c0e 0000 5a0e 0000 570e 0000  ~...l...Z...W...
-00005050: 440e 0000 240e 0000 100e 0000 f90d 0000  D...$...........
-00005060: d70d 0000 b80d 0000 990d 0000 800d 0000  ................
-00005070: 600d 0000 3e0d 0000 1b0d 0000 f30c 0000  `...>...........
-00005080: d50c 0000 cf0c 0000 bf0c 0000 ae0c 0000  ................
-00005090: 920c 0000 790c 0000 600c 0000 460c 0000  ....y...`...F...
-000050a0: 2d0c 0000 1a0c 0000 000c 0000 e40b 0000  -...............
-000050b0: c70b 0000 a40b 0000 980b 0000 650b 0000  ............e...
-000050c0: 380b 0000 f90a 0000 c60a 0000 b30a 0000  8...............
-000050d0: 610a 0000 e609 0000 b309 0000 ac09 0000  a...............
-000050e0: 9209 0000 7409 0000 5609 0000 5509 0000  ....t...V...U...
-000050f0: 3a09 0000 2c09 0000 2b09 0000 e208 0000  :...,...+.......
-00005100: af08 0000 b708 0000 ac08 0000 9d08 0000  ................
-00005110: 7108 0000 3708 0000 1b08 0000 e307 0000  q...7...........
-00005120: c007 0000 9f07 0000 5b07 0000 2107 0000  ........[...!...
-00005130: 0107 0000 e006 0000 a606 0000 7b06 0000  ............{...
-00005140: 4506 0000 0806 0000 df05 0000 c405 0000  E...............
-00005150: b805 0000 c805 0000 b305 0000 0000 0000  ................
-00005160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000051a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000051b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000051c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000051d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000051e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000051f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000052a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000052b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000052c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000052d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000052e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000052f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000053a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000053b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000053c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000053d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000053e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000053f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055b0: 0000 0020 204e 6f20 2020 4e6f 4361 702e  ...  No   NoCap.
-000055c0: 636c 6928 2020 4e6f 4361 702e 636c 6928  cli(  NoCap.cli(
-000055d0: 2900 6966 205f 5f6e 616d 655f 5f20 3d20  ).if __name__ = 
-000055e0: 204e 6f43 6170 2e63 6c69 2829 0069 6620   NoCap.cli().if 
-000055f0: 5f5f 6e61 6d65 5f5f 203d 3d20 275f 5f6d  __name__ == '__m
-00005600: 6169 6e5f 5f27 3a00 2020 4e6f 4361 702e  ain__':.  NoCap.
-00005610: 636c 6928 2900 6966 205f 5f6e 616d 655f  cli().if __name_
-00005620: 5f20 3d3d 2027 5f5f 6d61 696e 5f5f 273a  _ == '__main__':
-00005630: 0000 2020 2020 6c6f 672e 6465 6275 6728  ..    log.debug(
-00005640: 2865 6e64 2d20 204e 6f43 6170 2e63 6c69  (end-  NoCap.cli
-00005650: 2829 0069 6620 5f5f 6e61 6d65 5f5f 203d  ().if __name__ =
-00005660: 3d20 275f 5f6d 6169 6e5f 5f27 3a00 0020  = '__main__':.. 
-00005670: 2020 206c 6f67 2e64 6562 7520 204e 6f43     log.debu  NoC
-00005680: 6170 2e63 6c69 2829 0069 6620 5f5f 6e61  ap.cli().if __na
-00005690: 6d65 5f5f 203d 3d20 275f 5f6d 6169 6e5f  me__ == '__main_
-000056a0: 5f27 3a00 0020 2020 4e6f 4361 702e 636c  _':..   NoCap.cl
-000056b0: 6928 2900 6966 205f 5f6e 616d 655f 5f20  i().if __name__ 
-000056c0: 3d3d 2027 5f5f 6d61 696e 5f5f 273a 0000  == '__main__':..
-000056d0: 2020 2020 6c6f 672e 6465 6275 6728 2865      log.debug((e
-000056e0: 2020 4e6f 4361 702e 636c 6928 2900 6966    NoCap.cli().if
-000056f0: 205f 5f6e 616d 655f 5f20 3d3d 2027 5f5f   __name__ == '__
-00005700: 6d20 204e 6f43 6170 2e63 6c69 2829 0069  m  NoCap.cli().i
-00005710: 6620 5f5f 6e61 6d65 5f5f 203d 3d20 275f  f __name__ == '_
-00005720: 5f20 204e 6f43 6170 2e63 6c69 2829 0069  _  NoCap.cli().i
-00005730: 6620 5f5f 6e61 6d65 5f5f 203d 3d20 275f  f __name__ == '_
-00005740: 5f6d 6169 6e5f 5f27 3a00 0020 2020 206c  _main__':..    l
-00005750: 6f67 2e64 6562 7567 2828 6520 204e 6f43  og.debug((e  NoC
-00005760: 6170 2e63 6c69 2829 0069 6620 5f5f 6e61  ap.cli().if __na
-00005770: 6d65 5f5f 203d 3d20 275f 5f6d 6169 6e5f  me__ == '__main_
-00005780: 5f27 3a00 0020 2020 206c 6f67 2e64 6562  _':..    log.deb
-00005790: 7567 2828 656e 642d 7374 6172 7429 2f20  ug((end-start)/ 
-000057a0: 204e 6f43 6170 2e63 6c69 2829 0069 6620   NoCap.cli().if 
-000057b0: 5f5f 6e61 6d65 5f5f 203d 3d20 275f 5f6d  __name__ == '__m
-000057c0: 2020 4e6f 4361 702e 636c 6928 2900 6966    NoCap.cli().if
-000057d0: 205f 5f6e 616d 655f 5f20 3d3d 2027 5f5f   __name__ == '__
-000057e0: 6d61 6920 204e 6f43 6170 2e63 6c69 2829  mai  NoCap.cli()
-000057f0: 0069 6620 5f5f 6e61 6d65 5f5f 203d 3d20  .if __name__ == 
-00005800: 275f 5f6d 6169 6e5f 5f27 3a00 0020 2020  '__main__':..   
-00005810: 206c 6f67 2e64 6562 7567 2820 204e 6f43   log.debug(  NoC
-00005820: 6170 2e63 6c69 2829 0069 6620 5f5f 6e61  ap.cli().if __na
-00005830: 6d65 5f5f 203d 3d20 204e 6f43 6170 2e63  me__ ==  NoCap.c
-00005840: 6c69 2829 0069 6620 5f5f 6e61 6d65 5f5f  li().if __name__
-00005850: 203d 3d20 275f 5f6d 6169 6e5f 5f27 3a00   == '__main__':.
-00005860: 0020 2020 206c 6f67 2e64 6562 7567 2828  .    log.debug((
-00005870: 6520 204e 6f43 6170 2e63 6c69 2829 0069  e  NoCap.cli().i
-00005880: 6620 5f5f 6e61 6d65 5f5f 203d 3d20 275f  f __name__ == '_
-00005890: 5f6d 6169 6e5f 5f27 3a00 0020 2020 204e  _main__':..    N
-000058a0: 6f43 6170 2e63 6c69 2829 0069 2020 4e20  oCap.cli().i  N 
-000058b0: 204e 6f43 6170 2e63 6c69 2829 0069 6620   NoCap.cli().if 
-000058c0: 5f5f 6e61 6d65 5f5f 203d 3d20 275f 5f20  __name__ == '__ 
-000058d0: 204e 6f43 6170 2e63 6c69 2829 0069 6620   NoCap.cli().if 
-000058e0: 5f5f 2020 4e6f 4361 702e 636c 6928 2900  __  NoCap.cli().
-000058f0: 6966 205f 5f6e 6120 204e 6f43 6170 2e63  if __na  NoCap.c
-00005900: 6c69 2829 0069 2020 204e 6f43 6170 2e63  li().i   NoCap.c
-00005910: 6c69 2829 0069 6620 5f5f 6e61 6d65 5f5f  li().if __name__
-00005920: 203d 3d20 275f 5f6d 6169 2020 2020 4e6f   == '__mai    No
-00005930: 4361 702e 636c 6928 2900 6966 205f 5f6e  Cap.cli().if __n
-00005940: 616d 655f 5f20 3d3d 2027 5f5f 6d61 696e  ame__ == '__main
-00005950: 5f5f 273a 0000 2020 2020 6c6f 672e 6465  __':..    log.de
-00005960: 6275 6728 2865 6e64 2d73 7461 7274 292f  bug((end-start)/
-00005970: 3630 2900 2020 2020 656e 6420 3d20 7469  60).    end = ti
-00005980: 6d65 2e70 6572 665f 636f 756e 7465 7228  me.perf_counter(
-00005990: 2900 2020 2020 2020 7365 6c66 2e70 726f  ).      self.pro
-000059a0: 6365 7373 5f64 6628 6466 2900 2020 2020  cess_df(df).    
-000059b0: 2020 0020 2020 2020 206c 6f67 2e64 6562    .      log.deb
-000059c0: 7567 2866 274e 6f77 2072 6561 6469 6e67  ug(f'Now reading
-000059d0: 207b 6c65 6e28 6466 297d 206f 7069 6e69   {len(df)} opini
-000059e0: 6f6e 7327 2900 2020 2020 666f 7220 6466  ons').    for df
-000059f0: 2069 6e20 7064 2e72 6561 645f 6373 7628   in pd.read_csv(
-00005a00: 7365 6c66 2e5f 6f70 696e 696f 6e73 5f66  self._opinions_f
-00005a10: 6e2c 2063 6875 6e6b 7369 7a65 3d6d 6178  n, chunksize=max
-00005a20: 5f72 6f77 732c 2064 7479 7065 3d6f 7069  _rows, dtype=opi
-00005a30: 6e69 6f6e 5f64 7479 7065 732c 2070 6172  nion_dtypes, par
-00005a40: 7365 5f64 6174 6573 3d4e 6f6e 652c 2075  se_dates=None, u
-00005a50: 7365 636f 6c73 3d75 7365 636f 6c73 293a  secols=usecols):
-00005a60: 0020 2020 2023 636c 6965 6e74 203d 2043  .    #client = C
-00005a70: 6c69 656e 7428 7468 7265 6164 735f 7065  lient(threads_pe
-00005a80: 725f 776f 726b 6572 3d34 2c20 6e5f 776f  r_worker=4, n_wo
-00005a90: 726b 6572 7320 3d20 696e 7428 6d70 2e63  rkers = int(mp.c
-00005aa0: 7075 5f63 6f75 6e74 2829 202a 202e 3430  pu_count() * .40
-00005ab0: 2929 0020 2020 206c 6f67 2e64 6562 7567  )).    log.debug
-00005ac0: 286d 7367 2900 2020 2020 6d73 6720 3d20  (msg).    msg = 
-00005ad0: 6622 4669 6c65 2053 697a 6520 6973 203a  f"File Size is :
-00005ae0: 207b 7374 7228 6669 6c65 5f73 697a 655f   {str(file_size_
-00005af0: 6762 297d 2047 4222 0020 2020 206c 6f67  gb)} GB".    log
-00005b00: 2e64 6562 7567 2866 2749 6d70 6f72 7469  .debug(f'Importi
-00005b10: 6e67 207b 7365 6c66 2e5f 6f70 696e 696f  ng {self._opinio
-00005b20: 6e73 5f66 6e7d 2061 7320 6120 6461 7461  ns_fn} as a data
-00005b30: 6672 616d 6527 2900 2020 2020 6669 6c65  frame').    file
-00005b40: 5f73 697a 655f 6762 203d 2072 6f75 6e64  _size_gb = round
-00005b50: 2866 696c 655f 7369 7a65 2f31 302a 2a39  (file_size/10**9
-00005b60: 2c20 3229 0020 2020 2066 696c 655f 7369  , 2).    file_si
-00005b70: 7a65 203d 206f 732e 7061 7468 2e67 6574  ze = os.path.get
-00005b80: 7369 7a65 2873 656c 662e 5f6f 7069 6e69  size(self._opini
-00005b90: 6f6e 735f 666e 2900 2020 2020 2020 2020  ons_fn).        
-00005ba0: 2020 5d00 2020 2020 2020 2020 2020 2027    ].           '
-00005bb0: 6c6f 6361 6c5f 7061 7468 2720 2020 2020  local_path'     
-00005bc0: 2020 2020 2020 0020 2020 2020 2020 2020        .         
-00005bd0: 2020 2768 746d 6c5f 616e 6f6e 5f32 3032    'html_anon_202
-00005be0: 3027 2c00 2020 2020 2020 2020 2020 2027  0',.           '
-00005bf0: 6874 6d6c 5f63 6f6c 756d 6269 6127 2c00  html_columbia',.
-00005c00: 2020 2020 2020 2020 2020 2027 6874 6d6c             'html
-00005c10: 5f6c 6177 626f 7827 2c00 2020 2020 2020  _lawbox',.      
-00005c20: 2020 2020 2027 6874 6d6c 272c 0020 2020       'html',.   
-00005c30: 2020 2020 2020 2020 2770 6c61 696e 5f74          'plain_t
-00005c40: 6578 7427 2c00 2020 2020 2020 2020 2020  ext',.          
-00005c50: 2027 786d 6c5f 6861 7276 6172 6427 2c00   'xml_harvard',.
-00005c60: 2020 2020 2020 2020 2020 2027 636c 7573             'clus
-00005c70: 7465 725f 6964 272c 0020 2020 2020 2020  ter_id',.       
-00005c80: 2020 2020 276c 6f63 616c 5f70 6174 6827      'local_path'
-00005c90: 2c00 2020 2020 2020 2020 2020 2027 646f  ,.           'do
-00005ca0: 776e 6c6f 6164 5f75 726c 272c 2000 2020  wnload_url', .  
-00005cb0: 2020 2020 2020 2020 2027 6964 272c 0020           'id',. 
-00005cc0: 2020 2075 7365 636f 6c73 203d 205b 0020     usecols = [. 
-00005cd0: 2020 207d 0020 2020 2020 2020 2027 6c6f     }.        'lo
-00005ce0: 6361 6c5f 7061 7468 273a 2773 7472 696e  cal_path':'strin
-00005cf0: 6727 0020 2020 2020 2020 2027 6874 6d6c  g'.        'html
-00005d00: 5f77 6974 685f 6369 7461 7469 6f6e 7327  _with_citations'
-00005d10: 3a27 7374 7269 6e67 272c 0020 2020 2020  :'string',.     
-00005d20: 2020 2027 6874 6d6c 5f61 6e6f 6e5f 3230     'html_anon_20
-00005d30: 3230 273a 2773 7472 696e 6727 2c00 2020  20':'string',.  
-00005d40: 2020 2020 2020 2768 746d 6c5f 636f 6c75        'html_colu
-00005d50: 6d62 6961 273a 2773 7472 696e 6727 2c00  mbia':'string',.
-00005d60: 2020 2020 2020 2020 2768 746d 6c5f 6c61          'html_la
-00005d70: 7762 6f78 273a 2773 7472 696e 6727 2c00  wbox':'string',.
-00005d80: 2020 2020 2020 2020 2768 746d 6c27 3a27          'html':'
-00005d90: 7374 7269 6e67 272c 0020 2020 2020 2020  string',.       
-00005da0: 2027 706c 6169 6e5f 7465 7874 273a 2773   'plain_text':'s
-00005db0: 7472 696e 6727 2c00 2020 2020 2020 2020  tring',.        
-00005dc0: 276c 6f63 616c 5f70 6174 6827 3a27 7374  'local_path':'st
-00005dd0: 7269 6e67 272c 0020 2020 2020 2020 2027  ring',.        '
-00005de0: 646f 776e 6c6f 6164 5f75 726c 273a 2027  download_url': '
-00005df0: 7374 7269 6e67 272c 0020 2020 206f 7069  string',.    opi
-00005e00: 6e69 6f6e 5f64 7479 7065 7320 3d20 7b00  nion_dtypes = {.
-00005e10: 2020 2020 6d61 785f 726f 7773 203d 2031      max_rows = 1
-00005e20: 3030 3000 2020 2020 7374 6172 7420 3d20  000.    start = 
-00005e30: 7469 6d65 2e70 6572 665f 636f 756e 7465  time.perf_counte
-00005e40: 7228 2900 2020 6465 6620 7374 6172 7428  r().  def start(
-00005e50: 7365 6c66 293a 0020 2000 2020 2020 7072  self):.  .    pr
-00005e60: 696e 7428 2774 6573 7427 2900 2020 6465  int('test').  de
-00005e70: 6620 7465 7374 2873 656c 6629 3a00 2020  f test(self):.  
-00005e80: 2020 0020 2020 2070 7269 6e74 2872 6573    .    print(res
-00005e90: 756c 7473 2900 2020 2020 7265 7375 6c74  ults).    result
-00005ea0: 7320 3d20 6462 2e6d 6170 2873 656c 662e  s = db.map(self.
-00005eb0: 7072 6f63 6573 735f 726f 772c 2062 292e  process_row, b).
-00005ec0: 746f 5f74 6578 7466 696c 6573 2827 6461  to_textfiles('da
-00005ed0: 7461 2f2a 2e6a 736f 6e6c 2729 0020 2020  ta/*.jsonl').   
-00005ee0: 2023 7072 696e 7428 6c69 7374 286d 6170   #print(list(map
-00005ef0: 2873 656c 662e 7072 6f63 6573 735f 726f  (self.process_ro
-00005f00: 772c 2064 665f 6469 6374 2929 2900 2020  w, df_dict))).  
-00005f10: 2020 6220 3d20 6462 2e66 726f 6d5f 7365    b = db.from_se
-00005f20: 7175 656e 6365 2864 665f 6469 6374 2c20  quence(df_dict, 
-00005f30: 6e70 6172 7469 7469 6f6e 733d 696e 7428  npartitions=int(
-00005f40: 6d70 2e63 7075 5f63 6f75 6e74 2829 202a  mp.cpu_count() *
-00005f50: 202e 3830 2929 0020 2020 2000 2020 2020   .80)).    .    
-00005f60: 6466 5f64 6963 7420 3d20 6466 2e74 6f5f  df_dict = df.to_
-00005f70: 6469 6374 2827 7265 636f 7264 7327 2900  dict('records').
-00005f80: 2020 2020 6c6f 672e 6465 6275 6728 2770      log.debug('p
-00005f90: 7269 6e74 696e 6720 6d69 6e69 206f 7069  rinting mini opi
-00005fa0: 6e69 6f6e 2064 6174 6166 7261 6d65 2061  nion dataframe a
-00005fb0: 7320 6120 6469 6374 2729 0020 2020 206c  s a dict').    l
-00005fc0: 6f67 2e64 6562 7567 2827 7072 6f63 6573  og.debug('proces
-00005fd0: 735f 6466 3a20 636c 6965 6e74 2e6d 6170  s_df: client.map
-00005fe0: 2729 0020 2064 6566 2070 726f 6365 7373  ').  def process
-00005ff0: 5f64 6628 7365 6c66 2c20 6466 293a 0000  _df(self, df):..
-00006000: 6164 0000 be0a 0000 6e0b 0000 0010 0000  ad......n.......
-00006010: 2500 0000 0000 0000 ed0f 0000 d10f 0000  %...............
-00006020: af0f 0000 a60f 0000 a50f 0000 800f 0000  ................
-00006030: 4b0f 0000 1c0f 0000 e50e 0000 b00e 0000  K...............
-00006040: 9b0e 0000 9a0e 0000 2a0e 0000 ff0d 0000  ........*.......
-00006050: fe0d 0000 fd0d 0000 e10d 0000 b90d 0000  ................
-00006060: 990d 0000 750d 0000 480d 0000 1d0d 0000  ....u...H.......
-00006070: ea0c 0000 d70c 0000 d60c 0000 b60c 0000  ................
-00006080: a00c 0000 820c 0000 590c 0000 3e0c 0000  ........Y...>...
-00006090: eb0b 0000 ea0b 0000 cc0b 0000 8a0b 0000  ................
-000060a0: 890b 0000 710b 0000 6e0b 0000 0a0c 0000  ....q...n.......
-000060b0: e20b 0000 c60b 0000 9d0b 0000 7f0b 0000  ................
-000060c0: 570b 0000 370b 0000 130b 0000 fd0a 0000  W...7...........
-000060d0: ca0a 0000 c70a 0000 bb0a 0000 910a 0000  ................
-000060e0: 740a 0000 500a 0000 2e0a 0000 070a 0000  t...P...........
-000060f0: e809 0000 c109 0000 c009 0000 6c09 0000  ............l...
-00006100: 0309 0000 0209 0000 bb08 0000 8d08 0000  ................
-00006110: 4e08 0000 4d08 0000 2e08 0000 0908 0000  N...M...........
-00006120: f907 0000 cf07 0000 9307 0000 7b07 0000  ............{...
-00006130: 6c07 0000 6b07 0000 4f07 0000 1107 0000  l...k...O.......
-00006140: e806 0000 bf06 0000 be06 0000 b106 0000  ................
-00006150: 9106 0000 7e06 0000 7006 0000 5b06 0000  ....~...p...[...
-00006160: 1206 0000 e705 0000 e105 0000 d705 0000  ................
-00006170: 9305 0000 5605 0000 2e05 0000 0705 0000  ....V...........
-00006180: 0605 0000 fa04 0000 e004 0000 cc04 0000  ................
-00006190: 9004 0000 5b04 0000 2c04 0000 f303 0000  ....[...,.......
-000061a0: d303 0000 b403 0000 7b03 0000 3803 0000  ........{...8...
-000061b0: 1803 0000 f602 0000 bf02 0000 a402 0000  ................
-000061c0: 6b02 0000 4002 0000 3202 0000 2802 0000  k...@...2...(...
-000061d0: 2202 0000 f301 0000 0000 0000 0000 0000  "...............
-000061e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000061f0: 0000 0020 2020 2072 6574 7572 6e20 6a73  ...    return js
-00006200: 6f6e 2e64 756d 7073 286f 626a 2c20 636c  on.dumps(obj, cl
-00006210: 733d 7365 6c66 2e4e 7045 6e63 6f64 6572  s=self.NpEncoder
-00006220: 2900 2020 2020 7d00 2020 2020 2020 2020  ).    }.        
-00006230: 7d00 2020 2020 2020 2020 2020 2020 7d00  }.            }.
-00006240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006250: 2761 7574 686f 7227 3a20 2727 2c20 2774  'author': '', 't
-00006260: 7970 6527 3a20 2727 7d5d 0020 2020 2020  ype': ''}].     
-00006270: 2020 2020 2020 2020 2020 2027 7465 7874             'text
-00006280: 273a 2073 656c 662e 6765 745f 6f70 696e  ': self.get_opin
-00006290: 696f 6e5f 7465 7874 286f 7069 6e69 6f6e  ion_text(opinion
-000062a0: 292c 2000 2020 2020 2020 2020 2020 2020  ), .            
-000062b0: 276f 7069 6e69 6f6e 7327 3a20 5b7b 0020  'opinions': [{. 
-000062c0: 2020 2020 2020 2020 2020 2027 6865 6164             'head
-000062d0: 5f6d 6174 7465 7227 3a27 272c 2023 4173  _matter':'', #As
-000062e0: 6b20 434c 2061 626f 7574 2063 6f70 7972  k CL about copyr
-000062f0: 6967 6874 2c00 2020 2020 2020 2020 2020  ight,.          
-00006300: 2020 276a 7564 6765 7327 3a20 6a75 6467    'judges': judg
-00006310: 655f 6c69 7374 2c00 2020 2020 2020 2020  e_list,.        
-00006320: 2763 6173 6562 6f64 7927 203a 207b 2764  'casebody' : {'d
-00006330: 6174 6127 3a20 7b00 2020 2020 2020 2020  ata': {.        
-00006340: 276a 7572 6973 6469 6374 696f 6e27 203a  'jurisdiction' :
-00006350: 207b 276e 616d 6527 3a20 636f 7572 745f   {'name': court_
-00006360: 726f 772e 6a75 7269 7364 6963 7469 6f6e  row.jurisdiction
-00006370: 2e69 6c6f 635b 305d 7d2c 0020 2020 2020  .iloc[0]},.     
-00006380: 2020 2027 636f 7572 7427 203a 207b 276e     'court' : {'n
-00006390: 616d 6527 3a20 636f 7572 745f 726f 772e  ame': court_row.
-000063a0: 6675 6c6c 5f6e 616d 652e 696c 6f63 5b30  full_name.iloc[0
-000063b0: 5d7d 2c00 2020 2020 2020 2020 2763 6974  ]},.        'cit
-000063c0: 6573 5f74 6f27 203a 2063 6974 6573 5f74  es_to' : cites_t
-000063d0: 6f2c 0020 2020 2020 2020 2027 6369 7461  o,.        'cita
-000063e0: 7469 6f6e 7327 203a 2063 6974 6564 5f62  tions' : cited_b
-000063f0: 792c 0020 2020 2020 2020 2027 646f 636b  y,.        'dock
-00006400: 6574 5f6e 756d 6265 7227 203a 2063 6c75  et_number' : clu
-00006410: 7374 6572 5f72 6f77 2e64 6f63 6b65 745f  ster_row.docket_
-00006420: 6964 2e69 6c6f 635b 305d 2c00 2020 2020  id.iloc[0],.    
-00006430: 2020 2020 2764 6563 6973 696f 6e5f 6461      'decision_da
-00006440: 7465 273a 2027 272c 2023 6461 7465 5f74  te': '', #date_t
-00006450: 6572 6d69 6e61 7465 642c 0020 2020 2020  erminated,.     
-00006460: 2020 2027 6e61 6d65 2720 3a20 636c 7573     'name' : clus
-00006470: 7465 725f 726f 772e 6361 7365 5f6e 616d  ter_row.case_nam
-00006480: 655f 6675 6c6c 2e69 6c6f 635b 305d 2c00  e_full.iloc[0],.
-00006490: 2020 2020 2020 2020 276e 616d 655f 6162          'name_ab
-000064a0: 6272 6576 6961 7469 6f6e 273a 2063 6c75  breviation': clu
-000064b0: 7374 6572 5f72 6f77 2e63 6173 655f 6e61  ster_row.case_na
-000064c0: 6d65 2e69 6c6f 635b 305d 2c00 2020 2020  me.iloc[0],.    
-000064d0: 2020 2020 2775 726c 273a 2075 726c 2c00      'url': url,.
-000064e0: 2020 2020 2020 2020 2769 6427 3a20 636c          'id': cl
-000064f0: 7573 7465 725f 6964 2c00 2020 2020 6f62  uster_id,.    ob
-00006500: 6a20 3d20 7b00 0020 2020 2075 726c 203d  j = {..    url =
-00006510: 2027 2720 2320 6f70 696e 696f 6e5b 2764   '' # opinion['d
-00006520: 6f77 6e6c 6f61 645f 7572 6c27 5d00 2020  ownload_url'].  
-00006530: 2020 2323 2064 6f77 6e6c 6f61 6420 7572    ## download ur
-00006540: 6c20 6d61 7920 616c 736f 2062 6520 6d69  l may also be mi
-00006550: 7373 696e 6700 2020 2020 6461 7465 5f74  ssing.    date_t
-00006560: 6572 6d69 6e61 7465 6420 3d20 6c69 7374  erminated = list
-00006570: 2864 6f63 6b65 745f 726f 775b 2764 6174  (docket_row['dat
-00006580: 655f 7465 726d 696e 6174 6564 275d 295b  e_terminated'])[
-00006590: 305d 0020 2020 2023 2320 736f 6d65 7469  0].    ## someti
-000065a0: 6d65 7320 6461 7465 5f74 6572 6d69 6e61  mes date_termina
-000065b0: 7465 6420 6d61 7920 6265 206d 6973 7369  ted may be missi
-000065c0: 6e67 2061 6e64 2072 6563 6f72 6465 6420  ng and recorded 
-000065d0: 6173 204e 614e 0020 2020 2023 2020 2020  as NaN.    #    
-000065e0: 0020 2020 205d 0020 2020 2020 2020 2069  .    ].        i
-000065f0: 6620 6e6f 7420 7265 2e6d 6174 6368 2827  f not re.match('
-00006600: 5b63 6a5d 3f6a 5c2e 272c 206a 7564 6765  [cj]?j\.', judge
-00006610: 2900 2020 2020 2020 2020 2020 2020 286a  ).            (j
-00006620: 7564 6765 732e 696c 6f63 5b30 5d2e 7370  udges.iloc[0].sp
-00006630: 6c69 7428 272c 2729 2069 6620 6a75 6467  lit(',') if judg
-00006640: 6573 2e6e 6f74 6e61 2829 2e62 6f6f 6c28  es.notna().bool(
-00006650: 2920 656c 7365 205b 5d29 0020 2020 2020  ) else []).     
-00006660: 2020 2066 6f72 206a 7564 6765 2069 6e00     for judge in.
-00006670: 2020 2020 2020 2020 6a75 6467 6500 2020          judge.  
-00006680: 2020 6a75 6467 655f 6c69 7374 203d 205b    judge_list = [
-00006690: 0020 2020 206a 7564 6765 7320 3d20 636c  .    judges = cl
-000066a0: 7573 7465 725f 726f 772e 6a75 6467 6573  uster_row.judges
-000066b0: 0020 2020 2023 206a 7564 6765 7300 0020  .    # judges.. 
-000066c0: 2020 2063 6974 6564 5f62 7920 3d20 6369     cited_by = ci
-000066d0: 7461 7469 6f6e 5f69 6e66 6f5b 2763 6974  tation_info['cit
-000066e0: 6564 5f62 7927 5d00 2020 2020 6369 7465  ed_by'].    cite
-000066f0: 735f 746f 203d 2063 6974 6174 696f 6e5f  s_to = citation_
-00006700: 696e 666f 5b27 6369 7465 735f 746f 275d  info['cites_to']
-00006710: 0020 2020 2063 6974 6174 696f 6e5f 696e  .    citation_in
-00006720: 666f 203d 2073 656c 662e 6765 745f 6369  fo = self.get_ci
-00006730: 7461 7469 6f6e 7328 6f70 696e 696f 6e5f  tations(opinion_
-00006740: 6964 2c20 6369 7461 7469 6f6e 7329 0020  id, citations). 
-00006750: 2020 2023 2067 6574 206f 7069 6e69 6f6e     # get opinion
-00006760: 7320 6369 7465 6420 746f 0000 2020 2020  s cited to..    
-00006770: 2020 2020 7265 7475 726e 0020 2020 2069      return.    i
-00006780: 6620 636f 7572 745f 726f 772e 656d 7074  f court_row.empt
-00006790: 793a 0020 2020 2063 6f75 7274 5f72 6f77  y:.    court_row
-000067a0: 3a20 7365 6c66 2e44 6174 6146 7261 6d65  : self.DataFrame
-000067b0: 203d 2063 6f75 7274 735b 636f 7572 7473   = courts[courts
-000067c0: 5b27 6964 275d 203d 3d20 6369 645d 0020  ['id'] == cid]. 
-000067d0: 2020 2063 6964 203d 206c 6973 7428 646f     cid = list(do
-000067e0: 636b 6574 5f72 6f77 5b27 636f 7572 745f  cket_row['court_
-000067f0: 6964 275d 295b 305d 0020 2020 2020 2020  id'])[0].       
-00006800: 2072 6574 7572 6e20 0020 2020 2069 6620   return .    if 
-00006810: 6c65 6e28 646f 636b 6574 5f72 6f77 2e63  len(docket_row.c
-00006820: 6f6c 756d 6e73 2920 3d3d 2030 3a00 2020  olumns) == 0:.  
-00006830: 2020 2320 7265 7475 726e 2065 6172 6c79    # return early
-00006840: 2069 6620 7468 6572 6527 7320 0000 2020   if there's ..  
-00006850: 2020 646f 636b 6574 5f72 6f77 203d 2064    docket_row = d
-00006860: 6f63 6b65 7473 5b64 6f63 6b65 7473 5b27  ockets[dockets['
-00006870: 6964 275d 203d 3d20 646f 636b 6574 5f69  id'] == docket_i
-00006880: 645d 2e63 6f6d 7075 7465 2829 0020 2020  d].compute().   
-00006890: 2064 6f63 6b65 745f 6964 203d 2069 6e74   docket_id = int
-000068a0: 2863 6c75 7374 6572 5f72 6f77 5b27 646f  (cluster_row['do
-000068b0: 636b 6574 5f69 6427 5d29 0020 2020 2023  cket_id']).    #
-000068c0: 2067 6574 2063 6f72 7265 7370 6f6e 6469   get correspondi
-000068d0: 6e67 2072 6f77 2066 726f 6d20 646f 636b  ng row from dock
-000068e0: 6574 2064 6620 6261 7365 6420 6f6e 2063  et df based on c
-000068f0: 6c75 7374 6572 206f 7069 6e69 6f6e 2069  luster opinion i
-00006900: 6400 0020 2020 2063 6c75 7374 6572 5f72  d..    cluster_r
-00006910: 6f77 3a20 7365 6c66 2e44 6174 6146 7261  ow: self.DataFra
-00006920: 6d65 203d 2073 656c 662e 6466 5f72 6f77  me = self.df_row
-00006930: 5f62 795f 7661 6c75 6528 7365 6c66 2e67  _by_value(self.g
-00006940: 6574 5f6f 7069 6e69 6f6e 735f 636c 7573  et_opinions_clus
-00006950: 7465 725f 6466 2829 2c20 2769 6427 2c20  ter_df(), 'id', 
-00006960: 636c 7573 7465 725f 6964 2900 2020 2020  cluster_id).    
-00006970: 2320 6765 7420 6561 6368 2063 6f72 7265  # get each corre
-00006980: 7370 6f6e 6469 6e67 2072 6f77 2066 726f  sponding row fro
-00006990: 6d20 636c 7573 7465 7273 2c20 646f 636b  m clusters, dock
-000069a0: 6574 732c 2063 6f75 7274 7320 6261 7365  ets, courts base
-000069b0: 6420 6f6e 206f 7069 6e69 6f6e 2069 6400  d on opinion id.
-000069c0: 0020 2020 2063 6c75 7374 6572 5f69 6420  .    cluster_id 
-000069d0: 3d20 6f70 696e 696f 6e5b 2763 6c75 7374  = opinion['clust
-000069e0: 6572 5f69 6427 5d00 2020 2020 6f70 696e  er_id'].    opin
-000069f0: 696f 6e5f 6964 203d 206f 7069 6e69 6f6e  ion_id = opinion
-00006a00: 5b27 6964 275d 0020 2020 2063 6974 6174  ['id'].    citat
-00006a10: 696f 6e73 203d 2073 656c 662e 6765 745f  ions = self.get_
-00006a20: 6369 7461 7469 6f6e 5f64 6628 2900 2020  citation_df().  
-00006a30: 2020 636f 7572 7473 203d 2073 656c 662e    courts = self.
-00006a40: 6765 745f 636f 7572 7473 5f64 6628 2900  get_courts_df().
-00006a50: 2020 2020 646f 636b 6574 7320 3d20 7365      dockets = se
-00006a60: 6c66 2e67 6574 5f64 6f63 6b65 7473 5f64  lf.get_dockets_d
-00006a70: 6628 2900 2020 2020 6c6f 672e 6465 6275  f().    log.debu
-00006a80: 6728 2770 726f 6365 7373 5f72 6f77 2729  g('process_row')
-00006a90: 0020 2064 6566 2070 726f 6365 7373 5f72  .  def process_r
-00006aa0: 6f77 2873 656c 662c 206f 7069 6e69 6f6e  ow(self, opinion
-00006ab0: 2920 2d3e 2064 6963 743a 0020 2023 2070  ) -> dict:.  # p
-00006ac0: 726f 6365 7373 0020 2000 2020 2020 2020  rocess.  .      
-00006ad0: 2020 7265 7475 726e 2073 7570 6572 284e    return super(N
-00006ae0: 7045 6e63 6f64 6572 2c20 7365 6c66 292e  pEncoder, self).
-00006af0: 6465 6661 756c 7428 6f62 6a29 0020 2020  default(obj).   
-00006b00: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00006b10: 2727 0020 2020 2020 2020 2069 6620 6973  ''.        if is
-00006b20: 696e 7374 616e 6365 286f 626a 2c20 2020  instance(obj,   
-00006b30: 2020 2020 2020 2020 0020 2020 2072 6574          .    ret
-00006b40: 7572 6e20 646f 636b 6574 735f 6469 6374  urn dockets_dict
-00006b50: 0000 2020 2020 6c6f 672e 6465 6275 6720  ..    log.debug 
-00006b60: 2000 2020 2020 7265 7475 726e 2064 2020   .    return d  
-00006b70: 0020 2020 2072 6574 7572 6e20 646f 636b  .    return dock
-00006b80: 6574 735f 6469 6374 0000 2020 2020 6c6f  ets_dict..    lo
-00006b90: 672e 6465 6275 6728 6627 7b66 6e7d 2072  g.debug(f'{fn} r
-00006ba0: 6561 6420 696e 207b 7374 7228 696e 7428  ead in {str(int(
-00006bb0: 2865 6e64 2d73 7461 7274 292f 3630 2929  (end-start)/60))
-00006bc0: 7d20 6d69 6e75 7465 7327 2900 2020 2020  } minutes').    
-00006bd0: 656e 6420 3d20 7469 6d65 2e70 6572 665f  end = time.perf_
-00006be0: 636f 756e 7465 7228 2900 0020 2020 2020  counter()..     
-00006bf0: 2020 2020 2020 2064 6f63 6b65 7473 5f64         dockets_d
-00006c00: 6963 745b 696e 7428 726f 775b 2769 6427  ict[int(row['id'
-00006c10: 5d29 5d20 3d20 726f 775b 2763 6f75 7274  ])] = row['court
-00006c20: 5f69 6427 5d2c 2072 6f77 5b27 6461 7465  _id'], row['date
-00006c30: 5f74 6572 6d69 6e61 7465 6427 5d00 2020  _terminated'].  
-00006c40: 2020 2020 2020 666f 7220 726f 7720 696e        for row in
-00006c50: 2072 6561 6465 723a 0020 2020 2020 2020   reader:.       
-00006c60: 2072 6561 6465 7220 3d20 6373 762e 4469   reader = csv.Di
-00006c70: 6374 5265 6164 6572 2864 6f63 6b65 7473  ctReader(dockets
-00006c80: 2900 2020 2020 7769 7468 206f 7065 6e28  ).    with open(
-00006c90: 666e 2920 6173 2064 6f63 6b65 7473 3a00  fn) as dockets:.
-00006ca0: 2020 2020 646f 636b 6574 735f 6469 6374      dockets_dict
-00006cb0: 203d 207b 7d00 2020 2020 7374 6172 7420   = {}.    start 
-00006cc0: 3d20 7469 6d65 2e70 6572 665f 636f 756e  = time.perf_coun
-00006cd0: 7465 7228 2900 0020 2020 206c 6f67 2e64  ter()..    log.d
-00006ce0: 6562 7567 286d 7367 2900 2020 2020 6d73  ebug(msg).    ms
-00006cf0: 6720 3d20 6622 4669 6c65 2053 697a 6520  g = f"File Size 
-00006d00: 6973 203a 207b 7374 7228 6669 6c65 5f73  is : {str(file_s
-00006d10: 697a 655f 6762 297d 2047 4222 0020 2020  ize_gb)} GB".   
-00006d20: 206c 6f67 2e64 6562 7567 2866 2749 6d70   log.debug(f'Imp
-00006d30: 6f72 7469 6e67 207b 666e 7d20 6173 2061  orting {fn} as a
-00006d40: 2044 6963 7427 2900 2020 2020 6669 6c65   Dict').    file
-00006d50: 5f73 697a 655f 6762 203d 2072 6f75 6e64  _size_gb = round
-00006d60: 2866 696c 655f 7369 7a65 2f31 302a 2a39  (file_size/10**9
-00006d70: 2c20 3229 0020 2020 2066 696c 655f 7369  , 2).    file_si
-00006d80: 7a65 203d 206f 732e 7061 7468 2e67 6574  ze = os.path.get
-00006d90: 7369 7a65 2866 6e29 0020 2020 2066 6e20  size(fn).    fn 
-00006da0: 3d20 666e 206f 7220 7365 6c66 2e5f 646f  = fn or self._do
-00006db0: 636b 6574 735f 666e 0020 2064 6566 2069  ckets_fn.  def i
-00006dc0: 6e69 745f 646f 636b 6574 735f 6469 6374  nit_dockets_dict
-00006dd0: 2873 656c 662c 2066 6e3d 4e6f 6e65 293a  (self, fn=None):
-00006de0: 0020 2023 2069 6e69 7469 616c 697a 6520  .  # initialize 
-00006df0: 646f 636b 6574 7320 6469 6374 0000 0020  dockets dict... 
-00006e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e10: 2020 2020 2020 2020 626c 6f63 6b73 697a          blocksiz
-00006e20: 653d 2233 324d 4222 2900 2020 2020 2020  e="32MB").      
-00006e30: 7265 7475 726e 2064 642e 7265 6164 5f63  return dd.read_c
-00006e40: 7376 2866 6e20 6f72 2073 656c 662e 5f64  sv(fn or self._d
-00006e50: 6f63 6b65 7473 5f66 6e2c 2064 7479 7065  ockets_fn, dtype
-00006e60: 3d6d 795f 7479 7065 732c 2075 7365 636f  =my_types, useco
-00006e70: 6c73 3d5b 2763 6f75 7274 5f69 6427 2c20  ls=['court_id', 
-00006e80: 2769 6427 2c20 2764 6174 655f 7465 726d  'id', 'date_term
-00006e90: 696e 6174 6564 275d 2c00 0020 2020 2020  inated'],..     
-00006ea0: 206c 6f67 2e64 6562 7567 286d 7367 2900   log.debug(msg).
-00006eb0: 2020 2020 2020 6d73 6720 3d20 6622 4669        msg = f"Fi
-00006ec0: 6c65 2053 697a 6520 6973 203a 207b 7374  le Size is : {st
-00006ed0: 7228 6669 6c65 5f73 697a 655f 6762 297d  r(file_size_gb)}
-00006ee0: 2047 4222 0020 2020 2020 206c 6f67 2e64   GB".      log.d
-00006ef0: 6562 7567 2866 2749 6d70 6f72 7469 6e67  ebug(f'Importing
-00006f00: 207b 666e 7d20 6173 2061 2044 6173 6b20   {fn} as a Dask 
-00006f10: 4461 7461 6672 616d 6527 2900 2020 2020  Dataframe').    
-00006f20: 2020 6669 6c65 5f73 697a 655f 6762 203d    file_size_gb =
-00006f30: 2072 6f75 6e64 2866 696c 655f 7369 7a65   round(file_size
-00006f40: 2f31 302a 2a39 2c20 3229 0020 2020 2020  /10**9, 2).     
-00006f50: 2066 696c 655f 7369 7a65 203d 206f 732e   file_size = os.
-00006f60: 7061 7468 2e67 6574 7369 7a65 2873 656c  path.getsize(sel
-00006f70: 662e 5f6f 7069 6e69 6f6e 735f 666e 2900  f._opinions_fn).
-00006f80: 2020 2020 2020 6c6f 672e 6465 6275 6728        log.debug(
-00006f90: 2769 6d70 6f72 7469 6e67 2064 6f63 6b65  'importing docke
-00006fa0: 7473 2729 0000 2020 2020 2020 7d20 0020  ts')..      } . 
-00006fb0: 2020 2020 2027 6461 7465 5f74 6572 6d69       'date_termi
-00006fc0: 6e61 7465 6427 3a20 2773 7472 696e 6727  nated': 'string'
-00006fd0: 0020 2020 2020 2027 636f 7572 745f 6964  .      'court_id
-00006fe0: 273a 2027 7374 7269 6e67 272c 0020 2020  ': 'string',.   
-00006ff0: 2020 206d 795f 7479 7065 7320 3d20 7b00     my_types = {.
-00007000: 6164 0000 6802 0000 0804 0000 0010 0000  ad..h...........
-00007010: 6100 0000 0000 0000 e10f 0000 ba0f 0000  a...............
-00007020: 850f 0000 840f 0000 770f 0000 5c0f 0000  ........w...\...
-00007030: 3f0f 0000 3e0f 0000 210f 0000 020f 0000  ?...>...!.......
-00007040: ff0e 0000 e30e 0000 c50e 0000 c40e 0000  ................
-00007050: 9f0e 0000 780e 0000 770e 0000 5a0e 0000  ....x...w...Z...
-00007060: 4f0e 0000 4e0e 0000 290e 0000 0d0e 0000  O...N...).......
-00007070: e50d 0000 c90d 0000 a00d 0000 820d 0000  ................
-00007080: 5a0d 0000 3a0d 0000 160d 0000 000d 0000  Z...:...........
-00007090: cd0c 0000 ca0c 0000 be0c 0000 940c 0000  ................
-000070a0: 770c 0000 530c 0000 310c 0000 0a0c 0000  w...S...1.......
-000070b0: eb0b 0000 c40b 0000 c30b 0000 6f0b 0000  ............o...
-000070c0: 060b 0000 050b 0000 be0a 0000 900a 0000  ................
-000070d0: 500a 0000 2c0a 0000 280a 0000 090a 0000  P...,...(.......
-000070e0: f209 0000 e309 0000 cb09 0000 8f09 0000  ................
-000070f0: 7709 0000 6809 0000 6709 0000 4b09 0000  w...h...g...K...
-00007100: 0d09 0000 e408 0000 bb08 0000 ba08 0000  ................
-00007110: ad08 0000 8d08 0000 7a08 0000 6c08 0000  ........z...l...
-00007120: 5708 0000 0e08 0000 e307 0000 dd07 0000  W...............
-00007130: d307 0000 8f07 0000 6b07 0000 4307 0000  ........k...C...
-00007140: 1c07 0000 1b07 0000 0f07 0000 f506 0000  ................
-00007150: e106 0000 a506 0000 7006 0000 4106 0000  ........p...A...
-00007160: 0806 0000 e805 0000 c905 0000 9005 0000  ................
-00007170: 4d05 0000 2d05 0000 0b05 0000 d404 0000  M...-...........
-00007180: b904 0000 8004 0000 5504 0000 4704 0000  ........U...G...
-00007190: 3d04 0000 3704 0000 0804 0000 e803 0000  =...7...........
+00003230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000032a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000032b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000032c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000032d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000032e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000032f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000033a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000033b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000033c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000033d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000033e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000033f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000034a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000034b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000034c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000034d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000034e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000034f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000035a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000035b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000035c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000035d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000035e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000035f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000036a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000036b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000036c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000036d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000036e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000036f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000037a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000037b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000037c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000037d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000037e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000037f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000038a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000038b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000038c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000038d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000038e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000038f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000039a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000039b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000039c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000039d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000039e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000039f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003b20: 0000 0000 0000 2020 2020 204e 6f43 6170  ......     NoCap
+00003b30: 2e63 6c69 2829 0069 6620 2020 2020 2020  .cli().if       
+00003b40: 2020 4e6f 4361 702e 636c 6928 2900 6966    NoCap.cli().if
+00003b50: 205f 5f6e 616d 655f 5f20 3d3d 2022 5f5f   __name__ == "__
+00003b60: 6d61 696e 5f5f 223a 0000 0020 2020 2020  main__":...     
+00003b70: 2020 206c 6f67 2e64 6562 7567 2866 2746     log.debug(f'F
+00003b80: 696e 6973 6865 643a 207b 2865 6e64 202d  inished: {(end -
+00003b90: 2073 7461 7274 2920 2f20 3630 7d27 2900   start) / 60}').
+00003ba0: 2020 2020 2020 2020 656e 6420 3d20 7469          end = ti
+00003bb0: 6d65 2e70 6572 665f 636f 756e 7465 7228  me.perf_counter(
+00003bc0: 2900 2020 2020 2020 2020 2020 2020 2020  ).              
+00003bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003be0: 2020 2020 6669 6c65 2e77 7269 7465 2866      file.write(f
+00003bf0: 277b 7265 7375 6c74 7d27 2900 2020 2020  '{result}').    
+00003c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003c10: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00003c20: 206f 7065 6e28 276e 6f63 6170 5f6f 7069   open('nocap_opi
+00003c30: 6e69 6f6e 732e 6a73 6f6e 6c27 2c20 2761  nions.jsonl', 'a
+00003c40: 2729 2061 7320 6669 6c65 3a00 2020 2020  ') as file:.    
+00003c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003c60: 2020 2020 2020 2020 2077 6974 6820 6c6f           with lo
+00003c70: 636b 3a00 2020 2020 2020 2020 2020 2020  ck:.            
+00003c80: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00003c90: 3a00 2020 2020 2020 2020 2020 2020 2020  :.              
+00003ca0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00003cb0: 672e 6578 6365 7074 696f 6e28 6578 6329  g.exception(exc)
+00003cc0: 0020 2020 2020 2020 2020 2020 2020 2020  .               
+00003cd0: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00003ce0: 4578 6365 7074 696f 6e20 6173 2065 7863  Exception as exc
+00003cf0: 3a00 2020 2020 2020 2020 2020 2020 2020  :.              
+00003d00: 2020 2020 2020 2020 2020 2020 2020 7062                pb
+00003d10: 6172 2e75 7064 6174 6528 6d61 785f 726f  ar.update(max_ro
+00003d20: 7773 2900 2020 2020 2020 2020 2020 2020  ws).            
+00003d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d40: 7265 7375 6c74 203d 2066 7574 7572 652e  result = future.
+00003d50: 7265 7375 6c74 2829 0020 2020 2020 2020  result().       
+00003d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d70: 2074 7279 3a00 2020 2020 2020 2020 2020   try:.          
+00003d80: 2020 2020 2020 2020 2020 666f 7220 6675            for fu
+00003d90: 7475 7265 2069 6e20 6173 5f63 6f6d 706c  ture in as_compl
+00003da0: 6574 6564 2866 7574 7572 6573 293a 0020  eted(futures):. 
+00003db0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00003dc0: 6620 2869 202b 2031 2920 2520 4e5f 4348  f (i + 1) % N_CH
+00003dd0: 554e 4b53 5f50 4552 5f42 4154 4348 203d  UNKS_PER_BATCH =
+00003de0: 3d20 303a 0020 2020 2020 2020 2020 2020  = 0:.           
+00003df0: 2020 2020 2066 7574 7572 6573 2e61 7070       futures.app
+00003e00: 656e 6428 6578 6563 7574 6f72 2e73 7562  end(executor.sub
+00003e10: 6d69 7428 7365 6c66 2e70 726f 6365 7373  mit(self.process
+00003e20: 5f64 662c 2064 6629 2900 2020 2020 2020  _df, df)).      
+00003e30: 2020 2020 2020 666f 7220 692c 2064 6620        for i, df 
+00003e40: 696e 2065 6e75 6d65 7261 7465 2863 6875  in enumerate(chu
+00003e50: 6e6b 7329 3a00 2020 2020 2020 2020 2020  nks):.          
+00003e60: 2020 6675 7475 7265 7320 3d20 5b5d 0020    futures = []. 
+00003e70: 2020 2020 2020 2077 6974 6820 5468 7265         with Thre
+00003e80: 6164 506f 6f6c 4578 6563 7574 6f72 286d  adPoolExecutor(m
+00003e90: 6178 5f77 6f72 6b65 7273 3d4e 5f57 4f52  ax_workers=N_WOR
+00003ea0: 4b45 5253 2920 6173 2065 7865 6375 746f  KERS) as executo
+00003eb0: 723a 0020 2020 2020 2020 206c 6f63 6b20  r:.        lock 
+00003ec0: 3d20 7468 7265 6164 696e 672e 4c6f 636b  = threading.Lock
+00003ed0: 2829 0000 2020 2020 2020 2020 4e5f 4348  ()..        N_CH
+00003ee0: 554e 4b53 5f50 4552 5f42 4154 4348 203d  UNKS_PER_BATCH =
+00003ef0: 2069 6e74 286d 702e 6370 755f 636f 756e   int(mp.cpu_coun
+00003f00: 7428 2920 2a20 312e 3529 0000 2020 2020  t() * 1.5)..    
+00003f10: 2020 2020 4e5f 574f 524b 4552 5320 3d20      N_WORKERS = 
+00003f20: 6d61 785f 726f 7773 202f 206d 702e 6370  max_rows / mp.cp
+00003f30: 755f 636f 756e 7428 2900 0020 2020 2020  u_count()..     
+00003f40: 2020 2070 6261 7220 3d20 7471 646d 2864     pbar = tqdm(d
+00003f50: 6573 633d 2250 726f 6365 7373 696e 6720  esc="Processing 
+00003f60: 6f70 696e 696f 6e73 222c 2073 6d6f 6f74  opinions", smoot
+00003f70: 6869 6e67 3d30 2900 0020 2020 2020 2020  hing=0)..       
+00003f80: 2029 0020 2020 2020 2020 2020 2020 2075   ).            u
+00003f90: 7365 636f 6c73 3d75 7365 636f 6c73 2c00  secols=usecols,.
+00003fa0: 2020 2020 2020 2020 2020 2020 7061 7273              pars
+00003fb0: 655f 6461 7465 733d 4e6f 6e65 2c00 2020  e_dates=None,.  
+00003fc0: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
+00003fd0: 6f70 696e 696f 6e5f 6474 7970 6573 2c00  opinion_dtypes,.
+00003fe0: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+00003ff0: 6b73 697a 653d 6d61 785f 726f 7773 2c00  ksize=max_rows,.
+00004000: 6164 0000 eb05 0000 1707 0000 0010 0000  ad..............
+00004010: 4400 0000 0000 0000 ff0f 0000 e40f 0000  D...............
+00004020: bd0f 0000 870f 0000 450f 0000 f10e 0000  ........E.......
+00004030: f00e 0000 d30e 0000 aa0e 0000 8f0e 0000  ................
+00004040: 690e 0000 450e 0000 210e 0000 030e 0000  i...E...!.......
+00004050: de0d 0000 b70d 0000 8f0d 0000 620d 0000  ............b...
+00004060: 3e0d 0000 340d 0000 330d 0000 140d 0000  >...4...3.......
+00004070: ca0c 0000 c00c 0000 bf0c 0000 9a0c 0000  ................
+00004080: 690c 0000 1a0c 0000 c10b 0000 a20b 0000  i...............
+00004090: 570b 0000 4d0b 0000 4c0b 0000 300b 0000  W...M...L...0...
+000040a0: 080b 0000 c10a 0000 c00a 0000 990a 0000  ................
+000040b0: 620a 0000 2f0a 0000 f609 0000 bf09 0000  b.../...........
+000040c0: a809 0000 a709 0000 8b09 0000 6709 0000  ............g...
+000040d0: 4b09 0000 1009 0000 f208 0000 e808 0000  K...............
+000040e0: e708 0000 d508 0000 bb08 0000 8108 0000  ................
+000040f0: 5808 0000 3e08 0000 3d08 0000 2c08 0000  X...>...=...,...
+00004100: 0b08 0000 f907 0000 c207 0000 ab07 0000  ................
+00004110: 9007 0000 7e07 0000 5307 0000 5207 0000  ....~...S...R...
+00004120: 4007 0000 1707 0000 0000 0000 0000 0000  @...............
+00004130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000041a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000041b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000041c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000041d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000041e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000041f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000042a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000042b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000042c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000042d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000042e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000042f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000043a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000043b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000043c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000043d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000043e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000043f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000044a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000044b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000044c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000044d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000044e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000044f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000045a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000045b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000045c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000045d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000045e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000045f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000046a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000046b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000046c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000046d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000046e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000046f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004710: 0000 0000 0000 0020 2020 2064 6566 206f  .......    def o
+00004720: 7069 6e69 6f6e 5f63 6c75 7374 6572 735f  pinion_clusters_
+00004730: 726f 775f 746f 5f6b 7628 726f 7729 3a00  row_to_kv(row):.
+00004740: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00004750: 6400 0020 2020 2020 2020 2020 2020 2020  d..             
+00004760: 2020 2079 6965 6c64 2064 6963 7428 7a69     yield dict(zi
+00004770: 7028 6b65 7973 2c20 726f 7729 2900 2020  p(keys, row)).  
+00004780: 2020 2020 2020 2020 2020 656c 7365 3a00            else:.
+00004790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000047a0: 6b65 7973 203d 2072 6f77 0020 2020 2020  keys = row.     
+000047b0: 2020 2020 2020 2069 6620 6920 3d3d 2030         if i == 0
+000047c0: 3a00 2020 2020 2020 2020 666f 7220 692c  :.        for i,
+000047d0: 2072 6f77 2069 6e20 656e 756d 6572 6174   row in enumerat
+000047e0: 6528 636c 732e 627a 325f 6373 765f 726f  e(cls.bz2_csv_ro
+000047f0: 7773 2866 6e29 293a 0020 2020 2020 2020  ws(fn)):.       
+00004800: 206b 6579 7320 3d20 5b5d 0020 2020 2064   keys = [].    d
+00004810: 6566 2062 7a32 5f63 7376 5f72 6561 6465  ef bz2_csv_reade
+00004820: 7228 636c 732c 2066 6e29 3a00 2020 2020  r(cls, fn):.    
+00004830: 4063 6c61 7373 6d65 7468 6f64 0000 2020  @classmethod..  
+00004840: 2020 2020 2020 2020 2020 2020 2020 7969                yi
+00004850: 656c 6420 726f 7700 2020 2020 2020 2020  eld row.        
+00004860: 2020 2020 666f 7220 726f 7720 696e 2063      for row in c
+00004870: 7376 2e72 6561 6465 7228 627a 6670 293a  sv.reader(bzfp):
+00004880: 0020 2020 2020 2020 2077 6974 6820 627a  .        with bz
+00004890: 322e 6f70 656e 2866 702c 206d 6f64 653d  2.open(fp, mode=
+000048a0: 2272 7422 2c20 6e65 776c 696e 653d 2222  "rt", newline=""
+000048b0: 2920 6173 2062 7a66 703a 0020 2020 2064  ) as bzfp:.    d
+000048c0: 6566 2062 7a32 5f63 7376 5f72 6f77 7328  ef bz2_csv_rows(
+000048d0: 6670 293a 0020 2020 2040 7374 6174 6963  fp):.    @static
+000048e0: 6d65 7468 6f64 0000 2020 2020 2020 2020  method..        
+000048f0: 2900 2020 2020 2020 2020 2020 2020 626c  ).            bl
+00004900: 6f63 6b73 697a 653d 2233 324d 4222 2c00  ocksize="32MB",.
+00004910: 2020 2020 2020 2020 2020 2020 7573 6563              usec
+00004920: 6f6c 733d 5b22 636f 7572 745f 6964 222c  ols=["court_id",
+00004930: 2022 6964 222c 2022 6461 7465 5f74 6572   "id", "date_ter
+00004940: 6d69 6e61 7465 6422 5d2c 0020 2020 2020  minated"],.     
+00004950: 2020 2020 2020 2064 7479 7065 3d6d 795f         dtype=my_
+00004960: 7479 7065 732c 0020 2020 2020 2020 2020  types,.         
+00004970: 2020 2066 6e20 6f72 2073 656c 662e 5f64     fn or self._d
+00004980: 6f63 6b65 7473 5f66 6e2c 0020 2020 2020  ockets_fn,.     
+00004990: 2020 2072 6574 7572 6e20 6464 2e72 6561     return dd.rea
+000049a0: 645f 6373 7628 0000 2020 2020 2020 2020  d_csv(..        
+000049b0: 6c6f 672e 6465 6275 6728 6d73 6729 0020  log.debug(msg). 
+000049c0: 2020 2020 2020 206d 7367 203d 2066 2246         msg = f"F
+000049d0: 696c 6520 5369 7a65 2069 7320 3a20 7b73  ile Size is : {s
+000049e0: 7472 2866 696c 655f 7369 7a65 5f67 6229  tr(file_size_gb)
+000049f0: 7d20 4742 2200 2020 2020 2020 2020 6c6f  } GB".        lo
+00004a00: 672e 6465 6275 6728 6622 496d 706f 7274  g.debug(f"Import
+00004a10: 696e 6720 7b66 6e7d 2061 7320 6120 4461  ing {fn} as a Da
+00004a20: 736b 2044 6174 6166 7261 6d65 2229 0020  sk Dataframe"). 
+00004a30: 2020 2020 2020 2066 696c 655f 7369 7a65         file_size
+00004a40: 5f67 6220 3d20 726f 756e 6428 6669 6c65  _gb = round(file
+00004a50: 5f73 697a 6520 2f20 3130 2a2a 392c 2032  _size / 10**9, 2
+00004a60: 2900 2020 2020 2020 2020 6669 6c65 5f73  ).        file_s
+00004a70: 697a 6520 3d20 6f73 2e70 6174 682e 6765  ize = os.path.ge
+00004a80: 7473 697a 6528 7365 6c66 2e5f 6f70 696e  tsize(self._opin
+00004a90: 696f 6e73 5f66 6e29 0020 2020 2020 2020  ions_fn).       
+00004aa0: 206c 6f67 2e64 6562 7567 2822 696d 706f   log.debug("impo
+00004ab0: 7274 696e 6720 646f 636b 6574 7322 2900  rting dockets").
+00004ac0: 0020 2020 2020 2020 206d 795f 7479 7065  .        my_type
+00004ad0: 7320 3d20 7b22 636f 7572 745f 6964 223a  s = {"court_id":
+00004ae0: 2022 7374 7269 6e67 222c 2022 6461 7465   "string", "date
+00004af0: 5f74 6572 6d69 6e61 7465 6422 3a20 2273  _terminated": "s
+00004b00: 7472 696e 6722 7d00 2020 2020 6465 6620  tring"}.    def 
+00004b10: 696e 6974 5f64 6f63 6b65 7473 5f64 6628  init_dockets_df(
+00004b20: 7365 6c66 2c20 666e 3d4e 6f6e 6529 3a00  self, fn=None):.
+00004b30: 2020 2020 2320 696e 6974 6961 6c69 7a65      # initialize
+00004b40: 2064 6f63 6b65 7473 2064 6600 0020 2020   dockets df..   
+00004b50: 2020 2020 2029 0020 2020 2020 2020 2020       ).         
+00004b60: 2020 2066 6e20 6f72 2073 656c 662e 5f6f     fn or self._o
+00004b70: 7069 6e69 6f6e 5f63 6c75 7374 6572 735f  pinion_clusters_
+00004b80: 666e 2c20 6474 7970 653d 6474 7970 6573  fn, dtype=dtypes
+00004b90: 2c20 7573 6563 6f6c 733d 7573 6563 6f6c  , usecols=usecol
+00004ba0: 7300 2020 2020 2020 2020 7265 7475 726e  s.        return
+00004bb0: 2073 656c 662e 6373 765f 746f 5f64 6628   self.csv_to_df(
+00004bc0: 0020 2020 2020 2020 2064 7479 7065 7320  .        dtypes 
+00004bd0: 3d20 7b22 6a75 6467 6573 223a 2022 7374  = {"judges": "st
+00004be0: 7269 6e67 222c 2022 6361 7365 5f6e 616d  ring", "case_nam
+00004bf0: 6522 3a20 2273 7472 696e 6722 2c20 2263  e": "string", "c
+00004c00: 6173 655f 6e61 6d65 5f66 756c 6c22 3a20  ase_name_full": 
+00004c10: 2273 7472 696e 6722 7d00 2020 2020 2020  "string"}.      
+00004c20: 2020 7573 6563 6f6c 7320 3d20 5b22 6964    usecols = ["id
+00004c30: 222c 2022 6a75 6467 6573 222c 2022 646f  ", "judges", "do
+00004c40: 636b 6574 5f69 6422 2c20 2263 6173 655f  cket_id", "case_
+00004c50: 6e61 6d65 222c 2022 6361 7365 5f6e 616d  name", "case_nam
+00004c60: 655f 6675 6c6c 225d 0020 2020 2064 6566  e_full"].    def
+00004c70: 2069 6e69 745f 6f70 696e 696f 6e5f 636c   init_opinion_cl
+00004c80: 7573 7465 7273 5f64 6628 7365 6c66 2c20  usters_df(self, 
+00004c90: 666e 3d4e 6f6e 6529 3a00 2020 2020 2320  fn=None):.    # 
+00004ca0: 696e 6974 6961 6c69 7a65 206f 7069 6e69  initialize opini
+00004cb0: 6f6e 2063 6c75 7374 6572 7320 6466 0000  on clusters df..
+00004cc0: 2020 2020 2020 2020 2900 2020 2020 2020          ).      
+00004cd0: 2020 2020 2020 666e 206f 7220 7365 6c66        fn or self
+00004ce0: 2e5f 6f70 696e 696f 6e73 5f66 6e2c 2064  ._opinions_fn, d
+00004cf0: 7479 7065 3d6f 7069 6e69 6f6e 5f64 7479  type=opinion_dty
+00004d00: 7065 732c 2069 6e64 6578 5f63 6f6c 3d22  pes, index_col="
+00004d10: 6964 2200 2020 2020 2020 2020 7265 7475  id".        retu
+00004d20: 726e 2073 656c 662e 6373 765f 746f 5f64  rn self.csv_to_d
+00004d30: 6628 0000 2020 2020 2020 2020 7d00 2020  f(..        }.  
+00004d40: 2020 2020 2020 2020 2020 226c 6f63 616c            "local
+00004d50: 5f70 6174 6822 3a20 2273 7472 696e 6722  _path": "string"
+00004d60: 2c00 2020 2020 2020 2020 2020 2020 2268  ,.            "h
+00004d70: 746d 6c5f 7769 7468 5f63 6974 6174 696f  tml_with_citatio
+00004d80: 6e73 223a 2022 7374 7269 6e67 222c 0020  ns": "string",. 
+00004d90: 2020 2020 2020 2020 2020 2022 6874 6d6c             "html
+00004da0: 5f61 6e6f 6e5f 3230 3230 223a 2022 7374  _anon_2020": "st
+00004db0: 7269 6e67 222c 0020 2020 2020 2020 2020  ring",.         
+00004dc0: 2020 2022 6874 6d6c 5f63 6f6c 756d 6269     "html_columbi
+00004dd0: 6122 3a20 2273 7472 696e 6722 2c00 2020  a": "string",.  
+00004de0: 2020 2020 2020 2020 2020 2268 746d 6c5f            "html_
+00004df0: 6c61 7762 6f78 223a 2022 7374 7269 6e67  lawbox": "string
+00004e00: 222c 0020 2020 2020 2020 2020 2020 2022  ",.            "
+00004e10: 6874 6d6c 223a 2022 7374 7269 6e67 222c  html": "string",
+00004e20: 0020 2020 2020 2020 2020 2020 2022 706c  .            "pl
+00004e30: 6169 6e5f 7465 7874 223a 2022 7374 7269  ain_text": "stri
+00004e40: 6e67 222c 0020 2020 2020 2020 2020 2020  ng",.           
+00004e50: 2022 6c6f 6361 6c5f 7061 7468 223a 2022   "local_path": "
+00004e60: 7374 7269 6e67 222c 0020 2020 2020 2020  string",.       
+00004e70: 2020 2020 2022 646f 776e 6c6f 6164 5f75       "download_u
+00004e80: 726c 223a 2022 7374 7269 6e67 222c 0020  rl": "string",. 
+00004e90: 2020 2020 2020 206f 7069 6e69 6f6e 5f64         opinion_d
+00004ea0: 7479 7065 7320 3d20 7b00 2020 2020 6465  types = {.    de
+00004eb0: 6620 696e 6974 5f6f 7069 6e69 6f6e 735f  f init_opinions_
+00004ec0: 6466 2873 656c 662c 2066 6e3d 4e6f 6e65  df(self, fn=None
+00004ed0: 293a 0020 2020 2023 2069 6e69 7469 616c  ):.    # initial
+00004ee0: 697a 6520 6f70 696e 696f 6e73 2064 6600  ize opinions df.
+00004ef0: 0020 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00004f00: 7365 6c66 2e63 7376 5f74 6f5f 6466 2866  self.csv_to_df(f
+00004f10: 6e20 6f72 2073 656c 662e 5f63 6f75 7274  n or self._court
+00004f20: 735f 666e 2c20 6474 7970 653d 6474 7970  s_fn, dtype=dtyp
+00004f30: 6573 2c20 7573 6563 6f6c 733d 7573 6563  es, usecols=usec
+00004f40: 6f6c 7329 0020 2020 2020 2020 2064 7479  ols).        dty
+00004f50: 7065 7320 3d20 7b22 6675 6c6c 6e61 6d65  pes = {"fullname
+00004f60: 223a 2022 7374 7269 6e67 222c 2022 6a75  ": "string", "ju
+00004f70: 7269 7364 6963 7469 6f6e 223a 2022 7374  risdiction": "st
+00004f80: 7269 6e67 227d 0020 2020 2020 2020 2075  ring"}.        u
+00004f90: 7365 636f 6c73 203d 205b 2269 6422 2c20  secols = ["id", 
+00004fa0: 2266 756c 6c5f 6e61 6d65 222c 2022 6a75  "full_name", "ju
+00004fb0: 7269 7364 6963 7469 6f6e 225d 0020 2020  risdiction"].   
+00004fc0: 2064 6566 2069 6e69 745f 636f 7572 7473   def init_courts
+00004fd0: 5f64 6628 7365 6c66 2c20 666e 3d4e 6f6e  _df(self, fn=Non
+00004fe0: 6529 3a00 2020 2020 2320 696e 6974 6961  e):.    # initia
+00004ff0: 6c69 7a65 2063 6f75 7274 7320 6466 0000  lize courts df..
+00005000: 6164 0000 520b 0000 fe0b 0000 0010 0000  ad..R...........
+00005010: 2400 0000 0000 0000 b40f 0000 a20f 0000  $...............
+00005020: a10f 0000 880f 0000 660f 0000 4a0f 0000  ........f...J...
+00005030: 490f 0000 170f 0000 ec0e 0000 eb0e 0000  I...............
+00005040: ba0e 0000 910e 0000 7f0e 0000 5c0e 0000  ............\...
+00005050: 3f0e 0000 1a0e 0000 f30d 0000 cf0d 0000  ?...............
+00005060: a70d 0000 a60d 0000 860d 0000 700d 0000  ............p...
+00005070: 4e0d 0000 380d 0000 150d 0000 fe0c 0000  N...8...........
+00005080: db0c 0000 c40c 0000 a20c 0000 8c0c 0000  ................
+00005090: 690c 0000 520c 0000 3e0c 0000 3d0c 0000  i...R...>...=...
+000050a0: 060c 0000 fe0b 0000 f90b 0000 f80b 0000  ................
+000050b0: bc0b 0000 a80b 0000 880b 0000 370b 0000  ............7...
+000050c0: 230b 0000 040b 0000 b20a 0000 470a 0000  #...........G...
+000050d0: 050a 0000 b109 0000 b009 0000 9309 0000  ................
+000050e0: 6a09 0000 4f09 0000 2909 0000 0509 0000  j...O...).......
+000050f0: e108 0000 c308 0000 9e08 0000 7708 0000  ............w...
+00005100: 4f08 0000 2208 0000 fe07 0000 f407 0000  O..."...........
+00005110: f307 0000 d407 0000 8a07 0000 8007 0000  ................
+00005120: 7f07 0000 5a07 0000 2907 0000 da06 0000  ....Z...).......
+00005130: 8106 0000 6206 0000 1706 0000 0d06 0000  ....b...........
+00005140: 0c06 0000 f005 0000 c805 0000 8105 0000  ................
+00005150: 8005 0000 5905 0000 2205 0000 ef04 0000  ....Y...".......
+00005160: b604 0000 7f04 0000 6804 0000 6704 0000  ........h...g...
+00005170: 4b04 0000 2704 0000 0b04 0000 d003 0000  K...'...........
+00005180: b203 0000 a803 0000 a703 0000 9503 0000  ................
+00005190: 7b03 0000 4103 0000 1803 0000 fe02 0000  {...A...........
+000051a0: fd02 0000 ec02 0000 cb02 0000 b902 0000  ................
+000051b0: 8202 0000 6b02 0000 5002 0000 3e02 0000  ....k...P...>...
+000051c0: 1302 0000 1202 0000 0002 0000 d701 0000  ................
+000051d0: 0000 0000 0000 0020 2020 2064 6566 206f  .......    def o
+000051e0: 7069 6e69 6f6e 5f63 6c75 7374 6572 735f  pinion_clusters_
+000051f0: 726f 775f 746f 5f6b 7628 726f 7729 3a00  row_to_kv(row):.
+00005200: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00005210: 6400 0020 2020 2020 2020 2020 2020 2020  d..             
+00005220: 2020 2079 6965 6c64 2064 6963 7428 7a69     yield dict(zi
+00005230: 7028 6b65 7973 2c20 726f 7729 2900 2020  p(keys, row)).  
+00005240: 2020 2020 2020 2020 2020 656c 7365 3a00            else:.
+00005250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005260: 6b65 7973 203d 2072 6f77 0020 2020 2020  keys = row.     
+00005270: 2020 2020 2020 2069 6620 6920 3d3d 2030         if i == 0
+00005280: 3a00 2020 2020 2020 2020 666f 7220 692c  :.        for i,
+00005290: 2072 6f77 2069 6e20 656e 756d 6572 6174   row in enumerat
+000052a0: 6528 636c 732e 627a 325f 6373 765f 726f  e(cls.bz2_csv_ro
+000052b0: 7773 2866 6e29 293a 0020 2020 2020 2020  ws(fn)):.       
+000052c0: 206b 6579 7320 3d20 5b5d 0020 2020 2064   keys = [].    d
+000052d0: 6566 2062 7a32 5f63 7376 5f72 6561 6465  ef bz2_csv_reade
+000052e0: 7228 636c 732c 2066 6e29 3a00 2020 2020  r(cls, fn):.    
+000052f0: 4063 6c61 7373 6d65 7468 6f64 0000 2020  @classmethod..  
+00005300: 2020 2020 2020 2020 2020 2020 2020 7969                yi
+00005310: 656c 6420 726f 7700 2020 2020 2020 2020  eld row.        
+00005320: 2020 2020 666f 7220 726f 7720 696e 2063      for row in c
+00005330: 7376 2e72 6561 6465 7228 627a 6670 293a  sv.reader(bzfp):
+00005340: 0020 2020 2020 2020 2077 6974 6820 627a  .        with bz
+00005350: 322e 6f70 656e 2866 702c 206d 6f64 653d  2.open(fp, mode=
+00005360: 2272 7422 2c20 6e65 776c 696e 653d 2222  "rt", newline=""
+00005370: 2920 6173 2062 7a66 703a 0020 2020 2064  ) as bzfp:.    d
+00005380: 6566 2062 7a32 5f63 7376 5f72 6f77 7328  ef bz2_csv_rows(
+00005390: 6670 293a 0020 2020 2040 7374 6174 6963  fp):.    @static
+000053a0: 6d65 7468 6f64 0000 2020 2020 2020 2020  method..        
+000053b0: 2900 2020 2020 2020 2020 2020 2020 626c  ).            bl
+000053c0: 6f63 6b73 697a 653d 2233 324d 4222 2c00  ocksize="32MB",.
+000053d0: 2020 2020 2020 2020 2020 2020 7573 6563              usec
+000053e0: 6f6c 733d 5b22 636f 7572 745f 6964 222c  ols=["court_id",
+000053f0: 2022 6964 222c 2022 6461 7465 5f74 6572   "id", "date_ter
+00005400: 6d69 6e61 7465 6422 5d2c 0020 2020 2020  minated"],.     
+00005410: 2020 2020 2020 2064 7479 7065 3d6d 795f         dtype=my_
+00005420: 7479 7065 732c 0020 2020 2020 2020 2020  types,.         
+00005430: 2020 2066 6e20 6f72 2073 656c 662e 5f64     fn or self._d
+00005440: 6f63 6b65 7473 5f66 6e2c 0020 2020 2020  ockets_fn,.     
+00005450: 2020 2072 6574 7572 6e20 6464 2e72 6561     return dd.rea
+00005460: 645f 6373 7628 0000 2020 2020 2020 2020  d_csv(..        
+00005470: 6c6f 672e 6465 6275 6728 6d73 6729 0020  log.debug(msg). 
+00005480: 2020 2020 2020 206d 7367 203d 2066 2246         msg = f"F
+00005490: 696c 6520 5369 7a65 2069 7320 3a20 7b73  ile Size is : {s
+000054a0: 7472 2866 696c 655f 7369 7a65 5f67 6229  tr(file_size_gb)
+000054b0: 7d20 4742 2200 2020 2020 2020 2020 6c6f  } GB".        lo
+000054c0: 672e 6465 6275 6728 6622 496d 706f 7274  g.debug(f"Import
+000054d0: 696e 6720 7b66 6e7d 2061 7320 6120 4461  ing {fn} as a Da
+000054e0: 736b 2044 6174 6166 7261 6d65 2229 0020  sk Dataframe"). 
+000054f0: 2020 2020 2020 2066 696c 655f 7369 7a65         file_size
+00005500: 5f67 6220 3d20 726f 756e 6428 6669 6c65  _gb = round(file
+00005510: 5f73 697a 6520 2f20 3130 2a2a 392c 2032  _size / 10**9, 2
+00005520: 2900 2020 2020 2020 2020 6669 6c65 5f73  ).        file_s
+00005530: 697a 6520 3d20 6f73 2e70 6174 682e 6765  ize = os.path.ge
+00005540: 7473 697a 6528 7365 6c66 2e5f 6f70 696e  tsize(self._opin
+00005550: 696f 6e73 5f66 6e29 0020 2020 2020 2020  ions_fn).       
+00005560: 206c 6f67 2e64 6562 7567 2822 696d 706f   log.debug("impo
+00005570: 7274 696e 6720 646f 636b 6574 7322 2900  rting dockets").
+00005580: 0020 2020 2020 2020 206d 795f 7479 7065  .        my_type
+00005590: 7320 3d20 7b22 636f 7572 745f 6964 223a  s = {"court_id":
+000055a0: 2022 7374 7269 6e67 222c 2022 6461 7465   "string", "date
+000055b0: 5f74 6572 6d69 6e61 7465 6422 3a20 2273  _terminated": "s
+000055c0: 7472 696e 6722 7d00 2020 2020 6465 6620  tring"}.    def 
+000055d0: 696e 6974 5f64 6f63 6b65 7473 5f64 6628  init_dockets_df(
+000055e0: 7365 6c66 2c20 666e 3d4e 6f6e 6529 3a00  self, fn=None):.
+000055f0: 2020 2020 2320 696e 6974 6961 6c69 7a65      # initialize
+00005600: 2064 6f63 6b65 7473 2064 6600 0020 2020   dockets df..   
+00005610: 2020 2020 2029 0020 2020 2020 2020 2020       ).         
+00005620: 2020 2066 6e20 6f72 2073 656c 662e 5f6f     fn or self._o
+00005630: 7069 6e69 6f6e 5f63 6c75 7374 6572 735f  pinion_clusters_
+00005640: 666e 2c20 6474 7970 653d 6474 7970 6573  fn, dtype=dtypes
+00005650: 2c20 7573 6563 6f6c 733d 7573 6563 6f6c  , usecols=usecol
+00005660: 7300 2020 2020 2020 2020 7265 7475 726e  s.        return
+00005670: 2073 656c 662e 6373 765f 746f 5f64 6628   self.csv_to_df(
+00005680: 0020 2020 2020 2020 2064 7479 7065 7320  .        dtypes 
+00005690: 3d20 7b22 6a75 6467 6573 223a 2022 7374  = {"judges": "st
+000056a0: 7269 6e67 222c 2022 6361 7365 5f6e 616d  ring", "case_nam
+000056b0: 6522 3a20 2273 7472 696e 6722 2c20 2263  e": "string", "c
+000056c0: 6173 655f 6e61 6d65 5f66 756c 6c22 3a20  ase_name_full": 
+000056d0: 2273 7472 696e 6722 7d00 2020 2020 2020  "string"}.      
+000056e0: 2020 7573 6563 6f6c 7320 3d20 5b22 6964    usecols = ["id
+000056f0: 222c 2022 6a75 6467 6573 222c 2022 646f  ", "judges", "do
+00005700: 636b 6574 5f69 6422 2c20 2263 6173 655f  cket_id", "case_
+00005710: 6e61 6d65 222c 2022 6361 7365 5f6e 616d  name", "case_nam
+00005720: 655f 6675 6c6c 225d 0020 2020 2064 6566  e_full"].    def
+00005730: 2069 6e69 745f 6f70 696e 696f 6e5f 636c   init_opinion_cl
+00005740: 7573 7465 7273 5f64 6628 7365 6c66 2c20  usters_df(self, 
+00005750: 666e 3d4e 6f6e 6529 3a00 2020 2020 2320  fn=None):.    # 
+00005760: 696e 6974 6961 6c69 7a65 206f 7069 6e69  initialize opini
+00005770: 6f6e 2063 6c75 7374 6572 7320 6466 0000  on clusters df..
+00005780: 2020 2020 2020 2020 2900 2020 2020 2020          ).      
+00005790: 2020 2020 2020 666e 206f 7220 7365 6c66        fn or self
+000057a0: 2e5f 6f70 696e 696f 6e73 5f66 6e2c 2064  ._opinions_fn, d
+000057b0: 7479 7065 3d6f 7069 6e69 6f6e 5f64 7479  type=opinion_dty
+000057c0: 7065 732c 2069 6e64 6578 5f63 6f6c 3d22  pes, index_col="
+000057d0: 6964 2200 2020 2020 2020 2020 7265 7475  id".        retu
+000057e0: 726e 2073 656c 662e 6373 765f 746f 5f64  rn self.csv_to_d
+000057f0: 6628 0000 2020 2020 2020 2020 7d00 2020  f(..        }.  
+00005800: 2020 2020 2020 2020 2020 226c 6f63 616c            "local
+00005810: 5f70 6174 6822 3a20 2273 7472 696e 6722  _path": "string"
+00005820: 2c00 2020 2020 2020 2020 2020 2020 2268  ,.            "h
+00005830: 746d 6c5f 7769 7468 5f63 6974 6174 696f  tml_with_citatio
+00005840: 6e73 223a 2022 7374 7269 6e67 222c 0020  ns": "string",. 
+00005850: 2020 2020 2020 2020 2020 2022 6874 6d6c             "html
+00005860: 5f61 6e6f 6e5f 3230 3230 223a 2022 7374  _anon_2020": "st
+00005870: 7269 6e67 222c 0020 2020 2020 2020 2020  ring",.         
+00005880: 2020 2022 6874 6d6c 5f63 6f6c 756d 6269     "html_columbi
+00005890: 6122 3a20 2273 7472 696e 6722 2c00 2020  a": "string",.  
+000058a0: 2020 2020 2020 2020 2020 2268 746d 6c5f            "html_
+000058b0: 6c61 7762 6f78 223a 2022 7374 7269 6e67  lawbox": "string
+000058c0: 222c 0020 2020 2020 2020 2020 2020 2022  ",.            "
+000058d0: 6874 6d6c 223a 2022 7374 7269 6e67 222c  html": "string",
+000058e0: 0020 2020 2020 2020 2020 2020 2022 706c  .            "pl
+000058f0: 6169 6e5f 7465 7874 223a 2022 7374 7269  ain_text": "stri
+00005900: 6e67 222c 0020 2020 2020 2020 2020 2020  ng",.           
+00005910: 2022 6c6f 6361 6c5f 7061 7468 223a 2022   "local_path": "
+00005920: 7374 7269 6e67 222c 0020 2020 2020 2020  string",.       
+00005930: 2020 2020 2022 646f 776e 6c6f 6164 5f75       "download_u
+00005940: 726c 223a 2022 7374 7269 6e67 222c 0020  rl": "string",. 
+00005950: 2020 2020 2020 206f 7069 6e69 6f6e 5f64         opinion_d
+00005960: 7479 7065 7320 3d20 7b00 2020 2020 6465  types = {.    de
+00005970: 6620 696e 6974 5f6f 7069 6e69 6f6e 735f  f init_opinions_
+00005980: 6466 2873 656c 662c 2066 6e3d 4e6f 6e65  df(self, fn=None
+00005990: 293a 0020 2020 2023 2069 6e69 7469 616c  ):.    # initial
+000059a0: 697a 6520 6f70 696e 696f 6e73 2064 6600  ize opinions df.
+000059b0: 0020 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000059c0: 7365 6c66 2e63 7376 5f74 6f5f 6466 2866  self.csv_to_df(f
+000059d0: 6e20 6f72 2073 656c 662e 5f63 6f75 7274  n or self._court
+000059e0: 735f 666e 2c20 6474 7970 653d 6474 7970  s_fn, dtype=dtyp
+000059f0: 6573 2c20 7573 6563 6f6c 733d 7573 6563  es, usecols=usec
+00005a00: 6f6c 7329 0020 2020 2020 2020 2064 7479  ols).        dty
+00005a10: 7065 7320 3d20 7b22 6675 6c6c 6e61 6d65  pes = {"fullname
+00005a20: 223a 2022 7374 7269 6e67 222c 2022 6a75  ": "string", "ju
+00005a30: 7269 7364 6963 7469 6f6e 223a 2022 7374  risdiction": "st
+00005a40: 7269 6e67 227d 0020 2020 2020 2020 2075  ring"}.        u
+00005a50: 7365 636f 6c73 203d 205b 2269 6422 2c20  secols = ["id", 
+00005a60: 2266 756c 6c5f 6e61 6d65 222c 2022 6a75  "full_name", "ju
+00005a70: 7269 7364 6963 7469 6f6e 225d 0020 2020  risdiction"].   
+00005a80: 2020 2020 2020 2000 2020 2023 6465 6620         .   #def 
+00005a90: 6765 745f 6369 7461 7469 6f6e 7328 7365  get_citations(se
+00005aa0: 6c66 2c20 6f70 696e 696f 6e5f 6964 2c20  lf, opinion_id, 
+00005ab0: 6466 2020 2020 2020 2000 2020 2023 6465  df       .   #de
+00005ac0: 6620 6765 745f 6369 7461 7469 6f6e 7328  f get_citations(
+00005ad0: 7365 6c66 2c20 6f70 696e 696f 6e5f 6964  self, opinion_id
+00005ae0: 2c20 6466 5f63 6974 6174 696f 6e73 293a  , df_citations):
+00005af0: 0000 2020 2020 2020 2020 7265 7475 726e  ..        return
+00005b00: 207b 2263 2020 2020 2020 2000 2020 2023   {"c       .   #
+00005b10: 6465 6620 6765 745f 6369 7461 7469 6f6e  def get_citation
+00005b20: 7328 7320 2020 2020 2020 0020 2020 2364  s(s       .   #d
+00005b30: 6566 2067 6574 5f20 2020 2020 2020 0020  ef get_       . 
+00005b40: 2020 2364 6566 2067 6574 5f63 6974 6174    #def get_citat
+00005b50: 696f 6e73 2873 656c 662c 206f 7069 6e69  ions(self, opini
+00005b60: 6f6e 5f69 642c 2064 665f 6369 7461 7469  on_id, df_citati
+00005b70: 6f6e 7329 3a00 0020 2020 2020 2020 2072  ons):..        r
+00005b80: 6574 7572 6e20 7b22 2020 2020 2020 2000  eturn {"       .
+00005b90: 2020 2023 6465 6620 6765 745f 6369 7461     #def get_cita
+00005ba0: 7469 6f6e 7328 7365 2020 2020 2020 2000  tions(se       .
+00005bb0: 2020 2023 6465 6620 6765 745f 2020 2020     #def get_    
+00005bc0: 2020 2000 2020 2023 6465 6620 6765 745f     .   #def get_
+00005bd0: 6369 7461 7469 6f6e 7328 7365 6c66 2c20  citations(self, 
+00005be0: 6f70 696e 696f 6e5f 6964 2c20 6466 5f63  opinion_id, df_c
+00005bf0: 6974 6174 696f 6e73 2020 2020 2020 2020  itations        
+00005c00: 2020 2020 2000 2020 2023 6465 6620 6765       .   #def ge
+00005c10: 745f 6369 7461 7469 6f6e 7328 7365 6c66  t_citations(self
+00005c20: 2c20 6f70 696e 696f 6e5f 6964 2c20 6466  , opinion_id, df
+00005c30: 5f63 6974 6174 696f 6e73 293a 0000 2020  _citations):..  
+00005c40: 2020 2020 2020 7265 7475 726e 2074 6578        return tex
+00005c50: 7400 2020 2020 2020 2020 2020 2020 7465  t.            te
+00005c60: 7874 203d 2068 6c61 0020 2020 2020 2020  xt = hla.       
+00005c70: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00005c80: 2868 6c61 2c20 7374 7229 3a00 2020 2020  (hla, str):.    
+00005c90: 2020 2020 2020 2020 7465 7874 203d 2078          text = x
+00005ca0: 6800 2020 2020 2020 2020 656c 6966 2069  h.        elif i
+00005cb0: 7369 6e73 7461 6e63 6528 7868 2c20 7374  sinstance(xh, st
+00005cc0: 7229 3a00 2020 2020 2020 2020 2020 2020  r):.            
+00005cd0: 7465 7874 203d 2068 6c63 0020 2020 2020  text = hlc.     
+00005ce0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+00005cf0: 6365 2868 6c63 2c20 7374 7229 3a00 2020  ce(hlc, str):.  
+00005d00: 2020 2020 2020 2020 2020 7465 7874 203d            text =
+00005d10: 2068 6c62 0020 2020 2020 2020 2065 6c69   hlb.        eli
+00005d20: 6620 6973 696e 7374 616e 6365 2868 6c62  f isinstance(hlb
+00005d30: 2c20 7374 7229 3a00 2020 2020 2020 2020  , str):.        
+00005d40: 2020 2020 7465 7874 203d 2068 6c00 2020      text = hl.  
+00005d50: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00005d60: 7461 6e63 6528 686c 2c20 7374 7229 3a00  tance(hl, str):.
+00005d70: 2020 2020 2020 2020 2020 2020 7465 7874              text
+00005d80: 203d 2070 7400 2020 2020 2020 2020 6966   = pt.        if
+00005d90: 2069 7369 6e73 7461 6e63 6528 7074 2c20   isinstance(pt, 
+00005da0: 7374 7229 3a00 0020 2020 2020 2020 2068  str):..        h
+00005db0: 6c61 203d 206f 7069 6e69 6f6e 5b22 6874  la = opinion["ht
+00005dc0: 6d6c 5f61 6e6f 6e5f 3230 3230 225d 0020  ml_anon_2020"]. 
+00005dd0: 2020 2020 2020 2078 6820 3d20 6f70 696e         xh = opin
+00005de0: 696f 6e5b 2278 6d6c 5f68 6172 7661 7264  ion["xml_harvard
+00005df0: 225d 0020 2020 2020 2020 2068 6c63 203d  "].        hlc =
+00005e00: 206f 7069 6e69 6f6e 5b22 6874 6d6c 5f63   opinion["html_c
+00005e10: 6f6c 756d 6269 6122 5d00 2020 2020 2020  olumbia"].      
+00005e20: 2020 686c 6220 3d20 6f70 696e 696f 6e5b    hlb = opinion[
+00005e30: 2268 746d 6c5f 6c61 7762 6f78 225d 0020  "html_lawbox"]. 
+00005e40: 2020 2020 2020 2068 6c20 3d20 6f70 696e         hl = opin
+00005e50: 696f 6e5b 2268 746d 6c22 5d00 2020 2020  ion["html"].    
+00005e60: 2020 2020 7074 203d 206f 7069 6e69 6f6e      pt = opinion
+00005e70: 5b22 706c 6169 6e5f 7465 7874 225d 0020  ["plain_text"]. 
+00005e80: 2020 2020 2020 2074 6578 7420 3d20 2222         text = ""
+00005e90: 0020 2020 2064 6566 2067 6574 5f6f 7069  .    def get_opi
+00005ea0: 6e69 6f6e 5f74 6578 7428 7365 6c66 2c20  nion_text(self, 
+00005eb0: 6f70 696e 696f 6e29 3a00 2020 2020 2320  opinion):.    # 
+00005ec0: 6163 6365 7074 7320 6120 7365 7269 6573  accepts a series
+00005ed0: 202d 2d20 6120 726f 7720 6672 6f6d 2061   -- a row from a
+00005ee0: 2064 6174 6166 7261 6d65 0000 2020 2020   dataframe..    
+00005ef0: 2020 2020 7265 7475 726e 2064 662e 6c6f      return df.lo
+00005f00: 635b 6466 5b63 6f6c 756d 6e5d 203d 3d20  c[df[column] == 
+00005f10: 6d61 7463 685d 0020 2020 2064 6566 2064  match].    def d
+00005f20: 665f 726f 775f 6279 5f76 616c 7565 2873  f_row_by_value(s
+00005f30: 656c 662c 2064 662c 2063 6f6c 756d 6e2c  elf, df, column,
+00005f40: 206d 6174 6368 293a 0000 2020 2020 2020   match):..      
+00005f50: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
+00005f60: 6c69 656e 7400 2020 2020 6465 6620 6765  lient.    def ge
+00005f70: 745f 636c 7573 7465 725f 636c 6965 6e74  t_cluster_client
+00005f80: 2873 656c 6629 3a00 2020 2020 2320 6765  (self):.    # ge
+00005f90: 7420 636c 7573 7465 7220 636c 6965 6e74  t cluster client
+00005fa0: 0000 2020 2020 2020 2020 7265 7475 726e  ..        return
+00005fb0: 2064 6600 2020 2020 2020 2020 6c6f 672e   df.        log.
+00005fc0: 6465 6275 6728 6622 7b66 696c 656e 616d  debug(f"{filenam
+00005fd0: 657d 2072 6561 6420 696e 207b 7374 7228  e} read in {str(
+00005fe0: 696e 7428 2865 6e64 2d73 7461 7274 292f  int((end-start)/
+00005ff0: 3630 2929 7d20 6d69 6e75 7465 7322 2900  60))} minutes").
+00006000: 6164 0000 9906 0000 7507 0000 0010 0000  ad......u.......
+00006010: 3000 0000 0000 0000 ab0f 0000 750f 0000  0...........u...
+00006020: 740f 0000 620f 0000 430f 0000 120f 0000  t...b...C.......
+00006030: dc0e 0000 db0e 0000 c90e 0000 a60e 0000  ................
+00006040: 530e 0000 520e 0000 010e 0000 b30d 0000  S...R...........
+00006050: 5e0d 0000 380d 0000 1e0d 0000 f60c 0000  ^...8...........
+00006060: d60c 0000 be0c 0000 900c 0000 8f0c 0000  ................
+00006070: 4c0c 0000 260c 0000 d50b 0000 a70b 0000  L...&...........
+00006080: a60b 0000 5a0b 0000 340b 0000 110b 0000  ....Z...4.......
+00006090: c90a 0000 bb0a 0000 8d0a 0000 8c0a 0000  ................
+000060a0: 6b0a 0000 420a 0000 0b0a 0000 0a0a 0000  k...B...........
+000060b0: df09 0000 bb09 0000 7f09 0000 4309 0000  ............C...
+000060c0: e508 0000 ca08 0000 af08 0000 3608 0000  ............6...
+000060d0: bd07 0000 7507 0000 7407 0000 7207 0000  ....u...t...r...
+000060e0: 2809 0000 0809 0000 0709 0000 e008 0000  (...............
+000060f0: b708 0000 b608 0000 9708 0000 8a08 0000  ................
+00006100: 8908 0000 5a08 0000 3608 0000 0908 0000  ....Z...6.......
+00006110: f407 0000 d407 0000 d307 0000 ac07 0000  ................
+00006120: 8c07 0000 6007 0000 4007 0000 1307 0000  ....`...@.......
+00006130: f106 0000 c506 0000 a106 0000 7906 0000  ............y...
+00006140: 5f06 0000 2806 0000 2706 0000 1006 0000  _...(...'.......
+00006150: e805 0000 9005 0000 6505 0000 2b05 0000  ........e...+...
+00006160: 2a05 0000 0905 0000 eb04 0000 bf04 0000  *...............
+00006170: 8004 0000 5804 0000 5704 0000 3c04 0000  ....X...W...<...
+00006180: 1204 0000 d203 0000 d103 0000 bf03 0000  ................
+00006190: 9a03 0000 7203 0000 0503 0000 af02 0000  ....r...........
+000061a0: ae02 0000 9802 0000 5e02 0000 3802 0000  ........^...8...
+000061b0: 1302 0000 ed01 0000 ec01 0000 cb01 0000  ................
+000061c0: 0000 0000 0000 0000 0000 0020 2020 2020  ...........     
+000061d0: 2020 2023 2064 6f63 6b65 745f 6f62 6a20     # docket_obj 
+000061e0: 3d20 6c69 7374 286d 6170 2800 0020 2020  = list(map(..   
+000061f0: 2020 2020 2023 2069 6d70 6f72 7420 7064       # import pd
+00006200: 623b 2070 6462 2e73 6574 5f74 7261 6365  b; pdb.set_trace
+00006210: 2829 0020 2020 2020 2020 2023 2064 622e  ().        # db.
+00006220: 6d61 7028 7072 696e 742c 2062 292e 636f  map(print, b).co
+00006230: 6d70 7574 6528 2900 2020 2020 2020 2020  mpute().        
+00006240: 2320 2c20 6261 675f 636c 7573 7465 7273  # , bag_clusters
+00006250: 2c20 6261 675f 646f 636b 6574 7300 2020  , bag_dockets.  
+00006260: 2020 2020 2020 6c6f 672e 6465 6275 6728        log.debug(
+00006270: 2272 756e 6e69 6e67 206d 6170 2870 726f  "running map(pro
+00006280: 6365 7373 5f72 6f77 2920 696e 2070 6172  cess_row) in par
+00006290: 616c 6c65 6c22 2900 2020 2020 2020 2020  allel").        
+000062a0: 2320 7072 6f63 6573 7320 726f 7700 0020  # process row.. 
+000062b0: 2020 2020 2020 2064 6f63 6b65 745f 726f         docket_ro
+000062c0: 7773 203d 206c 6973 7428 6d61 7028 6c61  ws = list(map(la
+000062d0: 6d62 6461 2078 3a20 646f 636b 6574 735b  mbda x: dockets[
+000062e0: 696e 7428 785b 2264 6f63 6b65 745f 6964  int(x["docket_id
+000062f0: 225d 295d 2c20 636c 7573 7465 725f 726f  "])], cluster_ro
+00006300: 7773 2929 0020 2020 2020 2020 2023 2067  ws)).        # g
+00006310: 6574 2074 6865 2064 6f63 656b 745f 6964  et the docekt_id
+00006320: 2061 7320 616e 2069 6e74 2066 726f 6d20   as an int from 
+00006330: 6561 6368 2063 6c75 7374 6572 5f72 6f77  each cluster_row
+00006340: 2069 6e20 6f72 6465 7264 2061 7320 6120   in orderd as a 
+00006350: 6b65 7920 746f 2068 6173 6820 696e 746f  key to hash into
+00006360: 2074 6865 2064 6f63 6b65 7473 2064 6963   the dockets dic
+00006370: 7400 2020 2020 2020 2020 646f 636b 6574  t.        docket
+00006380: 7320 3d20 7365 6c66 2e67 6574 5f64 6f63  s = self.get_doc
+00006390: 6b65 7473 5f64 6628 2900 2020 2020 2020  kets_df().      
+000063a0: 2020 6c6f 672e 6465 6275 6728 2267 6574    log.debug("get
+000063b0: 7469 6e67 2064 6f63 6b65 7473 2229 0020  ting dockets"). 
+000063c0: 2020 2020 2020 2023 2064 6f63 6b65 7473         # dockets
+000063d0: 0000 2020 2020 2020 2020 636c 7573 7465  ..        cluste
+000063e0: 725f 726f 7773 203d 206c 6973 7428 6d61  r_rows = list(ma
+000063f0: 7028 7365 6c66 2e67 6574 5f63 6c75 7374  p(self.get_clust
+00006400: 6572 5f72 6f77 2c20 6466 5f64 6963 7429  er_row, df_dict)
+00006410: 2900 2020 2020 2020 2020 6c6f 672e 6465  ).        log.de
+00006420: 6275 6728 2267 6574 7469 6e67 2063 6c75  bug("getting clu
+00006430: 7374 6572 2072 6f77 7322 2900 2020 2020  ster rows").    
+00006440: 2020 2020 2320 6765 7420 636c 7573 7465      # get cluste
+00006450: 7220 726f 7773 0000 2020 2020 2020 2020  r rows..        
+00006460: 6466 5f64 6963 7420 3d20 6466 2e74 6f5f  df_dict = df.to_
+00006470: 6469 6374 2822 7265 636f 7264 7322 2900  dict("records").
+00006480: 2020 2020 2020 2020 6c6f 672e 6465 6275          log.debu
+00006490: 6728 2270 7269 6e74 696e 6720 6d69 6e69  g("printing mini
+000064a0: 206f 7069 6e69 6f6e 2064 6174 6166 7261   opinion datafra
+000064b0: 6d65 2061 7320 6120 6469 6374 2229 0020  me as a dict"). 
+000064c0: 2020 2020 2020 206c 6f67 2e64 6562 7567         log.debug
+000064d0: 2822 7072 6f63 6573 735f 6466 3a20 636c  ("process_df: cl
+000064e0: 6965 6e74 2e6d 6170 2229 0020 2020 2064  ient.map").    d
+000064f0: 6566 2070 726f 6365 7373 5f64 6628 7365  ef process_df(se
+00006500: 6c66 2c20 6466 293a 0020 2020 2023 2320  lf, df):.    ## 
+00006510: 5072 6f63 6573 7320 4f70 696e 696f 6e20  Process Opinion 
+00006520: 4461 7461 6672 616d 6500 0020 2020 2020  Dataframe..     
+00006530: 2020 2072 6574 7572 6e20 7365 6c66 2e67     return self.g
+00006540: 6574 5f6f 7069 6e69 6f6e 735f 636c 7573  et_opinions_clus
+00006550: 7465 725f 6466 2829 5b63 6c75 7374 6572  ter_df()[cluster
+00006560: 5f69 645d 0020 2020 2020 2020 2063 6c75  _id].        clu
+00006570: 7374 6572 5f69 6420 3d20 6f70 696e 696f  ster_id = opinio
+00006580: 6e5b 2263 6c75 7374 6572 5f69 6422 5d00  n["cluster_id"].
+00006590: 2020 2020 2020 2020 2320 6765 7420 6561          # get ea
+000065a0: 6368 2063 6f72 7265 7370 6f6e 6469 6e67  ch corresponding
+000065b0: 2072 6f77 2066 726f 6d20 636c 7573 7465   row from cluste
+000065c0: 7273 2c20 646f 636b 6574 732c 2063 6f75  rs, dockets, cou
+000065d0: 7274 7320 6261 7365 6420 6f6e 206f 7069  rts based on opi
+000065e0: 6e69 6f6e 2069 6400 2020 2020 6465 6620  nion id.    def 
+000065f0: 6765 745f 636c 7573 7465 725f 726f 7728  get_cluster_row(
+00006600: 7365 6c66 2c20 6f70 696e 696f 6e29 3a00  self, opinion):.
+00006610: 2020 2020 2323 2067 6574 2063 6c75 7374      ## get clust
+00006620: 6572 5f72 6f77 0000 2020 2020 2020 2020  er_row..        
+00006630: 2020 2020 7265 7475 726e 2073 7570 6572      return super
+00006640: 284e 7045 6e63 6f64 6572 2c20 7365 6c66  (NpEncoder, self
+00006650: 292e 6465 6661 756c 7428 6f62 6a29 0020  ).default(obj). 
+00006660: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00006670: 6574 7572 6e20 2222 0020 2020 2020 2020  eturn "".       
+00006680: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00006690: 6365 286f 626a 2c20 4e41 5479 7065 293a  ce(obj, NAType):
+000066a0: 0020 2020 2020 2020 2020 2020 2020 2020  .               
+000066b0: 2072 6574 7572 6e20 6f62 6a2e 746f 6c69   return obj.toli
+000066c0: 7374 2829 0020 2020 2020 2020 2020 2020  st().           
+000066d0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+000066e0: 626a 2c20 6e70 2e6e 6461 7272 6179 293a  bj, np.ndarray):
+000066f0: 0020 2020 2020 2020 2020 2020 2020 2020  .               
+00006700: 2072 6574 7572 6e20 666c 6f61 7428 6f62   return float(ob
+00006710: 6a29 0020 2020 2020 2020 2020 2020 2069  j).            i
+00006720: 6620 6973 696e 7374 616e 6365 286f 626a  f isinstance(obj
+00006730: 2c20 6e70 2e66 6c6f 6174 696e 6729 3a00  , np.floating):.
+00006740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006750: 7265 7475 726e 2069 6e74 286f 626a 2900  return int(obj).
+00006760: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00006770: 7320 2020 2020 2020 2020 2020 206c 6f67  s            log
+00006780: 2e64 6562 7567 2827 6669 6e69 7368 6564  .debug('finished
+00006790: 2063 6f6e 7665 7274 696e 6720 6369 7461   converting cita
+000067a0: 7469 6f6e 2064 6174 6166 7261 6d65 2069  tion dataframe i
+000067b0: 6e74 6f20 6120 6469 6374 2729 0020 2020  nto a dict').   
+000067c0: 2020 2020 206c 6973 7428 6d61 7028 6c61       list(map(la
+000067d0: 6d62 6461 2078 3a20 7365 6c66 2e63 6974  mbda x: self.cit
+000067e0: 6564 5f62 792e 7365 7464 6566 6175 6c74  ed_by.setdefault
+000067f0: 2878 5b27 6369 7465 645f 6f70 696e 696f  (x['cited_opinio
+00006800: 6e5f 6964 275d 2c20 5b5d 292e 6170 7065  n_id'], []).appe
+00006810: 6e64 2878 5b27 6369 7469 6e67 5f6f 7069  nd(x['citing_opi
+00006820: 6e69 6f6e 5f69 6427 5d29 2c20 6466 5f64  nion_id']), df_d
+00006830: 6963 7429 2900 2020 2020 2020 2020 6c69  ict)).        li
+00006840: 7374 286d 6170 286c 616d 6264 6120 783a  st(map(lambda x:
+00006850: 2073 656c 662e 6369 7465 735f 746f 2e73   self.cites_to.s
+00006860: 6574 6465 6661 756c 7428 785b 2763 6974  etdefault(x['cit
+00006870: 696e 675f 6f70 696e 696f 6e5f 6964 275d  ing_opinion_id']
+00006880: 2c20 5b5d 292e 6170 7065 6e64 2878 5b27  , []).append(x['
+00006890: 6369 7465 645f 6f70 696e 696f 6e5f 6964  cited_opinion_id
+000068a0: 275d 292c 2064 665f 6469 6374 2929 0020  ']), df_dict)). 
+000068b0: 2020 2020 2020 2073 656c 662e 6369 7465         self.cite
+000068c0: 645f 6279 203d 207b 7d00 2020 2020 2020  d_by = {}.      
+000068d0: 2020 7365 6c66 2e63 6974 6573 5f74 6f20    self.cites_to 
+000068e0: 3d20 7b7d 0020 2020 2020 2020 2064 665f  = {}.        df_
+000068f0: 6469 6374 203d 2073 656c 662e 6373 765f  dict = self.csv_
+00006900: 746f 5f64 6628 666e 206f 7220 7365 6c66  to_df(fn or self
+00006910: 2e5f 6369 7461 7469 6f6e 5f66 6e2c 2075  ._citation_fn, u
+00006920: 7365 636f 6c73 3d75 7365 636f 6c73 292e  secols=usecols).
+00006930: 746f 5f64 6963 7428 2272 6563 6f72 6473  to_dict("records
+00006940: 2229 0020 2020 2020 2020 206c 6f67 2e64  ").        log.d
+00006950: 6562 7567 2827 696e 6974 6961 6c69 7a69  ebug('initializi
+00006960: 6e67 2063 6974 6174 696f 6e20 6373 7620  ng citation csv 
+00006970: 746f 2062 6520 6120 6469 6374 2729 0020  to be a dict'). 
+00006980: 2020 2020 2020 2075 7365 636f 6c73 203d         usecols =
+00006990: 205b 2763 6974 6564 5f6f 7069 6e69 6f6e   ['cited_opinion
+000069a0: 5f69 6427 2c20 2763 6974 696e 675f 6f70  _id', 'citing_op
+000069b0: 696e 696f 6e5f 6964 275d 0020 2020 2020  inion_id'].     
+000069c0: 2020 2073 7461 7274 203d 2074 696d 652e     start = time.
+000069d0: 7065 7266 5f63 6f75 6e74 6572 2829 0020  perf_counter(). 
+000069e0: 2020 2064 6566 2069 6e69 745f 6369 7461     def init_cita
+000069f0: 7469 6f6e 5f64 6963 7428 7365 6c66 2c20  tion_dict(self, 
+00006a00: 666e 3d4e 6f6e 6529 3a00 0020 2020 2020  fn=None):..     
+00006a10: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
+00006a20: 7376 5f74 6f5f 6466 2866 6e20 6f72 2073  sv_to_df(fn or s
+00006a30: 656c 662e 5f63 6974 6174 696f 6e5f 666e  elf._citation_fn
+00006a40: 2900 2020 2020 6465 6620 696e 6974 5f63  ).    def init_c
+00006a50: 6974 6174 696f 6e5f 6466 2873 656c 662c  itation_df(self,
+00006a60: 2066 6e3d 4e6f 6e65 293a 0020 2020 2023   fn=None):.    #
+00006a70: 2069 6e69 7469 616c 697a 6520 6369 7461   initialize cita
+00006a80: 7469 6f6e 206d 6170 2064 6600 0020 2020  tion map df..   
+00006a90: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00006aa0: 2e73 716c 6974 6564 6963 745f 7265 6164  .sqlitedict_read
+00006ab0: 6572 2873 716c 5f66 6e29 0020 2020 2020  er(sql_fn).     
+00006ac0: 2020 2020 2020 2029 0020 2020 2020 2020         ).       
+00006ad0: 2020 2020 2020 2020 2066 6e2c 2073 716c           fn, sql
+00006ae0: 5f66 6e2c 2073 656c 662e 6f70 696e 696f  _fn, self.opinio
+00006af0: 6e5f 636c 7573 7465 7273 5f72 6f77 5f74  n_clusters_row_t
+00006b00: 6f5f 6b76 2c20 6261 7463 685f 7369 7a65  o_kv, batch_size
+00006b10: 0020 2020 2020 2020 2020 2020 2073 656c  .            sel
+00006b20: 662e 6275 696c 645f 7371 6c69 7465 6469  f.build_sqlitedi
+00006b30: 6374 2800 2020 2020 2020 2020 6966 206e  ct(.        if n
+00006b40: 6f74 2050 6174 6828 7371 6c5f 666e 292e  ot Path(sql_fn).
+00006b50: 6578 6973 7473 2829 3a00 2020 2020 6465  exists():.    de
+00006b60: 6620 696e 6974 5f6f 7069 6e69 6f6e 5f63  f init_opinion_c
+00006b70: 6c75 7374 6572 735f 6469 6374 2873 656c  lusters_dict(sel
+00006b80: 662c 2066 6e2c 2073 716c 5f66 6e2c 2062  f, fn, sql_fn, b
+00006b90: 6174 6368 5f73 697a 653d 315f 3030 305f  atch_size=1_000_
+00006ba0: 3030 3029 3a00 0020 2020 2020 2020 2072  000):..        r
+00006bb0: 6574 7572 6e20 7365 6c66 2e73 716c 6974  eturn self.sqlit
+00006bc0: 6564 6963 745f 7265 6164 6572 2873 716c  edict_reader(sql
+00006bd0: 5f66 6e29 0020 2020 2020 2020 2020 2020  _fn).           
+00006be0: 2073 656c 662e 6275 696c 645f 7371 6c69   self.build_sqli
+00006bf0: 7465 6469 6374 2866 6e2c 2073 716c 5f66  tedict(fn, sql_f
+00006c00: 6e2c 2073 656c 662e 646f 636b 6574 5f72  n, self.docket_r
+00006c10: 6f77 5f74 6f5f 6b76 2c20 6261 7463 685f  ow_to_kv, batch_
+00006c20: 7369 7a65 2900 2020 2020 2020 2020 6966  size).        if
+00006c30: 206e 6f74 2050 6174 6828 7371 6c5f 666e   not Path(sql_fn
+00006c40: 292e 6578 6973 7473 2829 3a00 2020 2020  ).exists():.    
+00006c50: 6465 6620 696e 6974 5f64 6f63 6b65 7473  def init_dockets
+00006c60: 5f64 6963 7428 7365 6c66 2c20 666e 2c20  _dict(self, fn, 
+00006c70: 7371 6c5f 666e 2c20 6261 7463 685f 7369  sql_fn, batch_si
+00006c80: 7a65 3d31 5f30 3030 5f30 3030 293a 0000  ze=1_000_000):..
+00006c90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00006ca0: 656c 662e 7371 6c69 7465 6469 6374 5f72  elf.sqlitedict_r
+00006cb0: 6561 6465 7228 7371 6c5f 666e 2900 2020  eader(sql_fn).  
+00006cc0: 2020 2020 2020 2020 2020 6462 2e63 6f6d            db.com
+00006cd0: 6d69 7428 2900 2020 2020 2020 2020 2020  mit().          
+00006ce0: 2020 2020 2020 2020 2020 6462 2e63 6f6d            db.com
+00006cf0: 6d69 7428 2900 2020 2020 2020 2020 2020  mit().          
+00006d00: 2020 2020 2020 6966 2069 2025 2062 6174        if i % bat
+00006d10: 6368 5f73 697a 6520 3d3d 2030 3a00 2020  ch_size == 0:.  
+00006d20: 2020 2020 2020 2020 2020 2020 2020 6462                db
+00006d30: 5b6b 5d20 3d20 7600 2020 2020 2020 2020  [k] = v.        
+00006d40: 2020 2020 2020 2020 6b2c 2076 203d 2072          k, v = r
+00006d50: 6f77 5f74 6f5f 6b76 2872 6f77 2900 2020  ow_to_kv(row).  
+00006d60: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
+00006d70: 2072 6f77 2069 6e20 7471 646d 2865 6e75   row in tqdm(enu
+00006d80: 6d65 7261 7465 2873 656c 662e 627a 325f  merate(self.bz2_
+00006d90: 6373 765f 7265 6164 6572 2863 7376 5f66  csv_reader(csv_f
+00006da0: 6e29 292c 2073 6d6f 6f74 6869 6e67 3d30  n)), smoothing=0
+00006db0: 293a 0020 2020 2020 2020 2077 6974 6820  ):.        with 
+00006dc0: 5371 6c69 7465 4469 6374 2873 716c 5f66  SqliteDict(sql_f
+00006dd0: 6e2c 206a 6f75 726e 616c 5f6d 6f64 653d  n, journal_mode=
+00006de0: 224f 4646 222c 206f 7574 6572 5f73 7461  "OFF", outer_sta
+00006df0: 636b 3d46 616c 7365 2920 6173 2064 623a  ck=False) as db:
+00006e00: 0020 2020 2064 6566 2062 7569 6c64 5f73  .    def build_s
+00006e10: 716c 6974 6564 6963 7428 7365 6c66 2c20  qlitedict(self, 
+00006e20: 6373 765f 666e 2c20 7371 6c5f 666e 2c20  csv_fn, sql_fn, 
+00006e30: 726f 775f 746f 5f6b 762c 2062 6174 6368  row_to_kv, batch
+00006e40: 5f73 697a 653d 315f 3030 305f 3030 3029  _size=1_000_000)
+00006e50: 3a00 0020 2020 2020 2020 2072 6574 7572  :..        retur
+00006e60: 6e20 5371 6c69 7465 4469 6374 2873 716c  n SqliteDict(sql
+00006e70: 5f66 6e2c 2066 6c61 673d 2272 222c 206a  _fn, flag="r", j
+00006e80: 6f75 726e 616c 5f6d 6f64 653d 224f 4646  ournal_mode="OFF
+00006e90: 222c 206f 7574 6572 5f73 7461 636b 3d46  ", outer_stack=F
+00006ea0: 616c 7365 2900 2020 2020 6465 6620 7371  alse).    def sq
+00006eb0: 6c69 7465 6469 6374 5f72 6561 6465 7228  litedict_reader(
+00006ec0: 7371 6c5f 666e 293a 0020 2020 2040 7374  sql_fn):.    @st
+00006ed0: 6174 6963 6d65 7468 6f64 0000 2020 2020  aticmethod..    
+00006ee0: 2020 2020 7265 7475 726e 2072 6f77 5b22      return row["
+00006ef0: 6964 225d 2c20 7b66 3a20 726f 775b 665d  id"], {f: row[f]
+00006f00: 2066 6f72 2066 2069 6e20 6669 656c 6473   for f in fields
+00006f10: 7d00 2020 2020 2020 2020 6669 656c 6473  }.        fields
+00006f20: 203d 205b 2263 6f75 7274 5f69 6422 2c20   = ["court_id", 
+00006f30: 2264 6174 655f 7465 726d 696e 6174 6564  "date_terminated
+00006f40: 225d 0020 2020 2064 6566 2064 6f63 6b65  "].    def docke
+00006f50: 745f 726f 775f 746f 5f6b 7628 726f 7729  t_row_to_kv(row)
+00006f60: 3a00 2020 2020 4073 7461 7469 636d 6574  :.    @staticmet
+00006f70: 686f 6400 0020 2020 2020 2020 2072 6574  hod..        ret
+00006f80: 7572 6e20 726f 775b 2269 6422 5d2c 207b  urn row["id"], {
+00006f90: 663a 2072 6f77 5b66 5d20 666f 7220 6620  f: row[f] for f 
+00006fa0: 696e 2066 6965 6c64 737d 0020 2020 2020  in fields}.     
+00006fb0: 2020 2066 6965 6c64 7320 3d20 5b22 6a75     fields = ["ju
+00006fc0: 6467 6573 222c 2022 646f 636b 6574 5f69  dges", "docket_i
+00006fd0: 6422 2c20 2263 6173 655f 6e61 6d65 222c  d", "case_name",
+00006fe0: 2022 6361 7365 5f6e 616d 655f 6675 6c6c   "case_name_full
+00006ff0: 222c 2022 6865 6164 6e6f 7465 7322 5d00  ", "headnotes"].
+00007000: 6164 0000 2d07 0000 4108 0000 0010 0000  ad..-...A.......
+00007010: 3e00 0000 0000 0000 de0f 0000 b80f 0000  >...............
+00007020: b70f 0000 b60f 0000 a70f 0000 8a0f 0000  ................
+00007030: 6b0f 0000 6a0f 0000 4b0f 0000 2a0f 0000  k...j...K...*...
+00007040: 290f 0000 0b0f 0000 eb0e 0000 ea0e 0000  )...............
+00007050: c30e 0000 9a0e 0000 990e 0000 7a0e 0000  ............z...
+00007060: 6d0e 0000 6c0e 0000 3d0e 0000 190e 0000  m...l...=.......
+00007070: ec0d 0000 d70d 0000 b70d 0000 b60d 0000  ................
+00007080: 8f0d 0000 6f0d 0000 430d 0000 230d 0000  ....o...C...#...
+00007090: f60c 0000 d40c 0000 a80c 0000 840c 0000  ................
+000070a0: 5c0c 0000 420c 0000 0b0c 0000 0a0c 0000  \...B...........
+000070b0: f30b 0000 cb0b 0000 730b 0000 480b 0000  ........s...H...
+000070c0: 0e0b 0000 0d0b 0000 ec0a 0000 ce0a 0000  ................
+000070d0: a20a 0000 630a 0000 3b0a 0000 3a0a 0000  ....c...;...:...
+000070e0: 1f0a 0000 f509 0000 b509 0000 b409 0000  ................
+000070f0: a209 0000 7d09 0000 5509 0000 e808 0000  ....}...U.......
+00007100: 9208 0000 9108 0000 7b08 0000 4108 0000  ........{...A...
+00007110: 3808 0000 3708 0000 1208 0000 d407 0000  8...7...........
+00007120: ae07 0000 5107 0000 1e07 0000 e606 0000  ....Q...........
+00007130: bd06 0000 0000 0000 0000 0000 0000 0000  ................
+00007140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000071f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1845,204 +1845,716 @@
 00007340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000073a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000073b0: 0000 0000 0000 0000 0000 0000 0020 2020  .............   
-000073c0: 2072 2020 2020 7265 7475 726e 206a 7320   r    return js 
-000073d0: 2020 2072 2020 2020 7265 7475 726e 206a     r    return j
-000073e0: 736f 6e2e 6475 6d70 2020 2020 7265 7420  son.dump    ret 
-000073f0: 2020 2072 6574 7572 6e20 6a73 6f6e 2e64     return json.d
-00007400: 756d 7073 286f 626a 2020 2020 7265 7475  umps(obj    retu
-00007410: 726e 206a 736f 6e2e 6475 6d70 7328 6f62  rn json.dumps(ob
-00007420: 6a2c 2063 6c73 3d73 656c 662e 4e70 456e  j, cls=self.NpEn
-00007430: 636f 6465 7229 0020 2020 207d 0020 2020  coder).    }.   
-00007440: 2020 2020 207d 0020 2020 2020 2020 2020       }.         
-00007450: 2020 207d 0020 2020 2020 2020 2020 2020     }.           
-00007460: 2020 2020 2027 6175 7468 6f72 273a 2027       'author': '
-00007470: 272c 2027 7479 7065 273a 2027 277d 5d00  ', 'type': ''}].
-00007480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007490: 2774 6578 7427 3a20 7365 6c66 2e67 6574  'text': self.get
-000074a0: 5f6f 7069 6e69 6f6e 5f74 6578 7428 6f70  _opinion_text(op
-000074b0: 696e 696f 6e29 2c20 0020 2020 2020 2020  inion), .       
-000074c0: 2020 2020 2027 6f70 696e 696f 6e73 273a       'opinions':
-000074d0: 205b 7b00 2020 2020 2020 2020 2020 2020   [{.            
-000074e0: 2768 6561 645f 6d61 7474 6572 273a 2727  'head_matter':''
-000074f0: 2c20 2341 736b 2043 4c20 6162 6f75 7420  , #Ask CL about 
-00007500: 636f 7079 7269 6768 742c 0020 2020 2020  copyright,.     
-00007510: 2020 2020 2020 2027 6a75 6467 6573 273a         'judges':
-00007520: 206a 7564 6765 5f6c 6973 742c 0020 2020   judge_list,.   
-00007530: 2020 2020 2027 6361 7365 626f 6479 2720       'casebody' 
-00007540: 3a20 7b27 6461 7461 273a 207b 0020 2020  : {'data': {.   
-00007550: 2020 2020 2027 6a75 7269 7364 6963 7469       'jurisdicti
-00007560: 6f6e 2720 3a20 7b27 6e61 6d65 273a 2063  on' : {'name': c
-00007570: 6f75 7274 5f72 6f77 2e6a 7572 6973 6469  ourt_row.jurisdi
-00007580: 6374 696f 6e2e 696c 6f63 5b30 5d7d 2c00  ction.iloc[0]},.
-00007590: 2020 2020 2020 2020 2763 6f75 7274 2720          'court' 
-000075a0: 3a20 7b27 6e61 6d65 273a 2063 6f75 7274  : {'name': court
-000075b0: 5f72 6f77 2e66 756c 6c5f 6e61 6d65 2e69  _row.full_name.i
-000075c0: 6c6f 635b 305d 7d2c 0020 2020 2020 2020  loc[0]},.       
-000075d0: 2027 6369 7465 735f 746f 2720 3a20 6369   'cites_to' : ci
-000075e0: 7465 735f 746f 2c00 2020 2020 2020 2020  tes_to,.        
-000075f0: 2763 6974 6174 696f 6e73 2720 3a20 6369  'citations' : ci
-00007600: 7465 645f 6279 2c00 2020 2020 2020 2020  ted_by,.        
-00007610: 2764 6f63 6b65 745f 6e75 6d62 6572 2720  'docket_number' 
-00007620: 3a20 636c 7573 7465 725f 726f 772e 646f  : cluster_row.do
-00007630: 636b 6574 5f69 642e 696c 6f63 5b30 5d2c  cket_id.iloc[0],
-00007640: 0020 2020 2020 2020 2027 6465 6369 7369  .        'decisi
-00007650: 6f6e 5f64 6174 6527 3a20 2727 2c20 2364  on_date': '', #d
-00007660: 6174 655f 7465 726d 696e 6174 6564 2c00  ate_terminated,.
-00007670: 2020 2020 2020 2020 276e 616d 6527 203a          'name' :
-00007680: 2063 6c75 7374 6572 5f72 6f77 2e63 6173   cluster_row.cas
-00007690: 655f 6e61 6d65 5f66 756c 6c2e 696c 6f63  e_name_full.iloc
-000076a0: 5b30 5d2c 0020 2020 2020 2020 2027 6e61  [0],.        'na
-000076b0: 6d65 5f61 6262 7265 7669 6174 696f 6e27  me_abbreviation'
-000076c0: 3a20 636c 7573 7465 725f 726f 772e 6361  : cluster_row.ca
-000076d0: 7365 5f6e 616d 652e 696c 6f63 5b30 5d2c  se_name.iloc[0],
-000076e0: 0020 2020 2020 2020 2027 7572 6c27 3a20  .        'url': 
-000076f0: 7572 6c2c 0020 2020 2020 2020 2027 6964  url,.        'id
-00007700: 273a 2063 6c75 7374 6572 5f69 642c 0020  ': cluster_id,. 
-00007710: 2020 206f 626a 203d 207b 0000 2020 2020     obj = {..    
-00007720: 7572 6c20 3d20 2727 2023 206f 7069 6e69  url = '' # opini
-00007730: 6f6e 5b27 646f 776e 6c6f 6164 5f75 726c  on['download_url
-00007740: 275d 0020 2020 2023 2320 646f 776e 6c6f  '].    ## downlo
-00007750: 6164 2075 726c 206d 6179 2061 6c73 6f20  ad url may also 
-00007760: 6265 206d 6973 7369 6e67 0020 2020 2064  be missing.    d
-00007770: 6174 655f 7465 726d 696e 6174 6564 203d  ate_terminated =
-00007780: 2064 6f63 6b65 745f 726f 775b 315d 0020   docket_row[1]. 
-00007790: 2020 2023 2320 736f 6d65 7469 6d65 7320     ## sometimes 
-000077a0: 6461 7465 5f74 6572 6d69 6e61 7465 6420  date_terminated 
-000077b0: 6d61 7920 6265 206d 6973 7369 6e67 2061  may be missing a
-000077c0: 6e64 2072 6563 6f72 6465 6420 6173 204e  nd recorded as N
-000077d0: 614e 0020 2020 2023 2020 2020 0020 2020  aN.    #    .   
-000077e0: 205d 0020 2020 2020 2020 2069 6620 6e6f   ].        if no
-000077f0: 7420 7265 2e6d 6174 6368 2827 5b63 6a5d  t re.match('[cj]
-00007800: 3f6a 5c2e 272c 206a 7564 6765 2900 2020  ?j\.', judge).  
-00007810: 2020 2020 2020 2020 2020 286a 7564 6765            (judge
-00007820: 732e 696c 6f63 5b30 5d2e 7370 6c69 7428  s.iloc[0].split(
-00007830: 272c 2729 2069 6620 6a75 6467 6573 2e6e  ',') if judges.n
-00007840: 6f74 6e61 2829 2e62 6f6f 6c28 2920 656c  otna().bool() el
-00007850: 7365 205b 5d29 0020 2020 2020 2020 2066  se []).        f
-00007860: 6f72 206a 7564 6765 2069 6e00 2020 2020  or judge in.    
-00007870: 2020 2020 6a75 6467 6500 2020 2020 6a75      judge.    ju
-00007880: 6467 655f 6c69 7374 203d 205b 0020 2020  dge_list = [.   
-00007890: 206a 7564 6765 7320 3d20 636c 7573 7465   judges = cluste
-000078a0: 725f 726f 772e 6a75 6467 6573 0020 2020  r_row.judges.   
-000078b0: 2023 206a 7564 6765 7300 0020 2020 2063   # judges..    c
-000078c0: 6974 6564 5f62 7920 3d20 6369 7461 7469  ited_by = citati
-000078d0: 6f6e 5f69 6e66 6f5b 2763 6974 6564 5f62  on_info['cited_b
-000078e0: 7927 5d00 2020 2020 6369 7465 735f 746f  y'].    cites_to
-000078f0: 203d 2063 6974 6174 696f 6e5f 696e 666f   = citation_info
-00007900: 5b27 6369 7465 735f 746f 275d 0020 2020  ['cites_to'].   
-00007910: 2063 6974 6174 696f 6e5f 696e 666f 203d   citation_info =
-00007920: 2073 656c 662e 6765 745f 6369 7461 7469   self.get_citati
-00007930: 6f6e 7328 6f70 696e 696f 6e5f 6964 2c20  ons(opinion_id, 
-00007940: 6369 7461 7469 6f6e 7329 0020 2020 2023  citations).    #
-00007950: 2067 6574 206f 7069 6e69 6f6e 7320 6369   get opinions ci
-00007960: 7465 6420 746f 0000 2020 2020 2020 2020  ted to..        
-00007970: 7265 7475 726e 0020 2020 2069 6620 636f  return.    if co
-00007980: 7572 745f 726f 772e 656d 7074 793a 0020  urt_row.empty:. 
-00007990: 2020 2063 6f75 7274 5f72 6f77 3a20 7365     court_row: se
-000079a0: 6c66 2e44 6174 6146 7261 6d65 203d 2063  lf.DataFrame = c
-000079b0: 6f75 7274 735b 636f 7572 7473 5b27 6964  ourts[courts['id
-000079c0: 275d 203d 3d20 6369 645d 0020 2020 2063  '] == cid].    c
-000079d0: 6964 203d 2064 6f63 6b65 745f 726f 775b  id = docket_row[
-000079e0: 305d 0020 2020 2020 2020 2072 6574 7572  0].        retur
-000079f0: 6e00 2020 2020 6966 206e 6f74 2064 6f63  n.    if not doc
-00007a00: 6b65 745f 726f 773a 0020 2020 2023 2072  ket_row:.    # r
-00007a10: 6574 7572 6e20 6561 726c 7920 6966 2074  eturn early if t
-00007a20: 6865 7265 2773 2000 2020 2000 2020 2020  here's .   .    
-00007a30: 646f 636b 6574 5f72 6f77 203d 2064 6f63  docket_row = doc
-00007a40: 6b65 7473 5b64 6f63 6b65 745f 6964 5d00  kets[docket_id].
-00007a50: 2020 2020 2364 6f63 6b65 745f 726f 7720      #docket_row 
-00007a60: 3d20 646f 636b 6574 735b 646f 636b 6574  = dockets[docket
-00007a70: 735b 2769 6427 5d20 3d3d 2064 6f63 6b65  s['id'] == docke
-00007a80: 745f 6964 5d2e 636f 6d70 7574 6528 2900  t_id].compute().
-00007a90: 2020 2020 646f 636b 6574 5f69 6420 3d20      docket_id = 
-00007aa0: 696e 7428 636c 7573 7465 725f 726f 775b  int(cluster_row[
-00007ab0: 2764 6f63 6b65 745f 6964 275d 2900 2020  'docket_id']).  
-00007ac0: 2020 2320 6765 7420 636f 7272 6573 706f    # get correspo
-00007ad0: 6e64 696e 6720 726f 7720 6672 6f6d 2064  nding row from d
-00007ae0: 6f63 6b65 7420 6466 2062 6173 6564 206f  ocket df based o
-00007af0: 6e20 636c 7573 7465 7220 6f70 696e 696f  n cluster opinio
-00007b00: 6e20 6964 0000 2020 2020 636c 7573 7465  n id..    cluste
-00007b10: 725f 726f 773a 2073 656c 662e 4461 7461  r_row: self.Data
-00007b20: 4672 616d 6520 3d20 7365 6c66 2e64 665f  Frame = self.df_
-00007b30: 726f 775f 6279 5f76 616c 7565 2873 656c  row_by_value(sel
-00007b40: 662e 6765 745f 6f70 696e 696f 6e73 5f63  f.get_opinions_c
-00007b50: 6c75 7374 6572 5f64 6628 292c 2027 6964  luster_df(), 'id
-00007b60: 272c 2063 6c75 7374 6572 5f69 6429 0020  ', cluster_id). 
-00007b70: 2020 2023 2067 6574 2065 6163 6820 636f     # get each co
-00007b80: 7272 6573 706f 6e64 696e 6720 726f 7720  rresponding row 
-00007b90: 6672 6f6d 2063 6c75 7374 6572 732c 2064  from clusters, d
-00007ba0: 6f63 6b65 7473 2c20 636f 7572 7473 2062  ockets, courts b
-00007bb0: 6173 6564 206f 6e20 6f70 696e 696f 6e20  ased on opinion 
-00007bc0: 6964 0000 2020 2020 636c 7573 7465 725f  id..    cluster_
-00007bd0: 6964 203d 206f 7069 6e69 6f6e 5b27 636c  id = opinion['cl
-00007be0: 7573 7465 725f 6964 275d 0020 2020 206f  uster_id'].    o
-00007bf0: 7069 6e69 6f6e 5f69 6420 3d20 6f70 696e  pinion_id = opin
-00007c00: 696f 6e5b 2769 6427 5d00 2020 2020 6369  ion['id'].    ci
-00007c10: 7461 7469 6f6e 7320 3d20 7365 6c66 2e67  tations = self.g
-00007c20: 6574 5f63 6974 6174 696f 6e5f 6466 2829  et_citation_df()
-00007c30: 0020 2020 2063 6f75 7274 7320 3d20 7365  .    courts = se
-00007c40: 6c66 2e67 6574 5f63 6f75 7274 735f 6466  lf.get_courts_df
-00007c50: 2829 0020 2020 2064 6f63 6b65 7473 203d  ().    dockets =
-00007c60: 2073 656c 662e 6765 745f 646f 636b 6574   self.get_docket
-00007c70: 735f 6466 2829 0020 2020 206c 6f67 2e64  s_df().    log.d
-00007c80: 6562 7567 2827 7072 6f63 6573 735f 726f  ebug('process_ro
-00007c90: 7727 2900 2020 6465 6620 7072 6f63 6573  w').  def proces
-00007ca0: 735f 726f 7728 7365 6c66 2c20 6f70 696e  s_row(self, opin
-00007cb0: 696f 6e29 202d 3e20 6469 6374 3a00 2020  ion) -> dict:.  
-00007cc0: 2320 7072 6f63 6573 7300 2020 0020 2020  # process.  .   
-00007cd0: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00007ce0: 7228 4e70 456e 636f 6465 722c 2073 656c  r(NpEncoder, sel
-00007cf0: 6629 2e64 6566 6175 6c74 286f 626a 2900  f).default(obj).
-00007d00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00007d10: 726e 2027 2700 2020 2020 2020 2020 6966  rn ''.        if
-00007d20: 2069 7369 6e73 7461 6e63 6528 6f62 6a2c   isinstance(obj,
-00007d30: 204e 4154 7970 6529 3a00 2020 2020 2020   NAType):.      
-00007d40: 2020 2020 2020 7265 7475 726e 206f 626a        return obj
-00007d50: 2e74 6f6c 6973 7428 2900 2020 2020 2020  .tolist().      
-00007d60: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00007d70: 6f62 6a2c 206e 702e 6e64 6172 7261 7929  obj, np.ndarray)
-00007d80: 3a00 2020 2020 2020 2020 2020 2020 7265  :.            re
-00007d90: 7475 726e 2066 6c6f 6174 286f 626a 2900  turn float(obj).
-00007da0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00007db0: 7461 6e63 6528 6f62 6a2c 206e 702e 666c  tance(obj, np.fl
-00007dc0: 6f61 7469 6e67 293a 0020 2020 2020 2020  oating):.       
-00007dd0: 2020 2020 2072 6574 7572 6e20 696e 7428       return int(
-00007de0: 6f62 6a29 0020 2020 2020 2020 2069 6620  obj).        if 
-00007df0: 6973 696e 7374 616e 6365 286f 626a 2c20  isinstance(obj, 
-00007e00: 6e70 2e69 6e74 6567 6572 293a 0020 2020  np.integer):.   
-00007e10: 2064 6566 2064 6566 6175 6c74 2873 656c   def default(sel
-00007e20: 662c 206f 626a 293a 0020 2063 6c61 7373  f, obj):.  class
-00007e30: 204e 7045 6e63 6f64 6572 286a 736f 6e2e   NpEncoder(json.
-00007e40: 4a53 4f4e 456e 636f 6465 7229 3a00 0020  JSONEncoder):.. 
-00007e50: 2020 2020 2070 6173 7300 2020 6465 6620       pass.  def 
-00007e60: 6765 745f 6f70 696e 696f 6e73 5f64 6628  get_opinions_df(
-00007e70: 7365 6c66 293a 0000 2020 2020 2020 7265  self):..      re
-00007e80: 7475 726e 2073 656c 662e 5f64 665f 6f70  turn self._df_op
-00007e90: 696e 696f 6e5f 636c 7573 7465 7273 0020  inion_clusters. 
-00007ea0: 2064 6566 2067 6574 5f6f 7069 6e69 6f6e   def get_opinion
-00007eb0: 735f 636c 7573 7465 725f 6466 2873 656c  s_cluster_df(sel
-00007ec0: 6629 3a00 0020 2020 2020 2072 6574 7572  f):..      retur
-00007ed0: 6e20 7365 6c66 2e5f 6466 5f64 6f63 6b65  n self._df_docke
-00007ee0: 7473 0020 2064 6566 2067 6574 5f64 6f63  ts.  def get_doc
-00007ef0: 6b65 7473 5f64 6628 7365 6c66 293a 0020  kets_df(self):. 
-00007f00: 2000 2020 2020 2020 7265 7475 726e 2073   .      return s
-00007f10: 656c 662e 5f64 665f 6369 7461 7469 6f6e  elf._df_citation
-00007f20: 0020 2064 6566 2067 6574 5f63 6974 6174  .  def get_citat
-00007f30: 696f 6e5f 6466 2873 656c 6629 3a00 0020  ion_df(self):.. 
-00007f40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00007f50: 2e5f 6466 5f63 6f75 7274 7300 2020 6465  ._df_courts.  de
-00007f60: 6620 6765 745f 636f 7572 7473 5f64 6628  f get_courts_df(
-00007f70: 7365 6c66 293a 0020 2023 2320 4765 7474  self):.  ## Gett
-00007f80: 6572 7300 0020 2020 2020 2072 6574 7572  ers..      retur
-00007f90: 6e20 7365 6c66 2e63 7376 5f74 6f5f 6466  n self.csv_to_df
-00007fa0: 2866 6e20 6f72 2073 656c 662e 5f63 6974  (fn or self._cit
-00007fb0: 6174 696f 6e5f 666e 2900 2020 6465 6620  ation_fn).  def 
-00007fc0: 696e 6974 5f63 6974 6174 696f 6e5f 6466  init_citation_df
-00007fd0: 2873 656c 662c 2066 6e3d 4e6f 6e65 293a  (self, fn=None):
-00007fe0: 0020 2023 2069 6e69 7469 616c 697a 6520  .  # initialize 
-00007ff0: 6369 7461 7469 6f6e 206d 6170 2064 6600  citation map df.
+000073b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000074f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000075f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000076a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000076b0: 0000 0000 0000 0000 0000 0000 0020 2020  .............   
+000076c0: 2020 2020 2023 2064 6f63 6b65 745f 6f62       # docket_ob
+000076d0: 6a20 3d20 6c69 7374 286d 6170 2800 0020  j = list(map(.. 
+000076e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000076f0: 646f 636b 6574 5f6f 626a 203d 206c 6973  docket_obj = lis
+00007700: 7428 6d61 7028 0000 2020 2020 2020 2020  t(map(..        
+00007710: 2320 696d 706f 7274 2070 6462 3b20 2020  # import pdb;   
+00007720: 2020 2020 2020 2320 646f 636b 6574 5f6f        # docket_o
+00007730: 626a 203d 206c 6973 7428 6d61 7028 0000  bj = list(map(..
+00007740: 2020 2020 2020 2020 2320 696d 706f 7274          # import
+00007750: 2020 2020 2020 2020 2023 2064 6f63 6b65           # docke
+00007760: 745f 6f62 6a20 2020 2020 2020 2023 2064  t_obj        # d
+00007770: 6f63 6b65 745f 6f62 6a20 3d20 6c69 7374  ocket_obj = list
+00007780: 286d 6170 2800 0020 2020 2020 2020 2023  (map(..        #
+00007790: 2064 6f63 6b65 745f 6f62 6a20 3d20 6c69   docket_obj = li
+000077a0: 7374 286d 6170 2800 0020 2020 2020 2020  st(map(..       
+000077b0: 2020 2020 2020 2320 646f 636b 6574 5f6f        # docket_o
+000077c0: 626a 203d 206c 6973 7428 6d61 7028 0000  bj = list(map(..
+000077d0: 2020 2020 2020 2020 2020 2020 2320 646f              # do
+000077e0: 636b 6574 5f6f 626a 203d 206c 6973 7428  cket_obj = list(
+000077f0: 6d61 7028 0000 2020 2020 2020 2020 2320  map(..        # 
+00007800: 6462 2e6d 6170 2870 7269 6e74 2c20 6229  db.map(print, b)
+00007810: 2e63 0020 2020 2020 2020 2023 2064 622e  .c.        # db.
+00007820: 6d61 7028 7072 696e 742c 2062 292e 636f  map(print, b).co
+00007830: 6d70 7574 6528 2900 2020 2020 2020 2020  mpute().        
+00007840: 0020 2020 2020 2020 206c 6f67 2e64 6562  .        log.deb
+00007850: 7567 2822 7275 6e6e 696e 6720 6d61 7028  ug("running map(
+00007860: 7072 6f63 6573 735f 726f 7729 2069 6e20  process_row) in 
+00007870: 7061 7261 6c6c 656c 2229 0020 2020 2020  parallel").     
+00007880: 2020 2023 2070 726f 6365 7373 2072 6f77     # process row
+00007890: 0000 2020 2020 2020 2020 646f 636b 6574  ..        docket
+000078a0: 5f72 6f77 7320 3d20 6c69 7374 286d 6170  _rows = list(map
+000078b0: 286c 616d 6264 6120 783a 2064 6f63 6b65  (lambda x: docke
+000078c0: 7473 5b69 6e74 2878 5b22 646f 636b 6574  ts[int(x["docket
+000078d0: 5f69 6422 5d29 5d2c 2063 6c75 7374 6572  _id"])], cluster
+000078e0: 5f72 6f77 7329 2900 2020 2020 2020 2020  _rows)).        
+000078f0: 2320 6765 7420 7468 6520 646f 6365 6b74  # get the docekt
+00007900: 5f69 6420 6173 2061 6e20 696e 7420 6672  _id as an int fr
+00007910: 6f6d 2065 6163 6820 636c 7573 7465 725f  om each cluster_
+00007920: 726f 7720 696e 206f 7264 6572 6420 6173  row in orderd as
+00007930: 2061 206b 6579 2074 6f20 6861 7368 2069   a key to hash i
+00007940: 6e74 6f20 7468 6520 646f 636b 6574 7320  nto the dockets 
+00007950: 6469 6374 0020 2020 2020 2020 2064 6f63  dict.        doc
+00007960: 6b65 7473 203d 2073 656c 662e 6765 745f  kets = self.get_
+00007970: 646f 636b 6574 735f 6466 2829 0020 2020  dockets_df().   
+00007980: 2020 2020 206c 6f67 2e64 6562 7567 2822       log.debug("
+00007990: 6765 7474 696e 6720 646f 636b 6574 7322  getting dockets"
+000079a0: 2900 2020 2020 2020 2020 2320 646f 636b  ).        # dock
+000079b0: 6574 7300 0020 2020 2020 2020 2063 6c75  ets..        clu
+000079c0: 7374 6572 5f72 6f77 7320 3d20 6c69 7374  ster_rows = list
+000079d0: 286d 6170 2873 656c 662e 6765 745f 636c  (map(self.get_cl
+000079e0: 7573 7465 725f 726f 772c 2064 665f 6469  uster_row, df_di
+000079f0: 6374 2929 0020 2020 2020 2020 206c 6f67  ct)).        log
+00007a00: 2e64 6562 7567 2822 6765 7474 696e 6720  .debug("getting 
+00007a10: 636c 7573 7465 7220 726f 7773 2229 0020  cluster rows"). 
+00007a20: 2020 2020 2020 2023 2067 6574 2063 6c75         # get clu
+00007a30: 7374 6572 2072 6f77 7300 0020 2020 2020  ster rows..     
+00007a40: 2020 2064 665f 6469 6374 203d 2064 662e     df_dict = df.
+00007a50: 746f 5f64 6963 7428 2272 6563 6f72 6473  to_dict("records
+00007a60: 2229 0020 2020 2020 2020 206c 6f67 2e64  ").        log.d
+00007a70: 6562 7567 2822 7072 696e 7469 6e67 206d  ebug("printing m
+00007a80: 696e 6920 6f70 696e 696f 6e20 6461 7461  ini opinion data
+00007a90: 6672 616d 6520 6173 2061 2064 6963 7422  frame as a dict"
+00007aa0: 2900 2020 2020 2020 2020 6c6f 672e 6465  ).        log.de
+00007ab0: 6275 6728 2270 726f 6365 7373 5f64 663a  bug("process_df:
+00007ac0: 2063 6c69 656e 742e 6d61 7022 2900 2020   client.map").  
+00007ad0: 2020 6465 6620 7072 6f63 6573 735f 6466    def process_df
+00007ae0: 2873 656c 662c 2064 6629 3a00 2020 2020  (self, df):.    
+00007af0: 2323 2050 726f 6365 7373 204f 7069 6e69  ## Process Opini
+00007b00: 6f6e 2044 6174 6166 7261 6d65 0000 2020  on Dataframe..  
+00007b10: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00007b20: 662e 6765 745f 6f70 696e 696f 6e73 5f63  f.get_opinions_c
+00007b30: 6c75 7374 6572 5f64 6628 295b 636c 7573  luster_df()[clus
+00007b40: 7465 725f 6964 5d00 2020 2020 2020 2020  ter_id].        
+00007b50: 636c 7573 7465 725f 6964 203d 206f 7069  cluster_id = opi
+00007b60: 6e69 6f6e 5b22 636c 7573 7465 725f 6964  nion["cluster_id
+00007b70: 225d 0020 2020 2020 2020 2023 2067 6574  "].        # get
+00007b80: 2065 6163 6820 636f 7272 6573 706f 6e64   each correspond
+00007b90: 696e 6720 726f 7720 6672 6f6d 2063 6c75  ing row from clu
+00007ba0: 7374 6572 732c 2064 6f63 6b65 7473 2c20  sters, dockets, 
+00007bb0: 636f 7572 7473 2062 6173 6564 206f 6e20  courts based on 
+00007bc0: 6f70 696e 696f 6e20 6964 0020 2020 2064  opinion id.    d
+00007bd0: 6566 2067 6574 5f63 6c75 7374 6572 5f72  ef get_cluster_r
+00007be0: 6f77 2873 656c 662c 206f 7069 6e69 6f6e  ow(self, opinion
+00007bf0: 293a 0020 2020 2023 2320 6765 7420 636c  ):.    ## get cl
+00007c00: 7573 7465 725f 726f 7700 0020 2020 2020  uster_row..     
+00007c10: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
+00007c20: 7065 7228 4e70 456e 636f 6465 722c 2073  per(NpEncoder, s
+00007c30: 656c 6629 2e64 6566 6175 6c74 286f 626a  elf).default(obj
+00007c40: 2900 2020 2020 2020 2020 2020 2020 2020  ).              
+00007c50: 2020 7265 7475 726e 2022 2200 2020 2020    return "".    
+00007c60: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00007c70: 7461 6e63 6528 6f62 6a2c 204e 4154 7970  tance(obj, NATyp
+00007c80: 6529 3a00 2020 2020 2020 2020 2020 2020  e):.            
+00007c90: 2020 2020 7265 7475 726e 206f 626a 2e74      return obj.t
+00007ca0: 6f6c 6973 7428 2900 2020 2020 2020 2020  olist().        
+00007cb0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00007cc0: 6528 6f62 6a2c 206e 702e 6e64 6172 7261  e(obj, np.ndarra
+00007cd0: 7929 3a00 2020 2020 2020 2020 2020 2020  y):.            
+00007ce0: 2020 2020 7265 7475 726e 2066 6c6f 6174      return float
+00007cf0: 286f 626a 2900 2020 2020 2020 2020 2020  (obj).          
+00007d00: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00007d10: 6f62 6a2c 206e 702e 666c 6f61 7469 6e67  obj, np.floating
+00007d20: 293a 0020 2020 2020 2020 2020 2020 2020  ):.             
+00007d30: 2020 2072 6574 7572 6e20 696e 7428 6f62     return int(ob
+00007d40: 6a29 0020 2020 2020 2020 2020 2020 2069  j).            i
+00007d50: 6620 6973 696e 7374 616e 6365 286f 626a  f isinstance(obj
+00007d60: 2c20 6e70 2e69 6e74 6567 6572 293a 0020  , np.integer):. 
+00007d70: 2020 2020 2020 2064 6566 2064 6566 6175         def defau
+00007d80: 6c74 2873 656c 662c 206f 626a 293a 0020  lt(self, obj):. 
+00007d90: 2020 2063 6c61 7373 204e 7045 6e63 6f64     class NpEncod
+00007da0: 6572 286a 736f 6e2e 4a53 4f4e 456e 636f  er(json.JSONEnco
+00007db0: 6465 7229 3a00 0020 2020 2020 2020 2072  der):..        r
+00007dc0: 6574 7572 6e20 7365 6c66 2e5f 6466 5f64  eturn self._df_d
+00007dd0: 6f63 6b65 7473 0020 2020 2020 2020 2066  ockets.        f
+00007de0: 696c 652e 636c 6f73 6528 2900 2020 2020  ile.close().    
+00007df0: 2020 2020 7365 6c66 2e5f 6466 5f64 6f63      self._df_doc
+00007e00: 6b65 7473 203d 2070 6963 6b6c 652e 6c6f  kets = pickle.lo
+00007e10: 6164 2866 696c 6529 0020 2020 2020 2020  ad(file).       
+00007e20: 2066 696c 6520 3d20 6f70 656e 2822 646f   file = open("do
+00007e30: 636b 6574 222c 2022 7262 2229 0020 2020  cket", "rb").   
+00007e40: 2064 6566 2067 6574 5f70 6963 6b6c 6564   def get_pickled
+00007e50: 5f64 6f63 6b65 7428 7365 6c66 2c20 666e  _docket(self, fn
+00007e60: 3d22 646f 636b 6574 2229 3a00 0020 2020  ="docket"):..   
+00007e70: 2020 2020 2070 6173 7300 2020 2020 6465       pass.    de
+00007e80: 6620 6765 745f 6f70 696e 696f 6e73 5f64  f get_opinions_d
+00007e90: 6628 7365 6c66 293a 0000 2020 2020 2020  f(self):..      
+00007ea0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+00007eb0: 665f 6f70 696e 696f 6e5f 636c 7573 7465  f_opinion_cluste
+00007ec0: 7273 0020 2020 2064 6566 2067 6574 5f6f  rs.    def get_o
+00007ed0: 7069 6e69 6f6e 735f 636c 7573 7465 725f  pinions_cluster_
+00007ee0: 6466 2873 656c 6629 3a00 0020 2020 2020  df(self):..     
+00007ef0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00007f00: 6466 5f64 6f63 6b65 7473 0020 2020 2064  df_dockets.    d
+00007f10: 6566 2067 6574 5f64 6f63 6b65 7473 5f64  ef get_dockets_d
+00007f20: 6628 7365 6c66 293a 0000 2020 2020 2020  f(self):..      
+00007f30: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+00007f40: 665f 6369 7461 7469 6f6e 0020 2020 2064  f_citation.    d
+00007f50: 6566 2067 6574 5f63 6974 6174 696f 6e5f  ef get_citation_
+00007f60: 6466 2873 656c 6629 3a00 0020 2020 2020  df(self):..     
+00007f70: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00007f80: 6466 5f63 6f75 7274 7300 2020 2020 6465  df_courts.    de
+00007f90: 6620 6765 745f 636f 7572 7473 5f64 6628  f get_courts_df(
+00007fa0: 7365 6c66 293a 0020 2020 2023 2320 4765  self):.    ## Ge
+00007fb0: 7474 6572 7300 0000 2020 2020 2020 2020  tters...        
+00007fc0: 6c6f 672e 6465 6275 6728 2865 6e64 202d  log.debug((end -
+00007fd0: 2073 7461 7274 2920 2f20 3630 2900 2020   start) / 60).  
+00007fe0: 2020 2020 2020 656e 6420 3d20 7469 6d65        end = time
+00007ff0: 2e70 6572 665f 636f 756e 7465 7228 2900  .perf_counter().
+00008000: 6164 0000 9400 0000 3402 0000 0010 0000  ad......4.......
+00008010: 6100 0000 0000 0000 b10f 0000 b00f 0000  a...............
+00008020: 6b0f 0000 100f 0000 cb0e 0000 a50e 0000  k...............
+00008030: 820e 0000 570e 0000 560e 0000 0b0e 0000  ....W...V.......
+00008040: e90d 0000 ce0d 0000 bb0d 0000 960d 0000  ................
+00008050: 560d 0000 3a0d 0000 270d 0000 260d 0000  V...:...'...&...
+00008060: 060d 0000 b20c 0000 5e0c 0000 5d0c 0000  ........^...]...
+00008070: 4c0c 0000 250c 0000 0e0c 0000 fc0b 0000  L...%...........
+00008080: bd0b 0000 8e0b 0000 840b 0000 7a0b 0000  ............z...
+00008090: 320b 0000 fa0a 0000 ce0a 0000 a20a 0000  2...............
+000080a0: a10a 0000 910a 0000 730a 0000 5b0a 0000  ........s...[...
+000080b0: 200a 0000 ed09 0000 b809 0000 8109 0000   ...............
+000080c0: 5e09 0000 3c09 0000 0009 0000 ba08 0000  ^...<...........
+000080d0: a008 0000 8608 0000 5c08 0000 1f08 0000  ........\.......
+000080e0: fd07 0000 e307 0000 9f07 0000 7507 0000  ............u...
+000080f0: 4d07 0000 3307 0000 1c07 0000 0a07 0000  M...3...........
+00008100: fb06 0000 f106 0000 be06 0000 bd06 0000  ................
+00008110: a806 0000 8406 0000 6b06 0000 5006 0000  ........k...P...
+00008120: 2a06 0000 0606 0000 e205 0000 c405 0000  *...............
+00008130: 9f05 0000 7805 0000 5005 0000 2305 0000  ....x...P...#...
+00008140: ff04 0000 f504 0000 e104 0000 cf04 0000  ................
+00008150: b304 0000 9904 0000 7f04 0000 6404 0000  ............d...
+00008160: 4a04 0000 3604 0000 1b04 0000 fe03 0000  J...6...........
+00008170: e003 0000 c603 0000 bc03 0000 8503 0000  ................
+00008180: 5203 0000 0f03 0000 d802 0000 c102 0000  R...............
+00008190: 7102 0000 5302 0000 3402 0000 3202 0000  q...S...4...2...
+000081a0: 1e02 0000 0802 0000 d501 0000 3a02 0000  ............:...
+000081b0: 1202 0000 e701 0000 cc01 0000 0000 0000  ................
+000081c0: 0000 0000 0000 0000 0000 0000 0020 2020  .............   
+000081d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00008200: 6f70 696e 696f 6e73 2020 2020 2020 2020  opinions        
+00008210: 2020 2020 7365 6c66 2e5f 6f70 696e 2020      self._opin  
+00008220: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00008230: 6f70 2020 2020 2020 2020 2020 2020 2020  op              
+00008240: 7365 6c66 2e5f 6f70 696e 696f 6e73 5f66  self._opinions_f
+00008250: 6e2c 0020 2020 2020 2020 2063 6875 6e6b  n,.        chunk
+00008260: 7320 3d20 7064 2e72 6561 645f 6373 7628  s = pd.read_csv(
+00008270: 0020 2020 2020 2020 2023 2057 6520 6361  .        # We ca
+00008280: 6e20 7573 6520 6120 7769 7468 2073 7461  n use a with sta
+00008290: 7465 6d65 6e74 2074 6f20 656e 7375 7265  tement to ensure
+000082a0: 2074 6872 6561 6473 2061 7265 2063 6c65   threads are cle
+000082b0: 616e 6564 2075 7020 7072 6f6d 7074 6c79  aned up promptly
+000082c0: 0020 2020 2020 2020 206c 6f67 2e64 6562  .        log.deb
+000082d0: 7567 286d 7367 2900 2020 2020 2020 2020  ug(msg).        
+000082e0: 6d73 6720 3d20 6622 4669 6c65 2053 697a  msg = f"File Siz
+000082f0: 6520 6973 203a 207b 7374 7228 6669 6c65  e is : {str(file
+00008300: 5f73 697a 655f 6762 297d 2047 4222 0020  _size_gb)} GB". 
+00008310: 2020 2020 2020 206c 6f67 2e64 6562 7567         log.debug
+00008320: 2866 2249 6d70 6f72 7469 6e67 207b 7365  (f"Importing {se
+00008330: 6c66 2e5f 6f70 696e 696f 6e73 5f66 6e7d  lf._opinions_fn}
+00008340: 2061 7320 6120 6461 7461 6672 616d 6522   as a dataframe"
+00008350: 2900 2020 2020 2020 2020 6669 6c65 5f73  ).        file_s
+00008360: 697a 655f 6762 203d 2072 6f75 6e64 2866  ize_gb = round(f
+00008370: 696c 655f 7369 7a65 202f 2031 302a 2a39  ile_size / 10**9
+00008380: 2c20 3229 0020 2020 2020 2020 2066 696c  , 2).        fil
+00008390: 655f 7369 7a65 203d 206f 732e 7061 7468  e_size = os.path
+000083a0: 2e67 6574 7369 7a65 2873 656c 662e 5f6f  .getsize(self._o
+000083b0: 7069 6e69 6f6e 735f 666e 2900 2020 2020  pinions_fn).    
+000083c0: 2020 2020 5d00 2020 2020 2020 2020 2020      ].          
+000083d0: 2020 226c 6f63 616c 5f70 6174 6822 2c00    "local_path",.
+000083e0: 2020 2020 2020 2020 2020 2020 2268 746d              "htm
+000083f0: 6c5f 616e 6f6e 5f32 3032 3022 2c00 2020  l_anon_2020",.  
+00008400: 2020 2020 2020 2020 2020 2268 746d 6c5f            "html_
+00008410: 636f 6c75 6d62 6961 222c 0020 2020 2020  columbia",.     
+00008420: 2020 2020 2020 2022 6874 6d6c 5f6c 6177         "html_law
+00008430: 626f 7822 2c00 2020 2020 2020 2020 2020  box",.          
+00008440: 2020 2268 746d 6c22 2c00 2020 2020 2020    "html",.      
+00008450: 2020 2020 2020 2270 6c61 696e 5f74 6578        "plain_tex
+00008460: 7422 2c00 2020 2020 2020 2020 2020 2020  t",.            
+00008470: 2278 6d6c 5f68 6172 7661 7264 222c 0020  "xml_harvard",. 
+00008480: 2020 2020 2020 2020 2020 2022 636c 7573             "clus
+00008490: 7465 725f 6964 222c 0020 2020 2020 2020  ter_id",.       
+000084a0: 2020 2020 2022 6c6f 6361 6c5f 7061 7468       "local_path
+000084b0: 222c 0020 2020 2020 2020 2020 2020 2022  ",.            "
+000084c0: 646f 776e 6c6f 6164 5f75 726c 222c 0020  download_url",. 
+000084d0: 2020 2020 2020 2020 2020 2022 6964 222c             "id",
+000084e0: 0020 2020 2020 2020 2075 7365 636f 6c73  .        usecols
+000084f0: 203d 205b 0020 2020 2020 2020 207d 0020   = [.        }. 
+00008500: 2020 2020 2020 2020 2020 2022 6c6f 6361             "loca
+00008510: 6c5f 7061 7468 223a 2022 7374 7269 6e67  l_path": "string
+00008520: 222c 0020 2020 2020 2020 2020 2020 2022  ",.            "
+00008530: 6874 6d6c 5f77 6974 685f 6369 7461 7469  html_with_citati
+00008540: 6f6e 7322 3a20 2273 7472 696e 6722 2c00  ons": "string",.
+00008550: 2020 2020 2020 2020 2020 2020 2268 746d              "htm
+00008560: 6c5f 616e 6f6e 5f32 3032 3022 3a20 2273  l_anon_2020": "s
+00008570: 7472 696e 6722 2c00 2020 2020 2020 2020  tring",.        
+00008580: 2020 2020 2268 746d 6c5f 636f 6c75 6d62      "html_columb
+00008590: 6961 223a 2022 7374 7269 6e67 222c 0020  ia": "string",. 
+000085a0: 2020 2020 2020 2020 2020 2022 6874 6d6c             "html
+000085b0: 5f6c 6177 626f 7822 3a20 2273 7472 696e  _lawbox": "strin
+000085c0: 6722 2c00 2020 2020 2020 2020 2020 2020  g",.            
+000085d0: 2268 746d 6c22 3a20 2273 7472 696e 6722  "html": "string"
+000085e0: 2c00 2020 2020 2020 2020 2020 2020 2270  ,.            "p
+000085f0: 6c61 696e 5f74 6578 7422 3a20 2273 7472  lain_text": "str
+00008600: 696e 6722 2c00 2020 2020 2020 2020 2020  ing",.          
+00008610: 2020 226c 6f63 616c 5f70 6174 6822 3a20    "local_path": 
+00008620: 2273 7472 696e 6722 2c00 2020 2020 2020  "string",.      
+00008630: 2020 2020 2020 2264 6f77 6e6c 6f61 645f        "download_
+00008640: 7572 6c22 3a20 2273 7472 696e 6722 2c00  url": "string",.
+00008650: 2020 2020 2020 2020 6f70 696e 696f 6e5f          opinion_
+00008660: 6474 7970 6573 203d 207b 0020 2020 2020  dtypes = {.     
+00008670: 2020 206d 6178 5f72 6f77 7320 3d20 315f     max_rows = 1_
+00008680: 3030 3000 2020 2020 2020 2020 7374 6172  000.        star
+00008690: 7420 3d20 7469 6d65 2e70 6572 665f 636f  t = time.perf_co
+000086a0: 756e 7465 7228 2900 2020 2020 6465 6620  unter().    def 
+000086b0: 7374 6172 7428 7365 6c66 293a 0000 2020  start(self):..  
+000086c0: 2020 2020 2020 7265 7475 726e 206a 736f        return jso
+000086d0: 6e2e 6475 6d70 7328 6f62 6a2c 2063 6c73  n.dumps(obj, cls
+000086e0: 3d73 656c 662e 4e70 456e 636f 6465 7229  =self.NpEncoder)
+000086f0: 0020 2020 2020 2020 207d 0020 2020 2020  .        }.     
+00008700: 2020 2020 2020 207d 2c00 2020 2020 2020         },.      
+00008710: 2020 2020 2020 2020 2020 7d00 2020 2020            }.    
+00008720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008730: 5d2c 0020 2020 2020 2020 2020 2020 2020  ],.             
+00008740: 2020 2020 2020 2020 2020 207d 0020 2020             }.   
+00008750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008760: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+00008770: 2022 222c 0020 2020 2020 2020 2020 2020   "",.           
+00008780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008790: 2022 6175 7468 6f72 223a 2022 222c 0020   "author": "",. 
+000087a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000087b0: 2020 2020 2020 2020 2020 2022 7465 7874             "text
+000087c0: 223a 2073 656c 662e 6765 745f 6f70 696e  ": self.get_opin
+000087d0: 696f 6e5f 7465 7874 286f 7069 6e69 6f6e  ion_text(opinion
+000087e0: 292c 0020 2020 2020 2020 2020 2020 2020  ),.             
+000087f0: 2020 2020 2020 2020 2020 207b 0020 2020             {.   
+00008800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008810: 2022 6f70 696e 696f 6e73 223a 205b 0020   "opinions": [. 
+00008820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008830: 2020 2022 6865 6164 5f6d 6174 7465 7222     "head_matter"
+00008840: 3a20 636c 7573 7465 725f 726f 775b 2768  : cluster_row['h
+00008850: 6561 646e 6f74 6573 275d 2c00 2020 2020  eadnotes'],.    
+00008860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008870: 226a 7564 6765 7322 3a20 6a75 6467 655f  "judges": judge_
+00008880: 6c69 7374 2c00 2020 2020 2020 2020 2020  list,.          
+00008890: 2020 2020 2020 2264 6174 6122 3a20 7b00        "data": {.
+000088a0: 2020 2020 2020 2020 2020 2020 2263 6173              "cas
+000088b0: 6562 6f64 7922 3a20 7b00 2020 2020 2020  ebody": {.      
+000088c0: 2020 2020 2020 226a 7572 6973 6469 6374        "jurisdict
+000088d0: 696f 6e22 3a20 7b22 6e61 6d65 223a 2063  ion": {"name": c
+000088e0: 6f75 7274 5f72 6f77 2e6a 7572 6973 6469  ourt_row.jurisdi
+000088f0: 6374 696f 6e2e 696c 6f63 5b30 5d7d 2c00  ction.iloc[0]},.
+00008900: 2020 2020 2020 2020 2020 2020 2263 6f75              "cou
+00008910: 7274 223a 207b 226e 616d 6522 3a20 636f  rt": {"name": co
+00008920: 7572 745f 726f 772e 6675 6c6c 5f6e 616d  urt_row.full_nam
+00008930: 652e 696c 6f63 5b30 5d7d 2c00 2020 2020  e.iloc[0]},.    
+00008940: 2020 2020 2020 2020 2263 6974 6573 5f74          "cites_t
+00008950: 6f22 3a20 6369 7465 735f 746f 2c00 2020  o": cites_to,.  
+00008960: 2020 2020 2020 2020 2020 2263 6974 6174            "citat
+00008970: 696f 6e73 223a 2063 6974 6564 5f62 792c  ions": cited_by,
+00008980: 0020 2020 2020 2020 2020 2020 2022 646f  .            "do
+00008990: 636b 6574 5f6e 756d 6265 7222 3a20 636c  cket_number": cl
+000089a0: 7573 7465 725f 726f 775b 2264 6f63 6b65  uster_row["docke
+000089b0: 745f 6964 225d 2c00 2020 2020 2020 2020  t_id"],.        
+000089c0: 2020 2020 2264 6563 6973 696f 6e5f 6461      "decision_da
+000089d0: 7465 223a 2022 222c 2020 2320 6461 7465  te": "",  # date
+000089e0: 5f74 6572 6d69 6e61 7465 642c 0020 2020  _terminated,.   
+000089f0: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
+00008a00: 2063 6c75 7374 6572 5f72 6f77 5b22 6361   cluster_row["ca
+00008a10: 7365 5f6e 616d 655f 6675 6c6c 225d 2c00  se_name_full"],.
+00008a20: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
+00008a30: 655f 6162 6272 6576 6961 7469 6f6e 223a  e_abbreviation":
+00008a40: 2063 6c75 7374 6572 5f72 6f77 5b22 6361   cluster_row["ca
+00008a50: 7365 5f6e 616d 6522 5d2c 0020 2020 2020  se_name"],.     
+00008a60: 2020 2020 2020 2022 7572 6c22 3a20 7572         "url": ur
+00008a70: 6c2c 0020 2020 2020 2020 2020 2020 2022  l,.            "
+00008a80: 6964 223a 2063 6c75 7374 6572 5f69 642c  id": cluster_id,
+00008a90: 0020 2020 2020 2020 206f 626a 203d 207b  .        obj = {
+00008aa0: 0000 2020 2020 2020 2020 7572 6c20 3d20  ..        url = 
+00008ab0: 2222 2020 2320 6f70 696e 696f 6e5b 2764  ""  # opinion['d
+00008ac0: 6f77 6e6c 6f61 645f 7572 6c27 5d00 2020  ownload_url'].  
+00008ad0: 2020 2020 2020 2323 2064 6f77 6e6c 6f61        ## downloa
+00008ae0: 6420 7572 6c20 6d61 7920 616c 736f 2062  d url may also b
+00008af0: 6520 6d69 7373 696e 6700 2020 2020 2020  e missing.      
+00008b00: 2020 6461 7465 5f74 6572 6d69 6e61 7465    date_terminate
+00008b10: 6420 3d20 646f 636b 6574 5f72 6f77 5b22  d = docket_row["
+00008b20: 6461 7465 5f74 6572 6d69 6e61 7465 6422  date_terminated"
+00008b30: 5d00 2020 2020 2020 2020 2323 2073 6f6d  ].        ## som
+00008b40: 6574 696d 6573 2064 6174 655f 7465 726d  etimes date_term
+00008b50: 696e 6174 6564 206d 6179 2062 6520 6d69  inated may be mi
+00008b60: 7373 696e 6720 616e 6420 7265 636f 7264  ssing and record
+00008b70: 6564 2061 7320 4e61 4e00 2020 2020 2020  ed as NaN.      
+00008b80: 2020 2300 2020 2020 2020 2020 5d00 2020    #.        ].  
+00008b90: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00008ba0: 2072 652e 6d61 7463 6828 225b 636a 5d3f   re.match("[cj]?
+00008bb0: 6a5c 2e22 2c20 6a75 6467 6529 0020 2020  j\.", judge).   
+00008bc0: 2020 2020 2020 2020 2066 6f72 206a 7564           for jud
+00008bd0: 6765 2069 6e20 286a 7564 6765 732e 7370  ge in (judges.sp
+00008be0: 6c69 7428 222c 2229 2069 6620 6a75 6467  lit(",") if judg
+00008bf0: 6573 2065 6c73 6520 5b5d 2900 2020 2020  es else []).    
+00008c00: 2020 2020 2020 2020 6a75 6467 6500 2020          judge.  
+00008c10: 2020 2020 2020 6a75 6467 655f 6c69 7374        judge_list
+00008c20: 203d 205b 0020 2020 2020 2020 206a 7564   = [.        jud
+00008c30: 6765 7320 3d20 636c 7573 7465 725f 726f  ges = cluster_ro
+00008c40: 775b 226a 7564 6765 7322 5d00 2020 2020  w["judges"].    
+00008c50: 2020 2020 2320 6a75 6467 6573 0000 2020      # judges..  
+00008c60: 2020 2020 2020 6369 7465 645f 6279 203d        cited_by =
+00008c70: 2073 656c 662e 6369 7465 645f 6279 5b6f   self.cited_by[o
+00008c80: 7069 6e69 6f6e 5f69 645d 2069 6620 6f70  pinion_id] if op
+00008c90: 696e 696f 6e5f 6964 2069 6e20 7365 6c66  inion_id in self
+00008ca0: 2e63 6974 6564 5f62 7920 656c 7365 205b  .cited_by else [
+00008cb0: 5d00 2020 2020 2020 2020 6369 7465 735f  ].        cites_
+00008cc0: 746f 203d 2073 656c 662e 6369 7465 735f  to = self.cites_
+00008cd0: 746f 5b6f 7069 6e69 6f6e 5f69 645d 2069  to[opinion_id] i
+00008ce0: 6620 6f70 696e 696f 6e5f 6964 2069 6e20  f opinion_id in 
+00008cf0: 7365 6c66 2e63 6974 6573 5f74 6f20 656c  self.cites_to el
+00008d00: 7365 205b 5d00 2020 2020 2020 2020 2320  se [].        # 
+00008d10: 6765 7420 6f70 696e 696f 6e73 2063 6974  get opinions cit
+00008d20: 6564 2074 6f00 0020 2020 2020 2020 2020  ed to..         
+00008d30: 2020 2072 6574 7572 6e00 2020 2020 2020     return.      
+00008d40: 2020 6966 2063 6f75 7274 5f72 6f77 2e65    if court_row.e
+00008d50: 6d70 7479 3a00 2020 2020 2020 2020 636f  mpty:.        co
+00008d60: 7572 745f 726f 773a 2073 656c 662e 4461  urt_row: self.Da
+00008d70: 7461 4672 616d 6520 3d20 636f 7572 7473  taFrame = courts
+00008d80: 5b63 6f75 7274 735b 2269 6422 5d20 3d3d  [courts["id"] ==
+00008d90: 2063 6964 5d00 2020 2020 2020 2020 6369   cid].        ci
+00008da0: 6420 3d20 646f 636b 6574 5f72 6f77 5b22  d = docket_row["
+00008db0: 636f 7572 745f 6964 225d 0020 2020 2020  court_id"].     
+00008dc0: 2020 2020 2020 2072 6574 7572 6e00 2020         return.  
+00008dd0: 2020 2020 2020 6966 206e 6f74 2064 6f63        if not doc
+00008de0: 6b65 745f 726f 773a 0020 2020 2020 2020  ket_row:.       
+00008df0: 2023 2072 6574 7572 6e20 6561 726c 7920   # return early 
+00008e00: 6966 2074 6865 7265 2773 0020 2020 2020  if there's.     
+00008e10: 2020 2023 2067 6574 2063 6f72 7265 7370     # get corresp
+00008e20: 6f6e 6469 6e67 2072 6f77 2066 726f 6d20  onding row from 
+00008e30: 646f 636b 6574 2064 6620 6261 7365 6420  docket df based 
+00008e40: 6f6e 2063 6c75 7374 6572 206f 7069 6e69  on cluster opini
+00008e50: 6f6e 2069 6400 0020 2020 2020 2020 2063  on id..        c
+00008e60: 6c75 7374 6572 5f69 6420 3d20 6f70 696e  luster_id = opin
+00008e70: 696f 6e5b 2263 6c75 7374 6572 5f69 6422  ion["cluster_id"
+00008e80: 5d00 2020 2020 2020 2020 6f70 696e 696f  ].        opinio
+00008e90: 6e5f 6964 203d 206f 7069 6e69 6f6e 5b22  n_id = opinion["
+00008ea0: 6964 225d 0020 2020 2020 2020 2063 6f75  id"].        cou
+00008eb0: 7274 7320 3d20 7365 6c66 2e67 6574 5f63  rts = self.get_c
+00008ec0: 6f75 7274 735f 6466 2829 0020 2020 2064  ourts_df().    d
+00008ed0: 6566 2070 726f 6365 7373 5f72 6f77 2873  ef process_row(s
+00008ee0: 656c 662c 206f 7069 6e69 6f6e 2c20 636c  elf, opinion, cl
+00008ef0: 7573 7465 725f 726f 772c 2064 6f63 6b65  uster_row, docke
+00008f00: 745f 726f 7729 202d 3e20 6469 6374 3a00  t_row) -> dict:.
+00008f10: 2020 2020 2320 5468 6973 2069 7320 6120      # This is a 
+00008f20: 6865 6c70 6572 2066 756e 6374 696f 6e20  helper function 
+00008f30: 7468 6174 2063 6f6e 6e65 6374 7320 6f70  that connects op
+00008f40: 696e 696f 6e73 2074 6f20 636f 7572 7473  inions to courts
+00008f50: 2c20 646f 636b 6574 732c 2063 6974 6174  , dockets, citat
+00008f60: 696f 6e73 2065 7463 2e2c 0020 2020 2023  ions etc.,.    #
+00008f70: 2320 4865 6c70 6572 2066 756e 6374 696f  # Helper functio
+00008f80: 6e20 746f 2070 726f 6365 7373 2065 6163  n to process eac
+00008f90: 6820 726f 7720 696e 2074 6865 206f 7069  h row in the opi
+00008fa0: 6e69 6f6e 7320 6461 7461 6672 616d 6500  nions dataframe.
+00008fb0: 0020 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00008fc0: 6c69 7374 286d 6170 2873 656c 662e 7072  list(map(self.pr
+00008fd0: 6f63 6573 735f 726f 772c 2064 665f 6469  ocess_row, df_di
+00008fe0: 6374 2c20 636c 7573 7465 725f 726f 7773  ct, cluster_rows
+00008ff0: 2c20 646f 636b 6574 5f72 6f77 7329 2900  , docket_rows)).
+00009000: 6164 0000 5701 0000 1b03 0000 0010 0000  ad..W...........
+00009010: 6a00 0000 0000 0000 ff0f 0000 e50f 0000  j...............
+00009020: c90f 0000 890f 0000 7d0f 0000 720f 0000  ........}...r...
+00009030: 520f 0000 440f 0000 390f 0000 280f 0000  R...D...9...(...
+00009040: 270f 0000 1a0f 0000 080f 0000 b50e 0000  '...............
+00009050: ae0e 0000 8c0e 0000 640e 0000 2c0e 0000  ........d...,...
+00009060: 080e 0000 e20d 0000 ba0d 0000 b90d 0000  ................
+00009070: 890d 0000 440d 0000 090d 0000 ff0c 0000  ....D...........
+00009080: c40c 0000 740c 0000 730c 0000 3d0c 0000  ....t...s...=...
+00009090: 0c0c 0000 0b0c 0000 f60b 0000 ab0b 0000  ................
+000090a0: 570b 0000 0d0b 0000 c30a 0000 730a 0000  W...........s...
+000090b0: 550a 0000 2e0a 0000 2d0a 0000 140a 0000  U.......-.......
+000090c0: 060a 0000 f409 0000 e009 0000 c809 0000  ................
+000090d0: b409 0000 9a09 0000 8409 0000 6c09 0000  ............l...
+000090e0: 6509 0000 5109 0000 3709 0000 1809 0000  e...Q...7.......
+000090f0: 0209 0000 e208 0000 c908 0000 a408 0000  ................
+00009100: 8708 0000 6608 0000 5b08 0000 3808 0000  ....f...[...8...
+00009110: 2208 0000 fe07 0000 dc07 0000 c007 0000  "...............
+00009120: bf07 0000 8007 0000 6d07 0000 5f07 0000  ........m..._...
+00009130: 4d07 0000 3907 0000 1f07 0000 0d07 0000  M...9...........
+00009140: f606 0000 e006 0000 c806 0000 c106 0000  ................
+00009150: 9d06 0000 6f06 0000 3c06 0000 0206 0000  ....o...<.......
+00009160: cb05 0000 b405 0000 a205 0000 8005 0000  ................
+00009170: 6405 0000 3e05 0000 2005 0000 fd04 0000  d...>... .......
+00009180: d904 0000 b804 0000 8b04 0000 6604 0000  ............f...
+00009190: 3d04 0000 2b04 0000 1d04 0000 0f04 0000  =...+...........
+000091a0: f103 0000 d703 0000 ba03 0000 9103 0000  ................
+000091b0: 7003 0000 4b03 0000 3d03 0000 1b03 0000  p...K...=.......
+000091c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000091d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000091e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000091f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009310: 0000 0000 0000 0000 0000 0020 2020 2020  ...........     
+00009320: 2020 2065 6e64 203d 2074 696d 652e 7065     end = time.pe
+00009330: 7266 5f63 6f75 6e74 6572 2829 0020 2020  rf_counter().   
+00009340: 2020 2020 2020 2020 2029 0020 2020 2020           ).     
+00009350: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00009360: 5f63 6f6c 3d69 6e64 6578 5f63 6f6c 2c00  _col=index_col,.
+00009370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009380: 7573 6563 6f6c 733d 7573 6563 6f6c 732c  usecols=usecols,
+00009390: 0020 2020 2020 2020 2020 2020 2020 2020  .               
+000093a0: 2070 6172 7365 5f64 6174 6573 3d70 6172   parse_dates=par
+000093b0: 7365 5f64 6174 6573 2c00 2020 2020 2020  se_dates,.      
+000093c0: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
+000093d0: 6474 7970 652c 0020 2020 2020 2020 2020  dtype,.         
+000093e0: 2020 2020 2020 2066 696c 656e 616d 652c         filename,
+000093f0: 0020 2020 2020 2020 2020 2020 2064 6620  .            df 
+00009400: 3d20 7064 2e72 6561 645f 6373 7628 0020  = pd.read_csv(. 
+00009410: 2020 2020 2020 2065 6c73 653a 0020 2020         else:.   
+00009420: 2020 2020 2020 2020 2029 0020 2020 2020           ).     
+00009430: 2020 2020 2020 2020 2020 2029 0020 2020             ).   
+00009440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009450: 2069 6e64 6578 5f63 6f6c 3d69 6e64 6578   index_col=index
+00009460: 5f63 6f6c 2c00 2020 2020 2020 2020 2020  _col,.          
+00009470: 2020 2020 2020 2020 2020 7573 6563 6f6c            usecol
+00009480: 733d 7573 6563 6f6c 732c 0020 2020 2020  s=usecols,.     
+00009490: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000094a0: 6172 7365 5f64 6174 6573 3d70 6172 7365  arse_dates=parse
+000094b0: 5f64 6174 6573 2c00 2020 2020 2020 2020  _dates,.        
+000094c0: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+000094d0: 653d 6474 7970 652c 0020 2020 2020 2020  e=dtype,.       
+000094e0: 2020 2020 2020 2020 2020 2020 206d 6178               max
+000094f0: 5f72 6f77 733d 3130 2a2a 372c 0020 2020  _rows=10**7,.   
+00009500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009510: 206e 756d 5f64 6673 3d31 302a 2a35 2c00   num_dfs=10**5,.
+00009520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009530: 2020 2020 6669 6c65 6e61 6d65 2c00 2020      filename,.  
+00009540: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00009550: 6c66 2e72 6561 645f 6373 765f 6173 5f64  lf.read_csv_as_d
+00009560: 6673 2800 2020 2020 2020 2020 2020 2020  fs(.            
+00009570: 6466 203d 2070 642e 636f 6e63 6174 2800  df = pd.concat(.
+00009580: 2020 2020 2020 2020 6966 2066 696c 655f          if file_
+00009590: 7369 7a65 5f67 6220 3e20 6d61 785f 6762  size_gb > max_gb
+000095a0: 3a00 2020 2020 2020 2020 6466 203d 204e  :.        df = N
+000095b0: 6f6e 6500 2020 2020 2020 2020 6c6f 672e  one.        log.
+000095c0: 6465 6275 6728 6d73 6729 0020 2020 2020  debug(msg).     
+000095d0: 2020 206d 7367 203d 2066 2246 696c 6520     msg = f"File 
+000095e0: 5369 7a65 2069 7320 3a20 7b73 7472 2866  Size is : {str(f
+000095f0: 696c 655f 7369 7a65 5f67 6229 7d20 4742  ile_size_gb)} GB
+00009600: 2200 2020 2020 2020 2020 6c6f 672e 6465  ".        log.de
+00009610: 6275 6728 6622 496d 706f 7274 696e 6720  bug(f"Importing 
+00009620: 7b66 696c 656e 616d 657d 2061 7320 6120  {filename} as a 
+00009630: 6461 7461 6672 616d 6522 2900 2020 2020  dataframe").    
+00009640: 2020 2020 6669 6c65 5f73 697a 655f 6762      file_size_gb
+00009650: 203d 2072 6f75 6e64 2866 696c 655f 7369   = round(file_si
+00009660: 7a65 202f 2031 302a 2a39 2c20 3229 0020  ze / 10**9, 2). 
+00009670: 2020 2020 2020 2066 696c 655f 7369 7a65         file_size
+00009680: 203d 206f 732e 7061 7468 2e67 6574 7369   = os.path.getsi
+00009690: 7a65 2866 696c 656e 616d 6529 0020 2020  ze(filename).   
+000096a0: 2020 2020 2073 7461 7274 203d 2074 696d       start = tim
+000096b0: 652e 7065 7266 5f63 6f75 6e74 6572 2829  e.perf_counter()
+000096c0: 0020 2020 2029 3a00 2020 2020 2020 2020  .    ):.        
+000096d0: 696e 6465 785f 636f 6c3d 4e6f 6e65 2c00  index_col=None,.
+000096e0: 2020 2020 2020 2020 7573 6563 6f6c 733d          usecols=
+000096f0: 4e6f 6e65 2c00 2020 2020 2020 2020 6e75  None,.        nu
+00009700: 6d5f 6466 733d 3130 2a2a 332c 0020 2020  m_dfs=10**3,.   
+00009710: 2020 2020 206d 6178 5f67 623d 352c 0020       max_gb=5,. 
+00009720: 2020 2020 2020 2070 6172 7365 5f64 6174         parse_dat
+00009730: 6573 3d4e 6f6e 652c 0020 2020 2020 2020  es=None,.       
+00009740: 2064 7479 7065 3d4e 6f6e 652c 0020 2020   dtype=None,.   
+00009750: 2020 2020 2066 696c 656e 616d 652c 0020       filename,. 
+00009760: 2020 2020 2020 2073 656c 662c 0020 2020         self,.   
+00009770: 2064 6566 2063 7376 5f74 6f5f 6466 2800   def csv_to_df(.
+00009780: 2020 2020 2320 6765 7420 6120 706f 7465      # get a pote
+00009790: 6e74 6961 6c6c 7920 6c61 7267 6520 6373  ntially large cs
+000097a0: 7620 616e 6420 7475 726e 2069 7420 696e  v and turn it in
+000097b0: 746f 2061 2044 6174 6146 7261 6d65 0000  to a DataFrame..
+000097c0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+000097d0: 6673 5f6f 7069 6e69 6f6e 7300 2020 2020  fs_opinions.    
+000097e0: 2020 2020 2020 2020 636f 756e 7465 7220          counter 
+000097f0: 3d20 636f 756e 7465 7220 2b20 3100 2020  = counter + 1.  
+00009800: 2020 2020 2020 2020 2020 6466 735f 6f70            dfs_op
+00009810: 696e 696f 6e73 2e61 7070 656e 6428 6466  inions.append(df
+00009820: 2900 2020 2020 2020 2020 2020 2020 2020  ).              
+00009830: 2020 6272 6561 6b00 2020 2020 2020 2020    break.        
+00009840: 2020 2020 6966 2063 6f75 6e74 6572 203e      if counter >
+00009850: 3d20 6e75 6d5f 6466 733a 0020 2020 2020  = num_dfs:.     
+00009860: 2020 2029 3a00 2020 2020 2020 2020 2020     ):.          
+00009870: 2020 696e 6465 785f 636f 6c3d 696e 6465    index_col=inde
+00009880: 785f 636f 6c2c 0020 2020 2020 2020 2020  x_col,.         
+00009890: 2020 2075 7365 636f 6c73 3d75 7365 636f     usecols=useco
+000098a0: 6c73 2c00 2020 2020 2020 2020 2020 2020  ls,.            
+000098b0: 7061 7273 655f 6461 7465 733d 7061 7273  parse_dates=pars
+000098c0: 655f 6461 7465 732c 0020 2020 2020 2020  e_dates,.       
+000098d0: 2020 2020 2064 7479 7065 3d64 7479 7065       dtype=dtype
+000098e0: 2c00 2020 2020 2020 2020 2020 2020 6368  ,.            ch
+000098f0: 756e 6b73 697a 653d 6d61 785f 726f 7773  unksize=max_rows
+00009900: 2c00 2020 2020 2020 2020 2020 2020 6669  ,.            fi
+00009910: 6c65 6e61 6d65 2c00 2020 2020 2020 2020  lename,.        
+00009920: 666f 7220 6466 2069 6e20 7064 2e72 6561  for df in pd.rea
+00009930: 645f 6373 7628 0020 2020 2020 2020 2064  d_csv(.        d
+00009940: 6673 5f6f 7069 6e69 6f6e 7320 3d20 5b5d  fs_opinions = []
+00009950: 0020 2020 2020 2020 2063 6f75 6e74 6572  .        counter
+00009960: 203d 2030 0020 2020 2029 3a00 2020 2020   = 0.    ):.    
+00009970: 2020 2020 696e 6465 785f 636f 6c3d 4e6f      index_col=No
+00009980: 6e65 2c00 2020 2020 2020 2020 7573 6563  ne,.        usec
+00009990: 6f6c 733d 4e6f 6e65 2c00 2020 2020 2020  ols=None,.      
+000099a0: 2020 7061 7273 655f 6461 7465 733d 4e6f    parse_dates=No
+000099b0: 6e65 2c00 2020 2020 2020 2020 6474 7970  ne,.        dtyp
+000099c0: 653d 4e6f 6e65 2c00 2020 2020 2020 2020  e=None,.        
+000099d0: 6d61 785f 726f 7773 3d31 302a 2a35 2c00  max_rows=10**5,.
+000099e0: 2020 2020 2020 2020 6e75 6d5f 6466 733d          num_dfs=
+000099f0: 3130 2c00 2020 2020 2020 2020 6669 6c65  10,.        file
+00009a00: 6e61 6d65 2c00 2020 2020 2020 2020 7365  name,.        se
+00009a10: 6c66 2c00 2020 2020 6465 6620 7265 6164  lf,.    def read
+00009a20: 5f63 7376 5f61 735f 6466 7328 0000 2020  _csv_as_dfs(..  
+00009a30: 2020 2020 2020 4e6f 4361 7028 6f2c 206f        NoCap(o, o
+00009a40: 632c 2063 2c20 642c 2063 6d29 2e73 7461  c, c, d, cm).sta
+00009a50: 7274 2829 0020 2020 2064 6566 2063 6c69  rt().    def cli
+00009a60: 286f 2c20 6f63 2c20 632c 2064 2c20 636d  (o, oc, c, d, cm
+00009a70: 293a 0020 2020 2040 636c 6963 6b2e 6f70  ):.    @click.op
+00009a80: 7469 6f6e 2822 2d63 6d22 2c20 6865 6c70  tion("-cm", help
+00009a90: 3d22 6c6f 6361 6c20 7061 7468 2074 6f20  ="local path to 
+00009aa0: 6369 7461 7469 6f6e 206d 6170 2066 696c  citation map fil
+00009ab0: 6522 2c20 7265 7175 6972 6564 3d54 7275  e", required=Tru
+00009ac0: 6529 0020 2020 2040 636c 6963 6b2e 6f70  e).    @click.op
+00009ad0: 7469 6f6e 2822 2d64 222c 2068 656c 703d  tion("-d", help=
+00009ae0: 226c 6f63 616c 2070 6174 6820 746f 2064  "local path to d
+00009af0: 6f63 6b65 7473 2066 696c 6522 2c20 7265  ockets file", re
+00009b00: 7175 6972 6564 3d54 7275 6529 0020 2020  quired=True).   
+00009b10: 2040 636c 6963 6b2e 6f70 7469 6f6e 2822   @click.option("
+00009b20: 2d63 222c 2068 656c 703d 226c 6f63 616c  -c", help="local
+00009b30: 2070 6174 6820 746f 2063 6f75 7274 7320   path to courts 
+00009b40: 6669 6c65 2022 2c20 7265 7175 6972 6564  file ", required
+00009b50: 3d54 7275 6529 0020 2020 2040 636c 6963  =True).    @clic
+00009b60: 6b2e 6f70 7469 6f6e 2822 2d6f 6322 2c20  k.option("-oc", 
+00009b70: 6865 6c70 3d22 6c6f 6361 6c20 7061 7468  help="local path
+00009b80: 2074 6f20 6f70 696e 696f 6e20 636c 7573   to opinion clus
+00009b90: 7465 7273 2066 696c 6522 2c20 7265 7175  ters file", requ
+00009ba0: 6972 6564 3d54 7275 6529 0020 2020 2040  ired=True).    @
+00009bb0: 636c 6963 6b2e 6f70 7469 6f6e 2822 2d6f  click.option("-o
+00009bc0: 222c 2068 656c 703d 226c 6f63 616c 2070  ", help="local p
+00009bd0: 6174 6820 746f 206f 7069 6e69 6f6e 7320  ath to opinions 
+00009be0: 6669 6c65 222c 2072 6571 7569 7265 643d  file", required=
+00009bf0: 5472 7565 2900 2020 2020 4063 6c69 636b  True).    @click
+00009c00: 2e63 6f6d 6d61 6e64 2829 0000 2020 2020  .command()..    
+00009c10: 2020 2020 7365 6c66 2e44 6174 6146 7261      self.DataFra
+00009c20: 6d65 203d 2070 642e 636f 7265 2e66 7261  me = pd.core.fra
+00009c30: 6d65 2e44 6174 6146 7261 6d65 0020 2020  me.DataFrame.   
+00009c40: 2020 2020 2023 2073 656c 662e 5f64 665f       # self._df_
+00009c50: 6f70 696e 696f 6e73 203d 2073 656c 662e  opinions = self.
+00009c60: 696e 6974 5f6f 7069 6e69 6f6e 735f 6466  init_opinions_df
+00009c70: 2829 0000 2020 2020 2020 2020 7365 6c66  ()..        self
+00009c80: 2e5f 6466 5f64 6f63 6b65 7473 203d 2073  ._df_dockets = s
+00009c90: 656c 662e 696e 6974 5f64 6f63 6b65 7473  elf.init_dockets
+00009ca0: 5f64 6963 7428 646f 636b 6574 735f 666e  _dict(dockets_fn
+00009cb0: 2c20 2264 6f63 6b65 7473 2e73 716c 6974  , "dockets.sqlit
+00009cc0: 6522 2900 2020 2020 2020 2020 7365 6c66  e").        self
+00009cd0: 2e69 6e69 745f 6369 7461 7469 6f6e 5f64  .init_citation_d
+00009ce0: 6963 7428 2920 2373 656c 662e 696e 6974  ict() #self.init
+00009cf0: 5f63 6974 6174 696f 6e5f 6466 2829 0020  _citation_df(). 
+00009d00: 2020 2020 2020 2029 0020 2020 2020 2020         ).       
+00009d10: 2020 2020 206f 7069 6e69 6f6e 5f63 6c75       opinion_clu
+00009d20: 7374 6572 735f 666e 2c20 226f 7069 6e69  sters_fn, "opini
+00009d30: 6f6e 5f63 6c75 7374 6572 732e 7371 6c69  on_clusters.sqli
+00009d40: 7465 2200 2020 2020 2020 2020 7365 6c66  te".        self
+00009d50: 2e5f 6466 5f6f 7069 6e69 6f6e 5f63 6c75  ._df_opinion_clu
+00009d60: 7374 6572 7320 3d20 7365 6c66 2e69 6e69  sters = self.ini
+00009d70: 745f 6f70 696e 696f 6e5f 636c 7573 7465  t_opinion_cluste
+00009d80: 7273 5f64 6963 7428 0020 2020 2020 2020  rs_dict(.       
+00009d90: 2073 656c 662e 5f64 665f 636f 7572 7473   self._df_courts
+00009da0: 203d 2073 656c 662e 696e 6974 5f63 6f75   = self.init_cou
+00009db0: 7274 735f 6466 2829 0000 2020 2020 2020  rts_df()..      
+00009dc0: 2020 7365 6c66 2e5f 6369 7461 7469 6f6e    self._citation
+00009dd0: 5f66 6e20 3d20 6369 7461 7469 6f6e 5f66  _fn = citation_f
+00009de0: 6e00 2020 2020 2020 2020 7365 6c66 2e5f  n.        self._
+00009df0: 646f 636b 6574 735f 666e 203d 2064 6f63  dockets_fn = doc
+00009e00: 6b65 7473 5f66 6e00 2020 2020 2020 2020  kets_fn.        
+00009e10: 7365 6c66 2e5f 636f 7572 7473 5f66 6e20  self._courts_fn 
+00009e20: 3d20 636f 7572 7473 5f66 6e00 2020 2020  = courts_fn.    
+00009e30: 2020 2020 7365 6c66 2e5f 6f70 696e 696f      self._opinio
+00009e40: 6e5f 636c 7573 7465 7273 5f66 6e20 3d20  n_clusters_fn = 
+00009e50: 6f70 696e 696f 6e5f 636c 7573 7465 7273  opinion_clusters
+00009e60: 5f66 6e00 2020 2020 2020 2020 7365 6c66  _fn.        self
+00009e70: 2e5f 6f70 696e 696f 6e73 5f66 6e20 3d20  ._opinions_fn = 
+00009e80: 6f70 696e 696f 6e73 5f66 6e00 2020 2020  opinions_fn.    
+00009e90: 2020 2020 6c6f 672e 6465 6275 6728 2249      log.debug("I
+00009ea0: 6e69 7469 616c 697a 696e 6722 2900 2020  nitializing").  
+00009eb0: 2020 293a 0020 2020 2020 2020 2073 656c    ):.        sel
+00009ec0: 662c 206f 7069 6e69 6f6e 735f 666e 2c20  f, opinions_fn, 
+00009ed0: 6f70 696e 696f 6e5f 636c 7573 7465 7273  opinion_clusters
+00009ee0: 5f66 6e2c 2063 6f75 7274 735f 666e 2c20  _fn, courts_fn, 
+00009ef0: 646f 636b 6574 735f 666e 2c20 6369 7461  dockets_fn, cita
+00009f00: 7469 6f6e 5f66 6e00 2020 2020 6465 6620  tion_fn.    def 
+00009f10: 5f5f 696e 6974 5f5f 2800 636c 6173 7320  __init__(.class 
+00009f20: 4e6f 4361 703a 0000 696d 706f 7274 2074  NoCap:..import t
+00009f30: 6872 6561 6469 6e67 0069 6d70 6f72 7420  hreading.import 
+00009f40: 627a 3200 696d 706f 7274 2070 6963 6b6c  bz2.import pickl
+00009f50: 6500 6373 762e 6669 656c 645f 7369 7a65  e.csv.field_size
+00009f60: 5f6c 696d 6974 2831 5f30 3030 5f30 3030  _limit(1_000_000
+00009f70: 2900 696d 706f 7274 2063 7376 0069 6d70  ).import csv.imp
+00009f80: 6f72 7420 6a73 6f6e 0066 726f 6d20 636f  ort json.from co
+00009f90: 6e63 7572 7265 6e74 2e66 7574 7572 6573  ncurrent.futures
+00009fa0: 2069 6d70 6f72 7420 5468 7265 6164 506f   import ThreadPo
+00009fb0: 6f6c 4578 6563 7574 6f72 2c20 6173 5f63  olExecutor, as_c
+00009fc0: 6f6d 706c 6574 6564 006c 6f67 2e73 6574  ompleted.log.set
+00009fd0: 4c65 7665 6c28 6c6f 6767 696e 672e 4445  Level(logging.DE
+00009fe0: 4255 4729 006c 6f67 203d 206c 6f67 6769  BUG).log = loggi
+00009ff0: 6e67 2e67 6574 4c6f 6767 6572 2829 0000  ng.getLogger()..
```

### Comparing `lil_nocap-0.5.2/lil_nocap/__init__.py` & `lil_nocap-0.5.4/lil_nocap/__init__.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,349 +1,466 @@
-#!/usr/bin/env 
+#!/usr/bin/env
 import pandas as pd
 from pandas._libs.missing import NAType
 import numpy as np
-import dask
-import dask.bag as db
-from dask.distributed import Client, progress
-import dask.dataframe as dd
-from dask.distributed import as_completed
 import multiprocessing as mp
 import time
-import timeit
 import os
 import click
 import re
 import logging
+from sqlitedict import SqliteDict
+from tqdm.auto import tqdm
+from pathlib import Path
+import multiprocessing as mp
+
+
 log = logging.getLogger()
 log.setLevel(logging.DEBUG)
+from concurrent.futures import ThreadPoolExecutor, as_completed
 import json
 import csv
+csv.field_size_limit(1_000_000)
+import pickle
+import bz2
+import threading
 
 class NoCap:
-  def __init__(self, opinions_fn, opinion_clusters_fn, courts_fn, dockets_fn, citation_fn):
-    log.debug('Initializing')
-    self._opinions_fn = opinions_fn
-    self._opinion_clusters_fn = opinion_clusters_fn
-    self._courts_fn = courts_fn
-    self._dockets_fn = dockets_fn
-    self._citation_fn = citation_fn
-
-    self._df_courts = self.init_courts_df()
-    self._df_opinion_clusters = self.init_opinion_clusters_df()
-    self._df_citation = self.init_citation_df()
-    self._df_dockets = self.init_dockets_dict() # self.init_dockets_df()
-
-    #self._df_opinions = self.init_opinions_df()
-    self.DataFrame = pd.core.frame.DataFrame
-
-  @click.command()  
-  @click.option('-o', help="local path to opinions file", required=True)
-  @click.option('-oc', help="local path to opinion clusters file", required=True)
-  @click.option('-c', help="local path to courts file ", required=True)
-  @click.option('-d', help="local path to dockets file", required=True)
-  @click.option('-cm', help="local path to citation map file", required=True)
-  def cli(o, oc, c, d, cm):
-    NoCap(o, oc, c, d, cm).start()
-    
-  def read_csv_as_dfs(self, filename, 
-                    num_dfs=10, 
-                    max_rows=10**5, 
-                    dtype=None, 
-                    parse_dates=None,
-                    usecols=None,
-                    index_col=None
-                   ):
-    counter = 0
-    dfs_opinions = []
-    for df in pd.read_csv(filename, chunksize=max_rows, dtype=dtype, 
-                          parse_dates=parse_dates, usecols=usecols, index_col=index_col):
-        if counter >= num_dfs:
-            break
-        dfs_opinions.append(df)
-        counter = counter + 1
-    return dfs_opinions
-
-  # get a potentially large csv and turn it into a DataFrame
-  def csv_to_df(self, filename, dtype = None, parse_dates = None, max_gb=5, num_dfs=10**3, usecols=None, index_col=None):
-    start = time.perf_counter()
-    file_size = os.path.getsize(filename)
-    file_size_gb = round(file_size/10**9, 2)
-    log.debug(f'Importing {filename} as a dataframe')
-    msg = f"File Size is : {str(file_size_gb)} GB"
-    log.debug(msg)
-    df = None
-    if file_size_gb > max_gb:
-        df = pd.concat(self.read_csv_as_dfs(filename, num_dfs=10**5, max_rows=10**7, 
-                                       dtype=dtype, parse_dates=parse_dates, usecols=usecols, index_col=index_col))
-    else:
-        df = pd.read_csv(filename, dtype=dtype, parse_dates=parse_dates, usecols=usecols, index_col=index_col)
-    end = time.perf_counter()
-    log.debug(f'{filename} read in {str(int((end-start)/60))} minutes')
-    return df
-
-  # get cluster client
-  def get_cluster_client(self):
-    return self._client
-
-  def df_row_by_value(self, df, column, match):
-    return df.loc[df[column] == match]
-  
-  # accepts a series -- a row from a dataframe
-  def get_opinion_text(self, opinion):
-    text = ''
-    pt = opinion['plain_text']
-    hl = opinion['html']
-    hlb = opinion['html_lawbox']
-    hlc = opinion['html_columbia']
-    xh = opinion['xml_harvard']
-    hla = opinion['html_anon_2020']
-    
-    if isinstance(pt, str):
-        text = pt
-    elif isinstance(hl, str):
-        text = hl
-    elif isinstance(hlb, str):
-        text = hlb
-    elif isinstance(hlc, str):
-        text = hlc 
-    elif isinstance(xh, str):
-        text = xh 
-    elif isinstance(hla, str):
-        text = hla
-    return text
-
-  def get_citations(self, opinion_id, df_citations):
-    cites_to = df_citations[df_citations['citing_opinion_id'] == opinion_id]['cited_opinion_id'].to_list()
-    cited_by = df_citations[df_citations['cited_opinion_id'] == opinion_id]['citing_opinion_id'].to_list()
-    return {
-        'cites_to':cites_to,
-        'cited_by':cited_by
-    }
-
-  # initialize courts df
-  def init_courts_df(self, fn=None):
-    usecols = ['id','full_name','jurisdiction']
-    dtypes = {
-      'fullname': 'string',
-      'jurisdiction': 'string'
-    }
-    return self.csv_to_df(fn or self._courts_fn, dtype=dtypes, usecols=usecols)
-
-  # initialize opinions df
-  def init_opinions_df(self, fn=None):
-      opinion_dtypes = {
-        'download_url': 'string',
-        'local_path':'string',
-        'plain_text':'string',
-        'html':'string',
-        'html_lawbox':'string',
-        'html_columbia':'string',
-        'html_anon_2020':'string',
-        'html_with_citations':'string',
-        'local_path':'string'
-      } 
-
-      return self.csv_to_df(fn or self._opinions_fn, dtype=opinion_dtypes, index_col='id')
-
-  # initialize opinion clusters df
-  def init_opinion_clusters_df(self, fn=None):
-      usecols = ['id', 'judges', 'docket_id', 'case_name', 'case_name_full']
-      dtypes = {
-        'judges':'string',
-        'case_name':'string',
-        'case_name_full':'string'
-      }
-      return self.csv_to_df(fn or self._opinion_clusters_fn, dtype=dtypes, usecols=usecols)
-
-  # initialize dockets df
-  def init_dockets_df(self, fn=None):
-      my_types = {
-      'court_id': 'string',
-      'date_terminated': 'string'
-      } 
-
-      log.debug('importing dockets')
-      file_size = os.path.getsize(self._opinions_fn)
-      file_size_gb = round(file_size/10**9, 2)
-      log.debug(f'Importing {fn} as a Dask Dataframe')
-      msg = f"File Size is : {str(file_size_gb)} GB"
-      log.debug(msg)
-
-      return dd.read_csv(fn or self._dockets_fn, dtype=my_types, usecols=['court_id', 'id', 'date_terminated'],
-                         blocksize="32MB")
-
-
-  # initialize dockets dict
-  def init_dockets_dict(self, fn=None):
-    fn = fn or self._dockets_fn
-    file_size = os.path.getsize(fn)
-    file_size_gb = round(file_size/10**9, 2)
-    log.debug(f'Importing {fn} as a Dict')
-    msg = f"File Size is : {str(file_size_gb)} GB"
-    log.debug(msg)
-
-    start = time.perf_counter()
-    dockets_dict = {}
-    with open(fn) as dockets:
-        reader = csv.DictReader(dockets)
-        for row in reader:
-            dockets_dict[int(row['id'])] = row['court_id'], row['date_terminated']
-
-    end = time.perf_counter()
-    log.debug(f'{fn} read in {str(int((end-start)/60))} minutes')
-
-    return dockets_dict
-  
-  # initialize citation map df
-  def init_citation_df(self, fn=None):
-      return self.csv_to_df(fn or self._citation_fn)
-
-  ## Getters
-  def get_courts_df(self):
-      return self._df_courts
-
-  def get_citation_df(self):
-      return self._df_citation
-  
-  def get_dockets_df(self):
-      return self._df_dockets
-
-  def get_opinions_cluster_df(self):
-      return self._df_opinion_clusters
-
-  def get_opinions_df(self):
-      pass
-
-  class NpEncoder(json.JSONEncoder):
-    def default(self, obj):
-        if isinstance(obj, np.integer):
-            return int(obj)
-        if isinstance(obj, np.floating):
-            return float(obj)
-        if isinstance(obj, np.ndarray):
-            return obj.tolist()
-        if isinstance(obj, NAType):
-            return ''
-        return super(NpEncoder, self).default(obj)
-  
-  # process
-  def process_row(self, opinion) -> dict:
-    log.debug('process_row')
-    dockets = self.get_dockets_df()
-    courts = self.get_courts_df()
-    citations = self.get_citation_df()
-    opinion_id = opinion['id']
-    cluster_id = opinion['cluster_id']
-
-    # get each corresponding row from clusters, dockets, courts based on opinion id
-    cluster_row: self.DataFrame = self.df_row_by_value(self.get_opinions_cluster_df(), 'id', cluster_id)
-
-    # get corresponding row from docket df based on cluster opinion id
-    docket_id = int(cluster_row['docket_id'])
-    #docket_row = dockets[dockets['id'] == docket_id].compute()
-    docket_row = dockets[docket_id]
-   
-    # return early if there's 
-    if not docket_row:
-        return
-    cid = docket_row[0]
-    court_row: self.DataFrame = courts[courts['id'] == cid]
-    if court_row.empty:
-        return
-
-    # get opinions cited to
-    citation_info = self.get_citations(opinion_id, citations)
-    cites_to = citation_info['cites_to']
-    cited_by = citation_info['cited_by']
-
-    # judges
-    judges = cluster_row.judges
-    judge_list = [
-        judge
-        for judge in
-            (judges.iloc[0].split(',') if judges.notna().bool() else [])
-        if not re.match('[cj]?j\.', judge)
-    ]
-    #    
-    ## sometimes date_terminated may be missing and recorded as NaN
-    date_terminated = docket_row[1]
-    ## download url may also be missing
-    url = '' # opinion['download_url']
-
-    obj = {
-        'id': cluster_id,
-        'url': url,
-        'name_abbreviation': cluster_row.case_name.iloc[0],
-        'name' : cluster_row.case_name_full.iloc[0],
-        'decision_date': '', #date_terminated,
-        'docket_number' : cluster_row.docket_id.iloc[0],
-        'citations' : cited_by,
-        'cites_to' : cites_to,
-        'court' : {'name': court_row.full_name.iloc[0]},
-        'jurisdiction' : {'name': court_row.jurisdiction.iloc[0]},
-        'casebody' : {'data': {
-            'judges': judge_list,
-            'head_matter':'', #Ask CL about copyright,
-            'opinions': [{
-                'text': self.get_opinion_text(opinion), 
-                'author': '', 'type': ''}]
-            }
+    def __init__(
+        self, opinions_fn, opinion_clusters_fn, courts_fn, dockets_fn, citation_fn
+    ):
+        log.debug("Initializing")
+        self._opinions_fn = opinions_fn
+        self._opinion_clusters_fn = opinion_clusters_fn
+        self._courts_fn = courts_fn
+        self._dockets_fn = dockets_fn
+        self._citation_fn = citation_fn
+
+        self._df_courts = self.init_courts_df()
+        self._df_opinion_clusters = self.init_opinion_clusters_dict(
+            opinion_clusters_fn, "opinion_clusters.sqlite"
+        )
+        self.init_citation_dict() #self.init_citation_df()
+        self._df_dockets = self.init_dockets_dict(dockets_fn, "dockets.sqlite")
+
+        # self._df_opinions = self.init_opinions_df()
+        self.DataFrame = pd.core.frame.DataFrame
+
+    @click.command()
+    @click.option("-o", help="local path to opinions file", required=True)
+    @click.option("-oc", help="local path to opinion clusters file", required=True)
+    @click.option("-c", help="local path to courts file ", required=True)
+    @click.option("-d", help="local path to dockets file", required=True)
+    @click.option("-cm", help="local path to citation map file", required=True)
+    def cli(o, oc, c, d, cm):
+        NoCap(o, oc, c, d, cm).start()
+
+    def read_csv_as_dfs(
+        self,
+        filename,
+        num_dfs=10,
+        max_rows=10**5,
+        dtype=None,
+        parse_dates=None,
+        usecols=None,
+        index_col=None,
+    ):
+        counter = 0
+        dfs_opinions = []
+        for df in pd.read_csv(
+            filename,
+            chunksize=max_rows,
+            dtype=dtype,
+            parse_dates=parse_dates,
+            usecols=usecols,
+            index_col=index_col,
+        ):
+            if counter >= num_dfs:
+                break
+            dfs_opinions.append(df)
+            counter = counter + 1
+        return dfs_opinions
+
+    # get a potentially large csv and turn it into a DataFrame
+    def csv_to_df(
+        self,
+        filename,
+        dtype=None,
+        parse_dates=None,
+        max_gb=5,
+        num_dfs=10**3,
+        usecols=None,
+        index_col=None,
+    ):
+        start = time.perf_counter()
+        file_size = os.path.getsize(filename)
+        file_size_gb = round(file_size / 10**9, 2)
+        log.debug(f"Importing {filename} as a dataframe")
+        msg = f"File Size is : {str(file_size_gb)} GB"
+        log.debug(msg)
+        df = None
+        if file_size_gb > max_gb:
+            df = pd.concat(
+                self.read_csv_as_dfs(
+                    filename,
+                    num_dfs=10**5,
+                    max_rows=10**7,
+                    dtype=dtype,
+                    parse_dates=parse_dates,
+                    usecols=usecols,
+                    index_col=index_col,
+                )
+            )
+        else:
+            df = pd.read_csv(
+                filename,
+                dtype=dtype,
+                parse_dates=parse_dates,
+                usecols=usecols,
+                index_col=index_col,
+            )
+        end = time.perf_counter()
+        log.debug(f"{filename} read in {str(int((end-start)/60))} minutes")
+        return df
+
+    # get cluster client
+    def get_cluster_client(self):
+        return self._client
+
+    def df_row_by_value(self, df, column, match):
+        return df.loc[df[column] == match]
+
+    # accepts a series -- a row from a dataframe
+    def get_opinion_text(self, opinion):
+        text = ""
+        pt = opinion["plain_text"]
+        hl = opinion["html"]
+        hlb = opinion["html_lawbox"]
+        hlc = opinion["html_columbia"]
+        xh = opinion["xml_harvard"]
+        hla = opinion["html_anon_2020"]
+
+        if isinstance(pt, str):
+            text = pt
+        elif isinstance(hl, str):
+            text = hl
+        elif isinstance(hlb, str):
+            text = hlb
+        elif isinstance(hlc, str):
+            text = hlc
+        elif isinstance(xh, str):
+            text = xh
+        elif isinstance(hla, str):
+            text = hla
+        return text
+
+   #def get_citations(self, opinion_id, df_citations):
+       
+
+    # initialize courts df
+    def init_courts_df(self, fn=None):
+        usecols = ["id", "full_name", "jurisdiction"]
+        dtypes = {"fullname": "string", "jurisdiction": "string"}
+        return self.csv_to_df(fn or self._courts_fn, dtype=dtypes, usecols=usecols)
+
+    # initialize opinions df
+    def init_opinions_df(self, fn=None):
+        opinion_dtypes = {
+            "download_url": "string",
+            "local_path": "string",
+            "plain_text": "string",
+            "html": "string",
+            "html_lawbox": "string",
+            "html_columbia": "string",
+            "html_anon_2020": "string",
+            "html_with_citations": "string",
+            "local_path": "string",
+        }
+
+        return self.csv_to_df(
+            fn or self._opinions_fn, dtype=opinion_dtypes, index_col="id"
+        )
+
+    # initialize opinion clusters df
+    def init_opinion_clusters_df(self, fn=None):
+        usecols = ["id", "judges", "docket_id", "case_name", "case_name_full"]
+        dtypes = {"judges": "string", "case_name": "string", "case_name_full": "string"}
+        return self.csv_to_df(
+            fn or self._opinion_clusters_fn, dtype=dtypes, usecols=usecols
+        )
+
+    # initialize dockets df
+    def init_dockets_df(self, fn=None):
+        my_types = {"court_id": "string", "date_terminated": "string"}
+
+        log.debug("importing dockets")
+        file_size = os.path.getsize(self._opinions_fn)
+        file_size_gb = round(file_size / 10**9, 2)
+        log.debug(f"Importing {fn} as a Dask Dataframe")
+        msg = f"File Size is : {str(file_size_gb)} GB"
+        log.debug(msg)
+
+        return dd.read_csv(
+            fn or self._dockets_fn,
+            dtype=my_types,
+            usecols=["court_id", "id", "date_terminated"],
+            blocksize="32MB",
+        )
+
+    @staticmethod
+    def bz2_csv_rows(fp):
+        with bz2.open(fp, mode="rt", newline="") as bzfp:
+            for row in csv.reader(bzfp):
+                yield row
+
+    @classmethod
+    def bz2_csv_reader(cls, fn):
+        keys = []
+        for i, row in enumerate(cls.bz2_csv_rows(fn)):
+            if i == 0:
+                keys = row
+            else:
+                yield dict(zip(keys, row))
+
+    @staticmethod
+    def opinion_clusters_row_to_kv(row):
+        fields = ["judges", "docket_id", "case_name", "case_name_full", "headnotes"]
+        return row["id"], {f: row[f] for f in fields}
+
+    @staticmethod
+    def docket_row_to_kv(row):
+        fields = ["court_id", "date_terminated"]
+        return row["id"], {f: row[f] for f in fields}
+
+    @staticmethod
+    def sqlitedict_reader(sql_fn):
+        return SqliteDict(sql_fn, flag="r", journal_mode="OFF", outer_stack=False)
+
+    def build_sqlitedict(self, csv_fn, sql_fn, row_to_kv, batch_size=1_000_000):
+        with SqliteDict(sql_fn, journal_mode="OFF", outer_stack=False) as db:
+            for i, row in tqdm(enumerate(self.bz2_csv_reader(csv_fn)), smoothing=0):
+                k, v = row_to_kv(row)
+                db[k] = v
+                if i % batch_size == 0:
+                    db.commit()
+            db.commit()
+        return self.sqlitedict_reader(sql_fn)
+
+    def init_dockets_dict(self, fn, sql_fn, batch_size=1_000_000):
+        if not Path(sql_fn).exists():
+            self.build_sqlitedict(fn, sql_fn, self.docket_row_to_kv, batch_size)
+        return self.sqlitedict_reader(sql_fn)
+
+    def init_opinion_clusters_dict(self, fn, sql_fn, batch_size=1_000_000):
+        if not Path(sql_fn).exists():
+            self.build_sqlitedict(
+                fn, sql_fn, self.opinion_clusters_row_to_kv, batch_size
+            )
+        return self.sqlitedict_reader(sql_fn)
+
+    # initialize citation map df
+    def init_citation_df(self, fn=None):
+        return self.csv_to_df(fn or self._citation_fn)
+
+    def init_citation_dict(self, fn=None):
+        start = time.perf_counter()
+        usecols = ['cited_opinion_id', 'citing_opinion_id']
+        log.debug('initializing citation csv to be a dict')
+        df_dict = self.csv_to_df(fn or self._citation_fn, usecols=usecols).to_dict("records")
+        self.cites_to = {}
+        self.cited_by = {}
+        list(map(lambda x: self.cites_to.setdefault(x['citing_opinion_id'], []).append(x['cited_opinion_id']), df_dict))
+        list(map(lambda x: self.cited_by.setdefault(x['cited_opinion_id'], []).append(x['citing_opinion_id']), df_dict))
+        log.debug('finished converting citation dataframe into a dict')
+        end = time.perf_counter()
+        log.debug((end - start) / 60)
+
+
+    ## Getters
+    def get_courts_df(self):
+        return self._df_courts
+
+    def get_citation_df(self):
+        return self._df_citation
+
+    def get_dockets_df(self):
+        return self._df_dockets
+
+    def get_opinions_cluster_df(self):
+        return self._df_opinion_clusters
+
+    def get_opinions_df(self):
+        pass
+
+    def get_pickled_docket(self, fn="docket"):
+        file = open("docket", "rb")
+        self._df_dockets = pickle.load(file)
+        file.close()
+        return self._df_dockets
+
+    class NpEncoder(json.JSONEncoder):
+        def default(self, obj):
+            if isinstance(obj, np.integer):
+                return int(obj)
+            if isinstance(obj, np.floating):
+                return float(obj)
+            if isinstance(obj, np.ndarray):
+                return obj.tolist()
+            if isinstance(obj, NAType):
+                return ""
+            return super(NpEncoder, self).default(obj)
+
+    ## get cluster_row
+    def get_cluster_row(self, opinion):
+        # get each corresponding row from clusters, dockets, courts based on opinion id
+        cluster_id = opinion["cluster_id"]
+        return self.get_opinions_cluster_df()[cluster_id]
+
+    ## Process Opinion Dataframe
+    def process_df(self, df):
+        log.debug("process_df: client.map")
+        log.debug("printing mini opinion dataframe as a dict")
+        df_dict = df.to_dict("records")
+
+        # get cluster rows
+        log.debug("getting cluster rows")
+        cluster_rows = list(map(self.get_cluster_row, df_dict))
+
+        # dockets
+        log.debug("getting dockets")
+        dockets = self.get_dockets_df()
+        # get the docekt_id as an int from each cluster_row in orderd as a key to hash into the dockets dict
+        docket_rows = list(map(lambda x: dockets[int(x["docket_id"])], cluster_rows))
+
+        # process row
+        log.debug("running map(process_row) in parallel")
+        return list(map(self.process_row, df_dict, cluster_rows, docket_rows))
+
+    ## Helper function to process each row in the opinions dataframe
+    # This is a helper function that connects opinions to courts, dockets, citations etc.,
+    def process_row(self, opinion, cluster_row, docket_row) -> dict:
+        courts = self.get_courts_df()
+        opinion_id = opinion["id"]
+        cluster_id = opinion["cluster_id"]
+
+        # get corresponding row from docket df based on cluster opinion id
+        # return early if there's
+        if not docket_row:
+            return
+        cid = docket_row["court_id"]
+        court_row: self.DataFrame = courts[courts["id"] == cid]
+        if court_row.empty:
+            return
+
+        # get opinions cited to
+        cites_to = self.cites_to[opinion_id] if opinion_id in self.cites_to else []
+        cited_by = self.cited_by[opinion_id] if opinion_id in self.cited_by else []
+
+        # judges
+        judges = cluster_row["judges"]
+        judge_list = [
+            judge
+            for judge in (judges.split(",") if judges else [])
+            if not re.match("[cj]?j\.", judge)
+        ]
+        #
+        ## sometimes date_terminated may be missing and recorded as NaN
+        date_terminated = docket_row["date_terminated"]
+        ## download url may also be missing
+        url = ""  # opinion['download_url']
+
+        obj = {
+            "id": cluster_id,
+            "url": url,
+            "name_abbreviation": cluster_row["case_name"],
+            "name": cluster_row["case_name_full"],
+            "decision_date": "",  # date_terminated,
+            "docket_number": cluster_row["docket_id"],
+            "citations": cited_by,
+            "cites_to": cites_to,
+            "court": {"name": court_row.full_name.iloc[0]},
+            "jurisdiction": {"name": court_row.jurisdiction.iloc[0]},
+            "casebody": {
+                "data": {
+                    "judges": judge_list,
+                    "head_matter": cluster_row['headnotes'],
+                    "opinions": [
+                        {
+                            "text": self.get_opinion_text(opinion),
+                            "author": "",
+                            "type": "",
+                        }
+                    ],
+                }
+            },
+        }
+        return json.dumps(obj, cls=self.NpEncoder)
+
+    def start(self):
+        start = time.perf_counter()
+        max_rows = 1_000
+        opinion_dtypes = {
+            "download_url": "string",
+            "local_path": "string",
+            "plain_text": "string",
+            "html": "string",
+            "html_lawbox": "string",
+            "html_columbia": "string",
+            "html_anon_2020": "string",
+            "html_with_citations": "string",
+            "local_path": "string",
         }
-    }
-    return json.dumps(obj, cls=self.NpEncoder)
+        usecols = [
+            "id",
+            "download_url",
+            "local_path",
+            "cluster_id",
+            "xml_harvard",
+            "plain_text",
+            "html",
+            "html_lawbox",
+            "html_columbia",
+            "html_anon_2020",
+            "local_path",
+        ]
+        file_size = os.path.getsize(self._opinions_fn)
+        file_size_gb = round(file_size / 10**9, 2)
+        log.debug(f"Importing {self._opinions_fn} as a dataframe")
+        msg = f"File Size is : {str(file_size_gb)} GB"
+        log.debug(msg)
+        # We can use a with statement to ensure threads are cleaned up promptly
+        chunks = pd.read_csv(
+            self._opinions_fn,
+            chunksize=max_rows,
+            dtype=opinion_dtypes,
+            parse_dates=None,
+            usecols=usecols,
+        )
+
+        pbar = tqdm(desc="Processing opinions", smoothing=0)
+
+        N_WORKERS = max_rows / mp.cpu_count()
+
+        N_CHUNKS_PER_BATCH = int(mp.cpu_count() * 1.5)
+
+        lock = threading.Lock()
+        with ThreadPoolExecutor(max_workers=N_WORKERS) as executor:
+            futures = []
+            for i, df in enumerate(chunks):
+                futures.append(executor.submit(self.process_df, df))
+                if (i + 1) % N_CHUNKS_PER_BATCH == 0:
+                    for future in as_completed(futures):
+                        try:
+                            result = future.result()
+                            pbar.update(max_rows)
+                        except Exception as exc:
+                            log.exception(exc)
+                        else:
+                             with lock:
+                                with open('nocap_opinions.jsonl', 'a') as file:
+                                  file.write(f'{result}')
+        end = time.perf_counter()
+        log.debug(f'Finished: {(end - start) / 60}')
 
-  def process_df(self, df):
-    log.debug('process_df: client.map')
-    log.debug('printing mini opinion dataframe as a dict')
-    df_dict = df.to_dict('records')
-    
-    b = db.from_sequence(df_dict, npartitions=int(mp.cpu_count() * .80))
-    #print(list(map(self.process_row, df_dict)))
-    results = db.map(self.process_row, b).to_textfiles('data/*.jsonl')
-    print(results)
-    
-  def test(self):
-    print('test')
-  
-  def start(self):
-    start = time.perf_counter()
-    max_rows = 1000
-    opinion_dtypes = {
-        'download_url': 'string',
-        'local_path':'string',
-        'plain_text':'string',
-        'html':'string',
-        'html_lawbox':'string',
-        'html_columbia':'string',
-        'html_anon_2020':'string',
-        'html_with_citations':'string',
-        'local_path':'string'
-    }
-    usecols = [
-           'id',
-           'download_url', 
-           'local_path',
-           'cluster_id',
-           'xml_harvard',
-           'plain_text',
-           'html',
-           'html_lawbox',
-           'html_columbia',
-           'html_anon_2020',
-           'local_path'           
-          ]
-    file_size = os.path.getsize(self._opinions_fn)
-    file_size_gb = round(file_size/10**9, 2)
-    log.debug(f'Importing {self._opinions_fn} as a dataframe')
-    msg = f"File Size is : {str(file_size_gb)} GB"
-    log.debug(msg)
-    #client = Client(threads_per_worker=4, n_workers = int(mp.cpu_count() * .40))
-    for df in pd.read_csv(self._opinions_fn, chunksize=max_rows, dtype=opinion_dtypes, parse_dates=None, usecols=usecols):
-      log.debug(f'Now reading {len(df)} opinions')
-      
-      self.process_df(df)
-    end = time.perf_counter()
-    log.debug((end-start)/60)
 
-if __name__ == '__main__':
-  NoCap.cli()
+if __name__ == "__main__":
+    NoCap.cli()
```

### Comparing `lil_nocap-0.5.2/setup.py` & `lil_nocap-0.5.4/setup.py`

 * *Files 4% similar despite different names*

```diff
@@ -14,15 +14,15 @@
  'pandas>=1.5.3,<2.0.0']
 
 entry_points = \
 {'console_scripts': ['nocap = lil_nocap.__init__:NoCap.cli']}
 
 setup_kwargs = {
     'name': 'lil-nocap',
-    'version': '0.5.2',
+    'version': '0.5.4',
     'description': 'A package for downloading bulk files from courtlistener',
     'long_description': "# Easy Bulk export, no cap\nThis repository provides scripts and notebooks that make it easy to export data in bulk from CourtListener's freely available downloads.\n\n##\n* [x] Create first version of notebook suitable for Data Scientists\n  * [x] Create the appropriate _dtypes_ to optimize panda storage\n  * [x] Select necessary cols _usecols_, for example 'created_by' date field indicating a database _insert_ isn't necessary\n  * [x] Read the _opinions.csv_ (190+gb) chunk at a time from disk while converting into JSON\n* [ ] Create a standalone script that can be piped to other tools\n  * [x] Create PyPi library using [Poetry](https://python-poetry.org/): [package](https://pypi.org/project/lil-nocap)\n  * [x] Output script using [json lines](https://jsonlines.org/examples/) format\n* [ ] Improve speed by using [DASK DataFrame](https://docs.dask.org/en/stable/dataframe.html)\n\n",
     'author': 'sabzo',
     'author_email': 'sabelo@sabelo.io',
     'maintainer': 'None',
     'maintainer_email': 'None',
     'url': 'None',
```

### Comparing `lil_nocap-0.5.2/PKG-INFO` & `lil_nocap-0.5.4/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: lil-nocap
-Version: 0.5.2
+Version: 0.5.4
 Summary: A package for downloading bulk files from courtlistener
 License: MIT
 Author: sabzo
 Author-email: sabelo@sabelo.io
 Requires-Python: >=3.8,<4.0
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3
```

